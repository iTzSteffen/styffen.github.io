import{$ as L,$a as gh,A as It,Aa as Ms,Ab as tc,B as by,Ba as Jt,Bb as nc,C as nh,Ca as Se,Cb as Th,D as Cy,Da as dh,Db as Qy,E as _n,Ea as Oy,Eb as js,F as Hr,Fa as Zr,Fb as rc,G as ar,Ga as Qa,Gb as Yy,H as rh,Ha as xy,Hb as bh,I as Kr,Ia as ei,Ib as Ch,J as Ay,Ja as Vs,Jb as Ah,K as Qr,Ka as ur,Kb as Sh,L as Un,La as My,M as ih,Ma as Vy,N as Sy,Na as fh,O as sh,Oa as Ly,P as oh,Pa as ph,Q as Tt,Qa as Ya,Qb as Jy,R as Ry,Ra as Fy,Rb as $s,S as De,Sa as Uy,Sb as ic,T as ye,Ta as By,U as Ga,Ua as ue,V as Z,Va as le,W as cr,Wa as ze,X as Py,Xa as mh,Xb as Xy,Y as W,Ya as Ct,Yb as sc,Z as ah,Za as yn,_ as te,_a as Ie,_b as Zy,a as V,aa as de,ab as jy,b as _e,ba as ks,bb as _h,c as yy,ca as bt,cb as yh,d as zA,da as lr,db as vh,dc as ev,e as Vn,ea as Ut,eb as Ja,f as w,fa as Ne,fb as At,g as vy,ga as Dy,gb as Ls,h as Qu,ha as Yr,hb as wh,i as Ln,ia as Bt,ib as Xa,j as Yu,ja as Wa,jb as Za,k as Ju,ka as Jr,kb as ec,l as gn,la as Xr,lb as Fs,m as Et,ma as Os,mb as $y,n as wy,na as at,nb as Eh,o as Ey,oa as Ha,ob as qy,p as Fn,pa as Yt,pb as Us,q as Xu,qa as ve,qb as zy,r as Zu,ra as ch,rb as Gy,s as eh,sa as Ka,sb as Wy,t as Xe,ta as Ny,tb as Ih,u as z,ua as lh,ub as Bs,v as Ns,va as ky,vb as Bn,w as Iy,wa as jt,wb as ti,x as Ty,xa as xs,xb as Hy,y as ee,ya as uh,yb as Ky,z as th,za as hh,zb as Ve}from"./chunk-FRMQRWS2.js";var zs=class{},Gs=class{},Xt=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(c=>s.indexOf(c)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var Ph=class{encodeKey(e){return tv(e)}encodeValue(e){return tv(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function WA(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(o)||[];l.push(c),t.set(o,l)}),t}var HA=/%(\d[a-f0-9])/gi,KA={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function tv(n){return encodeURIComponent(n).replace(HA,(e,t)=>KA[t]??e)}function oc(n){return`${n}`}var $n=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Ph,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=WA(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(oc):[oc(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(oc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(oc(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Dh=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function QA(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function nv(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function rv(n){return typeof Blob<"u"&&n instanceof Blob}function iv(n){return typeof FormData<"u"&&n instanceof FormData}function YA(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var qs=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(QA(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Xt,this.context??=new Dh,!this.params)this.params=new $n,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||nv(this.body)||rv(this.body)||iv(this.body)||YA(this.body)?this.body:this.body instanceof $n?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||iv(this.body)?null:rv(this.body)?this.body.type||null:nv(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof $n?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,u=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(u=Object.keys(e.setHeaders).reduce((g,T)=>g.set(T,e.setHeaders[T]),u)),e.setParams&&(f=Object.keys(e.setParams).reduce((g,T)=>g.set(T,e.setParams[T]),f)),new n(t,r,o,{params:f,headers:u,context:p,reportProgress:l,responseType:i,withCredentials:c,transferCache:s})}},qn=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(qn||{}),Ws=class{constructor(e,t=200,r="OK"){this.headers=e.headers||new Xt,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},cc=class n extends Ws{constructor(e={}){super(e),this.type=qn.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},hr=class n extends Ws{constructor(e={}){super(e),this.type=qn.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},jn=class extends Ws{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},mv=200,JA=204;function Rh(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var XA=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof qs)o=r;else{let u;s.headers instanceof Xt?u=s.headers:u=new Xt(s.headers);let f;s.params&&(s.params instanceof $n?f=s.params:f=new $n({fromObject:s.params})),o=new qs(r,i,s.body!==void 0?s.body:null,{headers:u,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let c=z(o).pipe(ar(u=>this.handler.handle(u)));if(r instanceof qs||s.observe==="events")return c;let l=c.pipe(_n(u=>u instanceof hr));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return l.pipe(ee(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return l.pipe(ee(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return l.pipe(ee(u=>{if(u.body!==null&&typeof u.body!="string")throw new Error("Response is not a string.");return u.body}));case"json":default:return l.pipe(ee(u=>u.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new $n().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,Rh(s,i))}post(r,i,s={}){return this.request("POST",r,Rh(s,i))}put(r,i,s={}){return this.request("PUT",r,Rh(s,i))}};e.\u0275fac=function(i){return new(i||e)(te(zs))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),ZA=/^\)\]\}',?\n/,eS="X-Request-URL";function sv(n){if(n.url)return n.url;let e=eS.toLocaleLowerCase();return n.headers.get(e)}var Nh=(()=>{let e=class e{constructor(){this.fetchImpl=L(kh,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=L(ve)}handle(r){return new Ln(i=>{let s=new AbortController;return this.doRequest(r,s.signal,i).then(Oh,o=>i.error(new jn({error:o}))),()=>s.abort()})}doRequest(r,i,s){return w(this,null,function*(){let o=this.createRequestInit(r),c;try{let S=this.ngZone.runOutsideAngular(()=>this.fetchImpl(r.urlWithParams,V({signal:i},o)));tS(S),s.next({type:qn.Sent}),c=yield S}catch(S){s.error(new jn({error:S,status:S.status??0,statusText:S.statusText,url:r.urlWithParams,headers:S.headers}));return}let l=new Xt(c.headers),u=c.statusText,f=sv(c)??r.urlWithParams,p=c.status,g=null;if(r.reportProgress&&s.next(new cc({headers:l,status:p,statusText:u,url:f})),c.body){let S=c.headers.get("content-length"),D=[],P=c.body.getReader(),M=0,$,B,F=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>w(this,null,function*(){for(;;){let{done:K,value:I}=yield P.read();if(K)break;if(D.push(I),M+=I.length,r.reportProgress){B=r.responseType==="text"?(B??"")+($??=new TextDecoder).decode(I,{stream:!0}):void 0;let _=()=>s.next({type:qn.DownloadProgress,total:S?+S:void 0,loaded:M,partialText:B});F?F.run(_):_()}}}));let pe=this.concatChunks(D,M);try{let K=c.headers.get("Content-Type")??"";g=this.parseBody(r,pe,K)}catch(K){s.error(new jn({error:K,headers:new Xt(c.headers),status:c.status,statusText:c.statusText,url:sv(c)??r.urlWithParams}));return}}p===0&&(p=g?mv:0),p>=200&&p<300?(s.next(new hr({body:g,headers:l,status:p,statusText:u,url:f})),s.complete()):s.error(new jn({error:g,headers:l,status:p,statusText:u,url:f}))})}parseBody(r,i,s){switch(r.responseType){case"json":let o=new TextDecoder().decode(i).replace(ZA,"");return o===""?null:JSON.parse(o);case"text":return new TextDecoder().decode(i);case"blob":return new Blob([i],{type:s});case"arraybuffer":return i.buffer}}createRequestInit(r){let i={},s=r.withCredentials?"include":void 0;if(r.headers.forEach((o,c)=>i[o]=c.join(",")),r.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!r.headers.has("Content-Type")){let o=r.detectContentTypeHeader();o!==null&&(i["Content-Type"]=o)}return{body:r.serializeBody(),method:r.method,headers:i,credentials:s}}concatChunks(r,i){let s=new Uint8Array(i),o=0;for(let c of r)s.set(c,o),o+=c.length;return s}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),kh=class{};function Oh(){}function tS(n){n.then(Oh,Oh)}function nS(n,e){return e(n)}function rS(n,e,t){return(r,i)=>Bt(t,()=>e(r,s=>n(s,i)))}var gv=new W(""),_v=new W(""),iS=new W("",{providedIn:"root",factory:()=>!0});var ov=(()=>{let e=class e extends zs{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=L(Ha),this.contributeToStability=L(iS)}handle(r){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(gv),...this.injector.get(_v,[])]));this.chain=i.reduceRight((s,o)=>rS(s,o,this.injector),nS)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(Qr(()=>this.pendingTasks.remove(i)))}else return this.chain(r,i=>this.backend.handle(i))}};e.\u0275fac=function(i){return new(i||e)(te(Gs),te(Yr))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();var sS=/^\)\]\}',?\n/;function oS(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var av=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new ye(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Xe(i.\u0275loadImpl()):z(null)).pipe(Tt(()=>new Ln(o=>{let c=i.build();if(c.open(r.method,r.urlWithParams),r.withCredentials&&(c.withCredentials=!0),r.headers.forEach((P,M)=>c.setRequestHeader(P,M.join(","))),r.headers.has("Accept")||c.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let P=r.detectContentTypeHeader();P!==null&&c.setRequestHeader("Content-Type",P)}if(r.responseType){let P=r.responseType.toLowerCase();c.responseType=P!=="json"?P:"text"}let l=r.serializeBody(),u=null,f=()=>{if(u!==null)return u;let P=c.statusText||"OK",M=new Xt(c.getAllResponseHeaders()),$=oS(c)||r.url;return u=new cc({headers:M,status:c.status,statusText:P,url:$}),u},p=()=>{let{headers:P,status:M,statusText:$,url:B}=f(),F=null;M!==JA&&(F=typeof c.response>"u"?c.responseText:c.response),M===0&&(M=F?mv:0);let pe=M>=200&&M<300;if(r.responseType==="json"&&typeof F=="string"){let K=F;F=F.replace(sS,"");try{F=F!==""?JSON.parse(F):null}catch(I){F=K,pe&&(pe=!1,F={error:I,text:F})}}pe?(o.next(new hr({body:F,headers:P,status:M,statusText:$,url:B||void 0})),o.complete()):o.error(new jn({error:F,headers:P,status:M,statusText:$,url:B||void 0}))},g=P=>{let{url:M}=f(),$=new jn({error:P,status:c.status||0,statusText:c.statusText||"Unknown Error",url:M||void 0});o.error($)},T=!1,S=P=>{T||(o.next(f()),T=!0);let M={type:qn.DownloadProgress,loaded:P.loaded};P.lengthComputable&&(M.total=P.total),r.responseType==="text"&&c.responseText&&(M.partialText=c.responseText),o.next(M)},D=P=>{let M={type:qn.UploadProgress,loaded:P.loaded};P.lengthComputable&&(M.total=P.total),o.next(M)};return c.addEventListener("load",p),c.addEventListener("error",g),c.addEventListener("timeout",g),c.addEventListener("abort",g),r.reportProgress&&(c.addEventListener("progress",S),l!==null&&c.upload&&c.upload.addEventListener("progress",D)),c.send(l),o.next({type:qn.Sent}),()=>{c.removeEventListener("error",g),c.removeEventListener("abort",g),c.removeEventListener("load",p),c.removeEventListener("timeout",g),r.reportProgress&&(c.removeEventListener("progress",S),l!==null&&c.upload&&c.upload.removeEventListener("progress",D)),c.readyState!==c.DONE&&c.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(te(rc))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),yv=new W(""),aS="XSRF-TOKEN",cS=new W("",{providedIn:"root",factory:()=>aS}),lS="X-XSRF-TOKEN",uS=new W("",{providedIn:"root",factory:()=>lS}),lc=class{},hS=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=nc(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(te(Ve),te(jt),te(cS))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();function dS(n,e){let t=n.url.toLowerCase();if(!L(yv)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=L(lc).getToken(),i=L(uS);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var vv=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(vv||{});function fS(n,e){return{\u0275kind:n,\u0275providers:e}}function wv(...n){let e=[XA,av,ov,{provide:zs,useExisting:ov},{provide:Gs,useFactory:()=>L(Nh,{optional:!0})??L(av)},{provide:gv,useValue:dS,multi:!0},{provide:yv,useValue:!0},{provide:lc,useClass:hS}];for(let t of n)e.push(...t.\u0275providers);return Ne(e)}function Ev(){return fS(vv.Fetch,[Nh,{provide:Gs,useExisting:Nh}])}var pS=new W(""),cv="b",lv="h",uv="s",hv="st",dv="u",fv="rt",ac=new W(""),mS=["GET","HEAD"];function gS(n,e){let T=L(ac),{isCacheActive:t}=T,r=yy(T,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||i===!1||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!mS.includes(s)||!r.includeRequestsWithAuthHeaders&&_S(n)||r.filter?.(n)===!1)return e(n);let o=L(hh),c=L(pS,{optional:!0}),l=js(L(jt));if(c&&!l)throw new ye(2803,!1);let u=l&&c?ES(n.url,c):n.url,f=vS(n,u),p=o.get(f,null),g=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(g=i.includeHeaders),p){let{[cv]:S,[fv]:D,[lv]:P,[uv]:M,[hv]:$,[dv]:B}=p,F=S;switch(D){case"arraybuffer":F=new TextEncoder().encode(S).buffer;break;case"blob":F=new Blob([S]);break}let pe=new Xt(P);return z(new hr({body:F,headers:pe,status:M,statusText:$,url:B}))}return e(n).pipe(De(S=>{S instanceof hr&&l&&o.set(f,{[cv]:S.body,[lv]:yS(S.headers,g),[uv]:S.status,[hv]:S.statusText,[dv]:u,[fv]:n.responseType})}))}function _S(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function yS(n,e){if(!e)return{};let t={};for(let r of e){let i=n.getAll(r);i!==null&&(t[r]=i)}return t}function pv(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function vS(n,e){let{params:t,method:r,responseType:i}=n,s=pv(t),o=n.serializeBody();o instanceof URLSearchParams?o=pv(o):typeof o!="string"&&(o="");let c=[r,i,e,o,s].join("|"),l=wS(c);return l}function wS(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function Iv(n){return[{provide:ac,useFactory:()=>(ei("NgHttpTransferCache"),V({isCacheActive:!0},n))},{provide:_v,useValue:gS,multi:!0,deps:[hh,ac]},{provide:ec,multi:!0,useFactory:()=>{let e=L(Fs),t=L(ac);return()=>{$y(e).then(()=>{t.isCacheActive=!1})}}}]}function ES(n,e){let t=new URL(n,"resolve://").origin,r=e[t];return r?n.replace(t,r):n}var Vh=class extends Ky{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Lh=class n extends Vh{static makeCurrent(){Hy(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=TS();return t==null?null:bS(t)}resetBaseElement(){Hs=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return nc(document.cookie,e)}},Hs=null;function TS(){return Hs=Hs||document.querySelector("base"),Hs?Hs.getAttribute("href"):null}function bS(n){return new URL(n,document.baseURI).pathname}var CS=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),uc=new W(""),Cv=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new ye(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(te(uc),te(ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),Ks=class{constructor(e){this._doc=e}},xh="ng-app-id",Av=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=js(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${xh}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(xh),o;{let c=this.doc.createElement("style");return this.nonce&&c.setAttribute("nonce",this.nonce),c.textContent=i,this.platformIsServer&&c.setAttribute(xh,this.appId),r.appendChild(c),c}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,c=o.get(i)?.elements;c?c.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(te(Ve),te(lh),te(uh,8),te(jt))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),Mh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Bh=/%COMP%/g,Sv="%COMP%",AS=`_nghost-${Sv}`,SS=`_ngcontent-${Sv}`,RS=!0,PS=new W("",{providedIn:"root",factory:()=>RS});function DS(n){return SS.replace(Bh,n)}function NS(n){return AS.replace(Bh,n)}function Rv(n,e){return e.map(t=>t.replace(Bh,n))}var ni=(()=>{let e=class e{constructor(r,i,s,o,c,l,u,f=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=c,this.platformId=l,this.ngZone=u,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=js(l),this.defaultRenderer=new Qs(r,c,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ks.ShadowDom&&(i=_e(V({},i),{encapsulation:ks.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof hc?s.applyToHost(r):s instanceof Ys&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let c=this.doc,l=this.ngZone,u=this.eventManager,f=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case ks.Emulated:o=new hc(u,f,i,this.appId,p,c,l,g);break;case ks.ShadowDom:return new Fh(u,f,r,i,c,l,this.nonce,g);default:o=new Ys(u,f,i,p,c,l,g);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(te(Cv),te(Av),te(lh),te(PS),te(Ve),te(jt),te(ve),te(uh))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),Qs=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Mh[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Tv(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Tv(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ye(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Mh[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Mh[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ms.DashCase|Ms.Important)?e.style.setProperty(t,r,i&Ms.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ms.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=ti().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Tv(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Fh=class extends Qs{constructor(e,t,r,i,s,o,c,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=Rv(i.id,i.styles);for(let f of u){let p=document.createElement("style");c&&p.setAttribute("nonce",c),p.textContent=f,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ys=class extends Qs{constructor(e,t,r,i,s,o,c,l){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?Rv(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},hc=class extends Ys{constructor(e,t,r,i,s,o,c,l){let u=i+"-"+r.id;super(e,t,r,s,o,c,l,u),this.contentAttr=DS(u),this.hostAttr=NS(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},kS=(()=>{let e=class e extends Ks{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(te(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),OS=(()=>{let e=class e extends Ks{constructor(r){super(r),this.delegate=L(Gy,{optional:!0})}supports(r){return this.delegate?this.delegate.supports(r):!1}addEventListener(r,i,s){return this.delegate.addEventListener(r,i,s)}removeEventListener(r,i,s){return this.delegate.removeEventListener(r,i,s)}};e.\u0275fac=function(i){return new(i||e)(te(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),bv=["alt","control","meta","shift"],xS={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},MS={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},VS=(()=>{let e=class e extends Ks{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),c=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ti().onAndCancel(r,o.domEventName,c))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),c="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),c="code."),bv.forEach(f=>{let p=i.indexOf(f);p>-1&&(i.splice(p,1),c+=f+".")}),c+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=c,u}static matchEventFullKeyCode(r,i){let s=xS[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),bv.forEach(c=>{if(c!==s){let l=MS[c];l(r)&&(o+=c+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(te(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();function Pv(n,e){return zy(V({rootComponent:n},LS(e)))}function LS(n){return{appProviders:[...$S,...n?.providers??[]],platformProviders:jS}}function FS(){Lh.makeCurrent()}function US(){return new ch}function BS(){return Ny(document),document}var jS=[{provide:jt,useValue:Qy},{provide:ky,useValue:FS,multi:!0},{provide:Ve,useFactory:BS,deps:[]}];var $S=[{provide:Dy,useValue:"root"},{provide:ch,useFactory:US,deps:[]},{provide:uc,useClass:kS,multi:!0,deps:[Ve,ve,jt]},{provide:uc,useClass:VS,multi:!0,deps:[Ve]},{provide:uc,useClass:OS,multi:!0},ni,Av,Cv,{provide:Zr,useExisting:ni},{provide:rc,useClass:CS,deps:[]},[]];var Dv=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(te(Ve))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Uh=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n}(Uh||{});function Nv(...n){let e=[],t=new Set,r=t.has(Uh.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);return Ne([[],Wy(),t.has(Uh.NoHttpTransferCache)||r?[]:Iv({}),e])}var Q="primary",po=Symbol("RouteTitle"),Gh=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ci(n){return new Gh(n)}function GS(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],c=n[s];if(o[0]===":")i[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function WS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Zt(n[t],e[t]))return!1;return!0}function Zt(n,e){let t=n?Wh(n):void 0,r=e?Wh(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Uv(n[i],e[i]))return!1;return!0}function Wh(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Uv(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Bv(n){return n.length>0?n[n.length-1]:null}function zn(n){return Iy(n)?n:Za(n)?Xe(Promise.resolve(n)):z(n)}var HS={exact:$v,subset:qv},jv={exact:KS,subset:QS,ignored:()=>!0};function kv(n,e,t){return HS[t.paths](n.root,e.root,t.matrixParams)&&jv[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function KS(n,e){return Zt(n,e)}function $v(n,e,t){if(!fr(n.segments,e.segments)||!pc(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!$v(n.children[r],e.children[r],t))return!1;return!0}function QS(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Uv(n[t],e[t]))}function qv(n,e,t){return zv(n,e,e.segments,t)}function zv(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!fr(i,t)||e.hasChildren()||!pc(i,t,r))}else if(n.segments.length===t.length){if(!fr(n.segments,t)||!pc(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!qv(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!fr(n.segments,i)||!pc(n.segments,i,r)||!n.children[Q]?!1:zv(n.children[Q],e,s,r)}}function pc(n,e,t){return e.every((r,i)=>jv[t](n[i].parameters,r.parameters))}var wn=class{constructor(e=new fe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ci(this.queryParams),this._queryParamMap}toString(){return XS.serialize(this)}},fe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return mc(this)}},dr=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ci(this.parameters),this._parameterMap}toString(){return Wv(this)}};function YS(n,e){return fr(n,e)&&n.every((t,r)=>Zt(t.parameters,e[r].parameters))}function fr(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function JS(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Q&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Q&&(t=t.concat(e(i,r)))}),t}var yd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>new ro,providedIn:"root"});let n=e;return n})(),ro=class{parse(e){let t=new Kh(e);return new wn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Js(e.root,!0)}`,r=t0(e.queryParams),i=typeof e.fragment=="string"?`#${ZS(e.fragment)}`:"";return`${t}${r}${i}`}},XS=new ro;function mc(n){return n.segments.map(e=>Wv(e)).join("/")}function Js(n,e){if(!n.hasChildren())return mc(n);if(e){let t=n.children[Q]?Js(n.children[Q],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==Q&&r.push(`${i}:${Js(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=JS(n,(r,i)=>i===Q?[Js(n.children[Q],!1)]:[`${i}:${Js(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Q]!=null?`${mc(n)}/${t[0]}`:`${mc(n)}/(${t.join("//")})`}}function Gv(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function dc(n){return Gv(n).replace(/%3B/gi,";")}function ZS(n){return encodeURI(n)}function Hh(n){return Gv(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function gc(n){return decodeURIComponent(n)}function Ov(n){return gc(n.replace(/\+/g,"%20"))}function Wv(n){return`${Hh(n.path)}${e0(n.parameters)}`}function e0(n){return Object.entries(n).map(([e,t])=>`;${Hh(e)}=${Hh(t)}`).join("")}function t0(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${dc(t)}=${dc(i)}`).join("&"):`${dc(t)}=${dc(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var n0=/^[^\/()?;#]+/;function jh(n){let e=n.match(n0);return e?e[0]:""}var r0=/^[^\/()?;=#]+/;function i0(n){let e=n.match(r0);return e?e[0]:""}var s0=/^[^=?&#]+/;function o0(n){let e=n.match(s0);return e?e[0]:""}var a0=/^[^&#]+/;function c0(n){let e=n.match(a0);return e?e[0]:""}var Kh=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new fe([],{}):new fe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Q]=new fe(e,t)),r}parseSegment(){let e=jh(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ye(4009,!1);return this.capture(e),new dr(gc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=i0(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=jh(this.remaining);i&&(r=i,this.capture(r))}e[gc(t)]=gc(r)}parseQueryParam(e){let t=o0(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=c0(this.remaining);o&&(r=o,this.capture(r))}let i=Ov(t),s=Ov(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=jh(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ye(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Q);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[Q]:new fe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ye(4011,!1)}};function Hv(n){return n.segments.length>0?new fe([],{[Q]:n}):n}function Kv(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Kv(i);if(r===Q&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new fe(n.segments,e);return l0(t)}function l0(n){if(n.numberOfChildren===1&&n.children[Q]){let e=n.children[Q];return new fe(n.segments.concat(e.segments),e.children)}return n}function io(n){return n instanceof wn}function u0(n,e,t=null,r=null){let i=Qv(n);return Yv(i,e,t,r)}function Qv(n){let e;function t(s){let o={};for(let l of s.children){let u=t(l);o[l.outlet]=u}let c=new fe(s.url,o);return s===n&&(e=c),c}let r=t(n.root),i=Hv(r);return e??i}function Yv(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return $h(i,i,i,t,r);let s=h0(e);if(s.toRoot())return $h(i,i,new fe([],{}),t,r);let o=d0(s,i,n),c=o.processChildren?eo(o.segmentGroup,o.index,s.commands):Xv(o.segmentGroup,o.index,s.commands);return $h(i,o.segmentGroup,c,t,r)}function _c(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function so(n){return typeof n=="object"&&n!=null&&n.outlets}function $h(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`});let o;n===e?o=t:o=Jv(n,e,t);let c=Hv(Kv(o));return new wn(c,s,i)}function Jv(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Jv(s,e,t)}),new fe(n.segments,r)}var yc=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&_c(r[0]))throw new ye(4003,!1);let i=r.find(so);if(i&&i!==Bv(r))throw new ye(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function h0(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new yc(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,u])=>{c[l]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new yc(t,e,r)}var si=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function d0(n,e,t){if(n.isAbsolute)return new si(e,!0,0);if(!t)return new si(e,!1,NaN);if(t.parent===null)return new si(t,!0,0);let r=_c(n.commands[0])?0:1,i=t.segments.length-1+r;return f0(t,i,n.numberOfDoubleDots)}function f0(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ye(4005,!1);i=r.segments.length}return new si(r,!1,i-s)}function p0(n){return so(n[0])?n[0].outlets:{[Q]:n}}function Xv(n,e,t){if(n??=new fe([],{}),n.segments.length===0&&n.hasChildren())return eo(n,e,t);let r=m0(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new fe(n.segments.slice(0,r.pathIndex),{});return s.children[Q]=new fe(n.segments.slice(r.pathIndex),n.children),eo(s,0,i)}else return r.match&&i.length===0?new fe(n.segments,{}):r.match&&!n.hasChildren()?Qh(n,e,t):r.match?eo(n,0,i):Qh(n,e,t)}function eo(n,e,t){if(t.length===0)return new fe(n.segments,{});{let r=p0(t),i={};if(Object.keys(r).some(s=>s!==Q)&&n.children[Q]&&n.numberOfChildren===1&&n.children[Q].segments.length===0){let s=eo(n.children[Q],e,t);return new fe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Xv(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new fe(n.segments,i)}}function m0(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],c=t[r];if(so(c))break;let l=`${c}`,u=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!Mv(l,u,o))return s;r+=2}else{if(!Mv(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Qh(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(so(s)){let l=g0(s.outlets);return new fe(r,l)}if(i===0&&_c(t[0])){let l=n.segments[e];r.push(new dr(l.path,xv(t[0]))),i++;continue}let o=so(s)?s.outlets[Q]:`${s}`,c=i<t.length-1?t[i+1]:null;o&&c&&_c(c)?(r.push(new dr(o,xv(c))),i+=2):(r.push(new dr(o,{})),i++)}return new fe(r,{})}function g0(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Qh(new fe([],{}),0,r))}),e}function xv(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Mv(n,e,t){return n==t.path&&Zt(e,t.parameters)}var to="imperative",Ge=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ge||{}),Rt=class{constructor(e,t){this.id=e,this.url=t}},oo=class extends Rt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Ge.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},pr=class extends Rt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Ge.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},pt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(pt||{}),Yh=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Yh||{}),vn=class extends Rt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Ge.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},mr=class extends Rt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Ge.NavigationSkipped}},ao=class extends Rt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Ge.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},vc=class extends Rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ge.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jh=class extends Rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ge.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xh=class extends Rt{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Ge.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Zh=class extends Rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ge.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ed=class extends Rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ge.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},td=class{constructor(e){this.route=e,this.type=Ge.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},nd=class{constructor(e){this.route=e,this.type=Ge.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},rd=class{constructor(e){this.snapshot=e,this.type=Ge.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},id=class{constructor(e){this.snapshot=e,this.type=Ge.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sd=class{constructor(e){this.snapshot=e,this.type=Ge.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},od=class{constructor(e){this.snapshot=e,this.type=Ge.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var co=class{},li=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function _0(n,e){return n.providers&&!n._injector&&(n._injector=Vy(n.providers,e,`Route: ${n.path}`)),n._injector??e}function $t(n){return n.outlet||Q}function y0(n,e){let t=n.filter(r=>$t(r)===e);return t.push(...n.filter(r=>$t(r)!==e)),t}function mo(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var ad=class{get injector(){return mo(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Ac(this.rootInjector),this.attachRef=null}},Ac=(()=>{let e=class e{constructor(r){this.rootInjector=r,this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new ad(this.rootInjector),this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)(te(Yr))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),wc=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=cd(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=cd(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ld(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ld(e,this._root).map(t=>t.value)}};function cd(n,e){if(n===e.value)return e;for(let t of e.children){let r=cd(n,t);if(r)return r}return null}function ld(n,e){if(n===e.value)return[e];for(let t of e.children){let r=ld(n,t);if(r.length)return r.unshift(e),r}return[]}var ft=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ii(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ec=class extends wc{constructor(e,t){super(e),this.snapshot=t,vd(this,e)}toString(){return this.snapshot.toString()}};function Zv(n){let e=v0(n),t=new Et([new dr("",{})]),r=new Et({}),i=new Et({}),s=new Et({}),o=new Et(""),c=new ui(t,r,s,o,i,Q,n,e.root);return c.snapshot=e.root,new Ec(new ft(c,[]),e)}function v0(n){let e={},t={},r={},i="",s=new oi([],e,r,i,t,Q,n,null,{});return new Tc("",new ft(s,[]))}var ui=class{constructor(e,t,r,i,s,o,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(ee(u=>u[po]))??z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>ci(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>ci(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ic(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:V(V({},e.params),n.params),data:V(V({},e.data),n.data),resolve:V(V(V(V({},n.data),e.data),i?.data),n._resolvedData)}:r={params:V({},n.params),data:V({},n.data),resolve:V(V({},n.data),n._resolvedData??{})},i&&tw(i)&&(r.resolve[po]=i.title),r}var oi=class{get title(){return this.data?.[po]}constructor(e,t,r,i,s,o,c,l,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=c,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ci(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ci(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Tc=class extends wc{constructor(e,t){super(t),this.url=e,vd(this,t)}toString(){return ew(this._root)}};function vd(n,e){e.value._routerState=n,e.children.forEach(t=>vd(n,t))}function ew(n){let e=n.children.length>0?` { ${n.children.map(ew).join(", ")} } `:"";return`${n.value}${e}`}function qh(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Zt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Zt(e.params,t.params)||n.paramsSubject.next(t.params),WS(e.url,t.url)||n.urlSubject.next(t.url),Zt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ud(n,e){let t=Zt(n.params,e.params)&&YS(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||ud(n.parent,e.parent))}function tw(n){return typeof n.title=="string"||n.title===null}var wd=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Q,this.activateEvents=new Yt,this.deactivateEvents=new Yt,this.attachEvents=new Yt,this.detachEvents=new Yt,this.parentContexts=L(Ac),this.location=L(xy),this.changeDetector=L(Us),this.inputBinder=L(Ed,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ye(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ye(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ye(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new ye(4013,!1);this._activatedRoute=r;let s=this.location,c=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,u=new hd(r,l,s.injector);this.activated=s.createComponent(c,{index:s.length,injector:u,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ut({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Wa]});let n=e;return n})(),hd=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ui?this.route:e===Ac?this.childContexts:this.parent.get(e,t)}},Ed=new W("");function w0(n,e,t){let r=lo(n,e._root,t?t._root:void 0);return new Ec(r,e)}function lo(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=E0(n,e,t);return new ft(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>lo(n,c)),o}}let r=I0(e.value),i=e.children.map(s=>lo(n,s));return new ft(r,i)}}function E0(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return lo(n,r,i);return lo(n,r)})}function I0(n){return new ui(new Et(n.url),new Et(n.params),new Et(n.queryParams),new Et(n.fragment),new Et(n.data),n.outlet,n.component,n)}var uo=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},nw="ngNavigationCancelingError";function bc(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=io(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=rw(!1,pt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function rw(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[nw]=!0,t.cancellationCode=e,t}function T0(n){return iw(n)&&io(n.url)}function iw(n){return!!n&&n[nw]}var b0=(n,e,t,r)=>ee(i=>(new dd(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),dd=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),qh(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ii(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ii(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ii(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ii(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new od(s.value.snapshot))}),e.children.length&&this.forwardEvent(new id(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(qh(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),qh(c.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},Cc=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ai=class{constructor(e,t){this.component=e,this.route=t}};function C0(n,e,t){let r=n._root,i=e?e._root:null;return Xs(r,i,t,[r.value])}function A0(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function di(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Py(n)?n:e.get(n):r}function Xs(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ii(e);return n.children.forEach(o=>{S0(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>no(c,t.getContext(o),i)),i}function S0(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=R0(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new Cc(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Xs(n,e,c?c.children:null,r,i):Xs(n,e,t,r,i),l&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new ai(c.outlet.component,o))}else o&&no(e,c,i),i.canActivateChecks.push(new Cc(r)),s.component?Xs(n,null,c?c.children:null,r,i):Xs(n,null,t,r,i);return i}function R0(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!fr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!fr(n.url,e.url)||!Zt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ud(n,e)||!Zt(n.queryParams,e.queryParams);case"paramsChange":default:return!ud(n,e)}}function no(n,e,t){let r=ii(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?no(o,e.children.getContext(s),t):no(o,null,t):no(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ai(e.outlet.component,i)):t.canDeactivateChecks.push(new ai(null,i)):t.canDeactivateChecks.push(new ai(null,i))}function go(n){return typeof n=="function"}function P0(n){return typeof n=="boolean"}function D0(n){return n&&go(n.canLoad)}function N0(n){return n&&go(n.canActivate)}function k0(n){return n&&go(n.canActivateChild)}function O0(n){return n&&go(n.canDeactivate)}function x0(n){return n&&go(n.canMatch)}function sw(n){return n instanceof Ty||n?.name==="EmptyError"}var fc=Symbol("INITIAL_VALUE");function hi(){return Tt(n=>th(n.map(e=>e.pipe(Kr(1),oh(fc)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===fc)return fc;if(t===!1||M0(t))return t}return!0}),_n(e=>e!==fc),Kr(1)))}function M0(n){return io(n)||n instanceof uo}function V0(n,e){return It(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?z(_e(V({},t),{guardsResult:!0})):L0(o,r,i,n).pipe(It(c=>c&&P0(c)?F0(r,s,n,e):z(c)),ee(c=>_e(V({},t),{guardsResult:c})))})}function L0(n,e,t,r){return Xe(n).pipe(It(i=>q0(i.component,i.route,t,e,r)),Un(i=>i!==!0,!0))}function F0(n,e,t,r){return Xe(e).pipe(ar(i=>by(B0(i.route.parent,r),U0(i.route,r),$0(n,i.path,t),j0(n,i.route,t))),Un(i=>i!==!0,!0))}function U0(n,e){return n!==null&&e&&e(new sd(n)),z(!0)}function B0(n,e){return n!==null&&e&&e(new rd(n)),z(!0)}function j0(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return z(!0);let i=r.map(s=>nh(()=>{let o=mo(e)??t,c=di(s,o),l=N0(c)?c.canActivate(e,n):Bt(o,()=>c(e,n));return zn(l).pipe(Un())}));return z(i).pipe(hi())}function $0(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>A0(o)).filter(o=>o!==null).map(o=>nh(()=>{let c=o.guards.map(l=>{let u=mo(o.node)??t,f=di(l,u),p=k0(f)?f.canActivateChild(r,n):Bt(u,()=>f(r,n));return zn(p).pipe(Un())});return z(c).pipe(hi())}));return z(s).pipe(hi())}function q0(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return z(!0);let o=s.map(c=>{let l=mo(e)??i,u=di(c,l),f=O0(u)?u.canDeactivate(n,e,t,r):Bt(l,()=>u(n,e,t,r));return zn(f).pipe(Un())});return z(o).pipe(hi())}function z0(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return z(!0);let s=i.map(o=>{let c=di(o,n),l=D0(c)?c.canLoad(e,t):Bt(n,()=>c(e,t));return zn(l)});return z(s).pipe(hi(),ow(r))}function ow(n){return Qu(De(e=>{if(typeof e!="boolean")throw bc(n,e)}),ee(e=>e===!0))}function G0(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return z(!0);let s=i.map(o=>{let c=di(o,n),l=x0(c)?c.canMatch(e,t):Bt(n,()=>c(e,t));return zn(l)});return z(s).pipe(hi(),ow(r))}var ho=class{constructor(e){this.segmentGroup=e||null}},fo=class extends Error{constructor(e){super(),this.urlTree=e}};function ri(n){return Ns(new ho(n))}function W0(n){return Ns(new ye(4e3,!1))}function H0(n){return Ns(rw(!1,pt.GuardRejected))}var fd=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return z(r);if(i.numberOfChildren>1||!i.children[Q])return W0(`${e.redirectTo}`);i=i.children[Q]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let c=t,{queryParams:l,fragment:u,routeConfig:f,url:p,outlet:g,params:T,data:S,title:D}=i,P=Bt(s,()=>c({params:T,data:S,queryParams:l,fragment:u,routeConfig:f,url:p,outlet:g,title:D}));if(P instanceof wn)throw new fo(P);t=P}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new fo(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new wn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([c,l])=>{o[c]=this.createSegmentGroup(e,l,r,i)}),new fe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ye(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},pd={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function K0(n,e,t,r,i){let s=aw(n,e,t);return s.matched?(r=_0(e,r),G0(r,e,t,i).pipe(ee(o=>o===!0?s:V({},pd)))):z(s)}function aw(n,e,t){if(e.path==="**")return Q0(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?V({},pd):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||GS)(t,n,e);if(!i)return V({},pd);let s={};Object.entries(i.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let o=i.consumed.length>0?V(V({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Q0(n){return{matched:!0,parameters:n.length>0?Bv(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Vv(n,e,t,r){return t.length>0&&X0(n,t,r)?{segmentGroup:new fe(e,J0(r,new fe(t,n.children))),slicedSegments:[]}:t.length===0&&Z0(n,t,r)?{segmentGroup:new fe(n.segments,Y0(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new fe(n.segments,n.children),slicedSegments:t}}function Y0(n,e,t,r){let i={};for(let s of t)if(Sc(n,e,s)&&!r[$t(s)]){let o=new fe([],{});i[$t(s)]=o}return V(V({},r),i)}function J0(n,e){let t={};t[Q]=e;for(let r of n)if(r.path===""&&$t(r)!==Q){let i=new fe([],{});t[$t(r)]=i}return t}function X0(n,e,t){return t.some(r=>Sc(n,e,r)&&$t(r)!==Q)}function Z0(n,e,t){return t.some(r=>Sc(n,e,r))}function Sc(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function eR(n,e,t){return e.length===0&&!n.children[t]}var md=class{};function tR(n,e,t,r,i,s,o="emptyOnly"){return new gd(n,e,t,r,i,o,s).recognize()}var nR=31,gd=class{constructor(e,t,r,i,s,o,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.applyRedirects=new fd(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ye(4002,`'${e.segmentGroup}'`)}recognize(){let e=Vv(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(({children:t,rootSnapshot:r})=>{let i=new ft(r,t),s=new Tc("",i),o=u0(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new oi([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Q,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Q,t).pipe(ee(r=>({children:r,rootSnapshot:t})),Hr(r=>{if(r instanceof fo)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ho?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(ee(o=>o instanceof ft?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return Xe(s).pipe(ar(o=>{let c=r.children[o],l=y0(t,o);return this.processSegmentGroup(e,l,c,o,i)}),sh((o,c)=>(o.push(...c),o)),rh(null),Sy(),It(o=>{if(o===null)return ri(r);let c=cw(o);return rR(c),z(c)}))}processSegment(e,t,r,i,s,o,c){return Xe(t).pipe(ar(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,r,i,s,o,c).pipe(Hr(u=>{if(u instanceof ho)return z(null);throw u}))),Un(l=>!!l),Hr(l=>{if(sw(l))return eR(r,i,s)?z(new md):ri(r);throw l}))}processSegmentAgainstRoute(e,t,r,i,s,o,c,l){return $t(r)!==o&&(o===Q||!Sc(i,s,r))?ri(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,l):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,l):ri(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,c){let{matched:l,parameters:u,consumedSegments:f,positionalParamSegments:p,remainingSegments:g}=aw(t,i,s);if(!l)return ri(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>nR&&(this.allowRedirects=!1));let T=new oi(s,u,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Lv(i),$t(i),i.component??i._loadedComponent??null,i,Fv(i)),S=Ic(T,c,this.paramsInheritanceStrategy);T.params=Object.freeze(S.params),T.data=Object.freeze(S.data);let D=this.applyRedirects.applyRedirectCommands(f,i.redirectTo,p,T,e);return this.applyRedirects.lineralizeSegments(i,D).pipe(It(P=>this.processSegment(e,r,t,P.concat(g),o,!1,c)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let c=K0(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),c.pipe(Tt(l=>l.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Tt(({routes:u})=>{let f=r._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:T}=l,S=new oi(g,p,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Lv(r),$t(r),r.component??r._loadedComponent??null,r,Fv(r)),D=Ic(S,o,this.paramsInheritanceStrategy);S.params=Object.freeze(D.params),S.data=Object.freeze(D.data);let{segmentGroup:P,slicedSegments:M}=Vv(t,g,T,u);if(M.length===0&&P.hasChildren())return this.processChildren(f,u,P,S).pipe(ee(B=>new ft(S,B)));if(u.length===0&&M.length===0)return z(new ft(S,[]));let $=$t(r)===s;return this.processSegment(f,u,P,M,$?Q:s,!0,S).pipe(ee(B=>new ft(S,B instanceof ft?[B]:[])))}))):ri(t)))}getChildConfig(e,t,r){return t.children?z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?z({routes:t._loadedRoutes,injector:t._loadedInjector}):z0(e,t,r,this.urlSerializer).pipe(It(i=>i?this.configLoader.loadChildren(e,t).pipe(De(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):H0(t))):z({routes:[],injector:e})}};function rR(n){n.sort((e,t)=>e.value.outlet===Q?-1:t.value.outlet===Q?1:e.value.outlet.localeCompare(t.value.outlet))}function iR(n){let e=n.value.routeConfig;return e&&e.path===""}function cw(n){let e=[],t=new Set;for(let r of n){if(!iR(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=cw(r.children);e.push(new ft(r.value,i))}return e.filter(r=>!t.has(r))}function Lv(n){return n.data||{}}function Fv(n){return n.resolve||{}}function sR(n,e,t,r,i,s){return It(o=>tR(n,e,t,r,o.extractedUrl,i,s).pipe(ee(({state:c,tree:l})=>_e(V({},o),{targetSnapshot:c,urlAfterRedirects:l}))))}function oR(n,e){return It(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return z(t);let s=new Set(i.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let u of lw(l))o.add(u);let c=0;return Xe(o).pipe(ar(l=>s.has(l)?aR(l,r,n,e):(l.data=Ic(l,l.parent,n).resolve,z(void 0))),De(()=>c++),ih(1),It(l=>c===o.size?z(t):Fn))})}function lw(n){let e=n.children.map(t=>lw(t)).flat();return[n,...e]}function aR(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!tw(i)&&(s[po]=i.title),cR(s,n,e,r).pipe(ee(o=>(n._resolvedData=o,n.data=Ic(n,n.parent,t).resolve,null)))}function cR(n,e,t,r){let i=Wh(n);if(i.length===0)return z({});let s={};return Xe(i).pipe(It(o=>lR(n[o],e,t,r).pipe(Un(),De(c=>{if(c instanceof uo)throw bc(new ro,c);s[o]=c}))),ih(1),Ay(s),Hr(o=>sw(o)?Fn:Ns(o)))}function lR(n,e,t,r){let i=mo(e)??r,s=di(n,i),o=s.resolve?s.resolve(e,t):Bt(i,()=>s(e,t));return zn(o)}function zh(n){return Tt(e=>{let t=n(e);return t?Xe(t).pipe(ee(()=>e)):z(e)})}var uw=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===Q);return i}getResolvedTitleForRoute(r){return r.data[po]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>L(uR),providedIn:"root"});let n=e;return n})(),uR=(()=>{let e=class e extends uw{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(te(Dv))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Id=new W("",{providedIn:"root",factory:()=>({})}),hR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=bt({type:e,selectors:[["ng-component"]],standalone:!0,features:[At],decls:1,vars:0,template:function(i,s){i&1&&ze(0,"router-outlet")},dependencies:[wd],encapsulation:2});let n=e;return n})();function Td(n){let e=n.children&&n.children.map(Td),t=e?_e(V({},n),{children:e}):V({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Q&&(t.component=hR),t}var bd=new W(""),dR=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=L(Eh)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return z(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=zn(r.loadComponent()).pipe(ee(hw),De(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Qr(()=>{this.componentLoaders.delete(r)})),s=new Ju(i,()=>new gn).pipe(Yu());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return z({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=fR(i,this.compiler,r,this.onLoadEndListener).pipe(Qr(()=>{this.childrenLoaders.delete(i)})),c=new Ju(o,()=>new gn).pipe(Yu());return this.childrenLoaders.set(i,c),c}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function fR(n,e,t,r){return zn(n.loadChildren()).pipe(ee(hw),It(i=>i instanceof My||Array.isArray(i)?z(i):Xe(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let s,o,c=!1;return Array.isArray(i)?(o=i,c=!0):(s=i.create(t).injector,o=s.get(bd,[],{optional:!0,self:!0}).flat()),{routes:o.map(Td),injector:s}}))}function pR(n){return n&&typeof n=="object"&&"default"in n}function hw(n){return pR(n)?n.default:n}var Cd=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>L(mR),providedIn:"root"});let n=e;return n})(),mR=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gR=new W("");var _R=new W(""),yR=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new gn,this.transitionAbortSubject=new gn,this.configLoader=L(dR),this.environmentInjector=L(Yr),this.urlSerializer=L(yd),this.rootContexts=L(Ac),this.location=L(tc),this.inputBindingEnabled=L(Ed,{optional:!0})!==null,this.titleStrategy=L(uw),this.options=L(Id,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=L(Cd),this.createViewTransition=L(gR,{optional:!0}),this.navigationErrorHandler=L(_R,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>z(void 0),this.rootComponentType=null;let r=s=>this.events.next(new td(s)),i=s=>this.events.next(new nd(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(_e(V(V({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Et({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:to,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(_n(o=>o.id!==0),ee(o=>_e(V({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Tt(o=>{let c=!1,l=!1;return z(o).pipe(Tt(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",pt.SupersededByNewNavigation),Fn;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,targetBrowserUrl:typeof u.extras.browserUrl=="string"?this.urlSerializer.parse(u.extras.browserUrl):u.extras.browserUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?_e(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!f&&p!=="reload"){let g="";return this.events.next(new mr(u.id,this.urlSerializer.serialize(u.rawUrl),g,Yh.IgnoredSameUrlNavigation)),u.resolve(!1),Fn}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return z(u).pipe(Tt(g=>{let T=this.transitions?.getValue();return this.events.next(new oo(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),T!==this.transitions?.getValue()?Fn:Promise.resolve(g)}),sR(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),De(g=>{o.targetSnapshot=g.targetSnapshot,o.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=_e(V({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let T=new vc(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(T)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:g,extractedUrl:T,source:S,restoredState:D,extras:P}=u,M=new oo(g,this.urlSerializer.serialize(T),S,D);this.events.next(M);let $=Zv(this.rootComponentType).snapshot;return this.currentTransition=o=_e(V({},u),{targetSnapshot:$,urlAfterRedirects:T,extras:_e(V({},P),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=T,z(o)}else{let g="";return this.events.next(new mr(u.id,this.urlSerializer.serialize(u.extractedUrl),g,Yh.IgnoredByUrlHandlingStrategy)),u.resolve(!1),Fn}}),De(u=>{let f=new Jh(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),ee(u=>(this.currentTransition=o=_e(V({},u),{guards:C0(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),V0(this.environmentInjector,u=>this.events.next(u)),De(u=>{if(o.guardsResult=u.guardsResult,u.guardsResult&&typeof u.guardsResult!="boolean")throw bc(this.urlSerializer,u.guardsResult);let f=new Xh(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(f)}),_n(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",pt.GuardRejected),!1)),zh(u=>{if(u.guards.canActivateChecks.length)return z(u).pipe(De(f=>{let p=new Zh(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}),Tt(f=>{let p=!1;return z(f).pipe(oR(this.paramsInheritanceStrategy,this.environmentInjector),De({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(f,"",pt.NoDataFromResolver)}}))}),De(f=>{let p=new ed(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}))}),zh(u=>{let f=p=>{let g=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(p.routeConfig).pipe(De(T=>{p.component=T}),ee(()=>{})));for(let T of p.children)g.push(...f(T));return g};return th(f(u.targetSnapshot.root)).pipe(rh(null),Kr(1))}),zh(()=>this.afterPreactivation()),Tt(()=>{let{currentSnapshot:u,targetSnapshot:f}=o,p=this.createViewTransition?.(this.environmentInjector,u.root,f.root);return p?Xe(p).pipe(ee(()=>o)):z(o)}),ee(u=>{let f=w0(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=_e(V({},u),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,o}),De(()=>{this.events.next(new co)}),b0(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Kr(1),De({next:u=>{c=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new pr(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{c=!0}}),Ry(this.transitionAbortSubject.pipe(De(u=>{throw u}))),Qr(()=>{!c&&!l&&this.cancelNavigationTransition(o,"",pt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Hr(u=>{if(l=!0,iw(u))this.events.next(new vn(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),T0(u)?this.events.next(new li(u.url,u.navigationBehaviorOptions)):o.resolve(!1);else{let f=new ao(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0);try{let p=Bt(this.environmentInjector,()=>this.navigationErrorHandler?.(f));if(p instanceof uo){let{message:g,cancellationCode:T}=bc(this.urlSerializer,p);this.events.next(new vn(o.id,this.urlSerializer.serialize(o.extractedUrl),g,T)),this.events.next(new li(p.redirectTo,p.navigationBehaviorOptions))}else{this.events.next(f);let g=r.errorHandler(u);o.resolve(!!g)}}catch(p){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(p)}}return Fn}))}))}cancelNavigationTransition(r,i,s){let o=new vn(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let r=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return r.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function vR(n){return n!==to}var wR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>L(ER),providedIn:"root"});let n=e;return n})(),_d=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},ER=(()=>{let e=class e extends _d{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Os(e)))(s||e)}})(),e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),dw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>L(IR),providedIn:"root"});let n=e;return n})(),IR=(()=>{let e=class e extends dw{constructor(){super(...arguments),this.location=L(tc),this.urlSerializer=L(yd),this.options=L(Id,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=L(Cd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new wn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Zv(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof oo)this.stateMemento=this.createStateMemento();else if(r instanceof mr)this.rawUrlTree=i.initialUrl;else if(r instanceof vc){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??s,i)}}else r instanceof co?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):r instanceof vn&&(r.code===pt.GuardRejected||r.code===pt.NoDataFromResolver)?this.restoreHistory(i):r instanceof ao?this.restoreHistory(i,!0):r instanceof pr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=r instanceof wn?this.urlSerializer.serialize(r):r;if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,c=V(V({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",c)}else{let o=V(V({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Os(e)))(s||e)}})(),e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Zs=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Zs||{});function TR(n,e){n.events.pipe(_n(t=>t instanceof pr||t instanceof vn||t instanceof ao||t instanceof mr),ee(t=>t instanceof pr||t instanceof mr?Zs.COMPLETE:(t instanceof vn?t.code===pt.Redirect||t.code===pt.SupersededByNewNavigation:!1)?Zs.REDIRECTING:Zs.FAILED),_n(t=>t!==Zs.REDIRECTING),Kr(1)).subscribe(()=>{e()})}function bR(n){throw n}var CR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},AR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Rc=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=L(Xa),this.stateManager=L(dw),this.options=L(Id,{optional:!0})||{},this.pendingTasks=L(Ha),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=L(yR),this.urlSerializer=L(yd),this.location=L(tc),this.urlHandlingStrategy=L(Cd),this._events=new gn,this.errorHandler=this.options.errorHandler||bR,this.navigated=!1,this.routeReuseStrategy=L(wR),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=L(bd,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!L(Ed,{optional:!0}),this.eventsSubscription=new vy,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof vn&&i.code!==pt.Redirect&&i.code!==pt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof pr)this.navigated=!0;else if(i instanceof li){let c=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u=V({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||vR(s.source)},c);this.scheduleNavigation(l,to,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}RR(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),to,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},c=s?.navigationId?s:null;if(s){let u=V({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,c,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Td),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:c,queryParamsHandling:l,preserveFragment:u}=i,f=u?this.currentUrlTree.fragment:c,p=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":p=V(V({},this.currentUrlTree.queryParams),o);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=o||null}p!==null&&(p=this.removeEmptyProps(p));let g;try{let T=s?s.snapshot:this.routerState.snapshot.root;g=Qv(T)}catch{(typeof r[0]!="string"||r[0][0]!=="/")&&(r=[]),g=this.currentUrlTree.root}return Yv(g,r,p,f??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=io(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,to,null,i)}navigate(r,i={skipLocationChange:!1}){return SR(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=V({},CR):i===!1?s=V({},AR):s=i,io(r))return kv(this.currentUrlTree,r,s);let o=this.parseUrl(r);return kv(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,c){if(this.disposed)return Promise.resolve(!1);let l,u,f;c?(l=c.resolve,u=c.reject,f=c.promise):f=new Promise((g,T)=>{l=g,u=T});let p=this.pendingTasks.add();return TR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:l,reject:u,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(g=>Promise.reject(g))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function SR(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ye(4008,!1)}function RR(n){return!(n instanceof co)&&!(n instanceof li)}var PR=new W("");function fw(n,...e){return Ne([{provide:bd,multi:!0,useValue:n},[],{provide:ui,useFactory:DR,deps:[Rc]},{provide:ec,multi:!0,useFactory:NR},e.map(t=>t.\u0275providers)])}function DR(n){return n.routerState.root}function NR(){let n=L(at);return e=>{let t=n.get(Fs);if(e!==t.components[0])return;let r=n.get(Rc),i=n.get(kR);n.get(OR)===1&&r.initialNavigation(),n.get(xR,null,ah.Optional)?.setUpPreloading(),n.get(PR,null,ah.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var kR=new W("",{factory:()=>new gn}),OR=new W("",{providedIn:"root",factory:()=>1});var xR=new W("");var Pc=class n{loggedIn=!1;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=bt({type:n,selectors:[["app-menu"]],standalone:!0,features:[At],decls:16,vars:0,consts:[[1,"socials-wrapper"],[1,"socials"],["href","https://www.youtube.com/@_TpoX","target","_blank"],[1,"fa-brands","fa-youtube"],["href","https://x.com/iTzSteffen","target","_blank"],[1,"fa-brands","fa-x-twitter"],["href","https://www.instagram.com/steffen_1205/","target","_blank"],[1,"fa-brands","fa-instagram"],[1,"login"],["href","/login"],[1,"fa","fa-right-to-bracket"]],template:function(t,r){t&1&&(ue(0,"nav")(1,"div",0)(2,"div",1)(3,"div")(4,"a",2),ze(5,"i",3),le()(),ue(6,"div")(7,"a",4),ze(8,"i",5),le()(),ue(9,"div")(10,"a",6),ze(11,"i",7),le()()(),ue(12,"div",8)(13,"button")(14,"a",9),ze(15,"i",10),le()()()()())},styles:["nav[_ngcontent-%COMP%]{background:transparent;position:fixed;z-index:200;margin-top:1em;width:100%}.socials-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.socials-wrapper[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding-right:1em}.socials-wrapper[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;font-size:1.2em;padding:.5em;transition:.5s}.socials-wrapper[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#f06292;cursor:pointer}.socials[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;width:10%;padding-left:1em}.socials[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;font-size:1.2em;padding:.5em;transition:.5s}.socials[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#f06292;cursor:pointer}button[_ngcontent-%COMP%]{background:#23262d;color:#fff;border:none;padding:.5rem 1rem;font-size:1rem;cursor:pointer;border-radius:5px;transition:all .3s}"]})};var Nc=class n{title="styffen.github.io";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=bt({type:n,selectors:[["app-root"]],standalone:!0,features:[At],decls:2,vars:0,template:function(t,r){t&1&&ze(0,"app-menu")(1,"router-outlet")},dependencies:[wd,Pc]})};var kc=class n{constructor(e){this.document=e;this.document.addEventListener("DOMContentLoaded",()=>{let i=e.querySelector(".interactive"),s=0,o=0,c=0,l=0;function u(){s+=(c-s)/20,o+=(l-o)/20,i.style.transform=`translate(${Math.round(s)}px, ${Math.round(o)}px)`,requestAnimationFrame(()=>{u()})}window.addEventListener("mousemove",f=>{c=f.clientX,l=f.clientY}),u()});let t=this.document.getElementById("design"),r=this.document.getElementById("build");t?.addEventListener("mouseover",()=>{let i=this.document.querySelector(".interactive");console.log(i),i instanceof HTMLElement&&(i.style.background=`radial-gradient(
          circle at center,
          rgba(240, 98, 146, 0.8) 0%,
          rgba(240, 98, 146, 0) 50%
        ) no-repeat`)}),r?.addEventListener("mouseover",()=>{let i=this.document.querySelector(".interactive");console.log(i),i instanceof HTMLElement&&(i.style.background=`radial-gradient(
          circle at center,
          rgba(100, 255, 218, 0.8) 0%,
          rgba(100, 255, 218  , 0) 50%
        ) no-repeat`)})}static \u0275fac=function(t){return new(t||n)(Se(Ve))};static \u0275cmp=bt({type:n,selectors:[["app-home"]],standalone:!0,features:[At],decls:19,vars:0,consts:[[1,"text-container",2,"display","flex","flex-direction","column"],["src","assets/steffen.png"],[1,"welcome"],["id","design",1,"pink"],["id","build",1,"blue"],[1,"gradient-bg"],[1,"gradients-container"],[1,"interactive"]],template:function(t,r){t&1&&(ue(0,"div",0)(1,"div"),ze(2,"img",1),le(),ue(3,"div",2),Ie(4," Hello!"),ze(5,"br"),Ie(6,"I'm Steffen."),ze(7,"br"),Ie(8," I "),ue(9,"span",3),Ie(10,"design"),le(),Ie(11," & "),ue(12,"span",4),Ie(13,"build"),le(),ze(14,"br"),Ie(15,"web applications. "),le()(),ue(16,"div",5)(17,"div",6),ze(18,"div",7),le()())},styles:[".pink[_ngcontent-%COMP%]{color:#f06292}.blue[_ngcontent-%COMP%]{color:#64ffda}.text-container[_ngcontent-%COMP%]{z-index:100;width:100vw;height:100vh;display:flex;position:absolute;top:0;left:0;justify-content:center;align-items:center;font-size:2em;color:#fff;opacity:.8;-webkit-user-select:none;user-select:none;text-shadow:1px 1px rgba(0,0,0,.1)}@keyframes _ngcontent-%COMP%_moveInCircle{0%{transform:rotate(0)}50%{transform:rotate(180deg)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_moveVertical{0%{transform:translateY(-50%)}50%{transform:translateY(50%)}to{transform:translateY(-50%)}}@keyframes _ngcontent-%COMP%_moveHorizontal{0%{transform:translate(-50%) translateY(-10%)}50%{transform:translate(50%) translateY(10%)}to{transform:translate(-50%) translateY(-10%)}}.gradient-bg[_ngcontent-%COMP%]{width:100vw;height:100vh;position:relative;overflow:hidden;background:#000;top:0;left:0}.gradient-bg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:none}.gradient-bg[_ngcontent-%COMP%]   .gradients-container[_ngcontent-%COMP%]{filter:blur(40px);width:100%;height:100%}.gradient-bg[_ngcontent-%COMP%]   .interactive[_ngcontent-%COMP%]{position:absolute;background:radial-gradient(circle at center,rgba(var(--color-interactive),.8) 0,rgba(var(--color-interactive),0) 50%) no-repeat;mix-blend-mode:var(--blending);width:100%;height:100%;top:-50%;left:-50%;opacity:.7}"]})};var Yd={};zA(Yd,{FirebaseError:()=>We,SDK_VERSION:()=>ct,_DEFAULT_ENTRY_NAME:()=>nn,_addComponent:()=>vi,_addOrOverwriteComponent:()=>Qd,_apps:()=>Wn,_clearComponents:()=>MP,_components:()=>yi,_getProvider:()=>gt,_isFirebaseApp:()=>$w,_isFirebaseServerApp:()=>rn,_registerComponent:()=>He,_removeServiceInstance:()=>jw,_serverApps:()=>_i,deleteApp:()=>Co,getApp:()=>_t,getApps:()=>bo,initializeApp:()=>wi,initializeServerApp:()=>qw,onLog:()=>$c,registerVersion:()=>J,setLogLevel:()=>qc});var Sd={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var O=function(n,e){if(!n)throw _r(e)},_r=function(n){return new Error("Firebase Database ("+Sd.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var mw=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},VR=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},xc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,f=s>>2,p=(s&3)<<4|c>>4,g=(c&15)<<2|u>>6,T=u&63;l||(T=64,o||(g=64)),r.push(t[f],t[p],t[g],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(mw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):VR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||u==null||p==null)throw new Rd;let g=s<<2|c>>4;if(r.push(g),u!==64){let T=c<<4&240|u>>2;if(r.push(T),p!==64){let S=u<<6&192|p;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Rd=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Dd=function(n){let e=mw(n);return xc.encodeByteArray(e,!0)},_o=function(n){return Dd(n).replace(/\./g,"")},yo=function(n){try{return xc.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gw(n){return pi(void 0,n)}function pi(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!LR(t)||(n[t]=pi(n[t],e[t]));return n}function LR(n){return n!=="__proto__"}function Nd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var FR=()=>Nd().__FIREBASE_DEFAULTS__,UR=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&yo(n[1]);return e&&JSON.parse(e)},Mc=()=>{try{return FR()||UR()||BR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},kd=n=>{var e,t;return(t=(e=Mc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Gn=n=>{let e=kd(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Od=()=>{var n;return(n=Mc())===null||n===void 0?void 0:n.config},xd=n=>{var e;return(e=Mc())===null||e===void 0?void 0:e[`_${n}`]};var gr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function mi(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[_o(JSON.stringify(t)),_o(JSON.stringify(o)),""].join(".")}function Fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vo(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function jR(){var n;let e=(n=Mc())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _w(){return typeof window<"u"||Md()}function Md(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function yw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vw(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Vc(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ww(){let n=Fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function en(){return Sd.NODE_CLIENT===!0||Sd.NODE_ADMIN===!0}function Ew(){return!jR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vd(){try{return typeof indexedDB=="object"}catch{return!1}}function Iw(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var $R="FirebaseError",We=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=$R,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pt.prototype.create)}},Pt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?qR(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new We(i,c,r)}};function qR(n,e){return n.replace(zR,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var zR=/\{\$([^}]+)}/g;function fi(n){return JSON.parse(n)}function Ue(n){return JSON.stringify(n)}var Tw=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=fi(yo(s[0])||""),t=fi(yo(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var bw=function(n){let e=Tw(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Cw=function(n){let e=Tw(n).claims;return typeof e=="object"&&e.admin===!0};function mt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function yr(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function wo(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Eo(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function vr(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(pw(s)&&pw(o)){if(!vr(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function pw(n){return n!==null&&typeof n=="object"}function wr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}var Oc=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let p=0;p<16;p++)r[p]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let p=0;p<16;p++)r[p]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let p=16;p<80;p++){let g=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=(g<<1|g>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],c=this.chain_[3],l=this.chain_[4],u,f;for(let p=0;p<80;p++){p<40?p<20?(u=c^s&(o^c),f=1518500249):(u=s^o^c,f=1859775393):p<60?(u=s&o|c&(s|o),f=2400959708):(u=s^o^c,f=3395469782);let g=(i<<5|i>>>27)+u+l+f+r[p]&4294967295;l=c,c=o,o=(s<<30|s>>>2)&4294967295,s=i,i=g}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Lc(n,e){let t=new Pd(n,e);return t.subscribe.bind(t)}var Pd=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");GR(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ad),i.error===void 0&&(i.error=Ad),i.complete===void 0&&(i.complete=Ad);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function GR(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ad(){}function Aw(n,e){return`${n} failed: ${e} argument `}var Sw=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,O(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Io=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var WF=4*60*60*1e3;function Be(n){return n&&n._delegate?n._delegate:n}var ke=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Er="[DEFAULT]";var Fc=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new gr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HR(e))try{this.getOrInitializeService({instanceIdentifier:Er})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Er){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return w(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Er){return this.instances.has(e)}getOptions(e=Er){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:WR(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Er){return this.component?this.component.multipleInstances?e:Er:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function WR(n){return n===Er?void 0:n}function HR(n){return n.instantiationMode==="EAGER"}var gi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Fc(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Ld=[],X=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(X||{}),Rw={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},KR=X.INFO,QR={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},YR=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=QR[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Dt=class{constructor(e){this.name=e,this._logLevel=KR,this._logHandler=YR,this._userLogHandler=null,Ld.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in X))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Rw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...e),this._logHandler(this,X.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...e),this._logHandler(this,X.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,X.INFO,...e),this._logHandler(this,X.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,X.WARN,...e),this._logHandler(this,X.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...e),this._logHandler(this,X.ERROR,...e)}};function Pw(n){Ld.forEach(e=>{e.setLogLevel(n)})}function Dw(n,e){for(let t of Ld){let r=null;e&&e.level&&(r=Rw[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let c=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&n({level:X[s].toLowerCase(),message:c,args:o,type:i.name})}}}var JR=(n,e)=>e.some(t=>n instanceof t),Nw,kw;function XR(){return Nw||(Nw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZR(){return kw||(kw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Ow=new WeakMap,Ud=new WeakMap,xw=new WeakMap,Fd=new WeakMap,jd=new WeakMap;function eP(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(tn(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Ow.set(t,n)}).catch(()=>{}),jd.set(e,n),e}function tP(n){if(Ud.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Ud.set(n,e)}var Bd={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ud.get(n);if(e==="objectStoreNames")return n.objectStoreNames||xw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return tn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Mw(n){Bd=n(Bd)}function nP(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Uc(this),e,...t);return xw.set(r,e.sort?e.sort():[e]),tn(r)}:ZR().includes(n)?function(...e){return n.apply(Uc(this),e),tn(Ow.get(this))}:function(...e){return tn(n.apply(Uc(this),e))}}function rP(n){return typeof n=="function"?nP(n):(n instanceof IDBTransaction&&tP(n),JR(n,XR())?new Proxy(n,Bd):n)}function tn(n){if(n instanceof IDBRequest)return eP(n);if(Fd.has(n))return Fd.get(n);let e=rP(n);return e!==n&&(Fd.set(n,e),jd.set(e,n)),e}var Uc=n=>jd.get(n);function Lw(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=tn(o);return r&&o.addEventListener("upgradeneeded",l=>{r(tn(o.result),l.oldVersion,l.newVersion,tn(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}var iP=["get","getKey","getAll","getAllKeys","count"],sP=["put","add","delete","clear"],$d=new Map;function Vw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if($d.get(e))return $d.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=sP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||iP.includes(t)))return;let s=function(o,...c){return w(this,null,function*(){let l=this.transaction(o,i?"readwrite":"readonly"),u=l.store;return r&&(u=u.index(c.shift())),(yield Promise.all([u[t](...c),i&&l.done]))[0]})};return $d.set(e,s),s}Mw(n=>_e(V({},n),{get:(e,t,r)=>Vw(e,t)||n.get(e,t,r),has:(e,t)=>!!Vw(e,t)||n.has(e,t)}));var zd=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oP(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function oP(n){let e=n.getComponent();return e?.type==="VERSION"}var Bc="@firebase/app",Gd="0.10.13";var En=new Dt("@firebase/app"),aP="@firebase/app-compat",cP="@firebase/analytics-compat",lP="@firebase/analytics",uP="@firebase/app-check-compat",hP="@firebase/app-check",dP="@firebase/auth",fP="@firebase/auth-compat",pP="@firebase/database",mP="@firebase/data-connect",gP="@firebase/database-compat",_P="@firebase/functions",yP="@firebase/functions-compat",vP="@firebase/installations",wP="@firebase/installations-compat",EP="@firebase/messaging",IP="@firebase/messaging-compat",TP="@firebase/performance",bP="@firebase/performance-compat",CP="@firebase/remote-config",AP="@firebase/remote-config-compat",SP="@firebase/storage",RP="@firebase/storage-compat",PP="@firebase/firestore",DP="@firebase/vertexai-preview",NP="@firebase/firestore-compat",kP="firebase",OP="10.14.1";var nn="[DEFAULT]",xP={[Bc]:"fire-core",[aP]:"fire-core-compat",[lP]:"fire-analytics",[cP]:"fire-analytics-compat",[hP]:"fire-app-check",[uP]:"fire-app-check-compat",[dP]:"fire-auth",[fP]:"fire-auth-compat",[pP]:"fire-rtdb",[mP]:"fire-data-connect",[gP]:"fire-rtdb-compat",[_P]:"fire-fn",[yP]:"fire-fn-compat",[vP]:"fire-iid",[wP]:"fire-iid-compat",[EP]:"fire-fcm",[IP]:"fire-fcm-compat",[TP]:"fire-perf",[bP]:"fire-perf-compat",[CP]:"fire-rc",[AP]:"fire-rc-compat",[SP]:"fire-gcs",[RP]:"fire-gcs-compat",[PP]:"fire-fst",[NP]:"fire-fst-compat",[DP]:"fire-vertex","fire-js":"fire-js",[kP]:"fire-js-all"};var Wn=new Map,_i=new Map,yi=new Map;function vi(n,e){try{n.container.addComponent(e)}catch(t){En.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Qd(n,e){n.container.addOrOverwriteComponent(e)}function He(n){let e=n.name;if(yi.has(e))return En.debug(`There were multiple attempts to register component ${e}.`),!1;yi.set(e,n);for(let t of Wn.values())vi(t,n);for(let t of _i.values())vi(t,n);return!0}function gt(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function jw(n,e,t=nn){gt(n,e).clearInstance(t)}function $w(n){return n.options!==void 0}function rn(n){return n.settings!==void 0}function MP(){yi.clear()}var VP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Nt=new Pt("app","Firebase",VP);var jc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ke("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Nt.create("app-deleted",{appName:this._name})}};var Wd=class extends jc{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let c=e;super(c.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,J(Bc,Gd,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Co(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Nt.create("server-app-deleted")}};var ct=OP;function wi(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:nn,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Nt.create("bad-app-name",{appName:String(i)});if(t||(t=Od()),!t)throw Nt.create("no-options");let s=Wn.get(i);if(s){if(vr(t,s.options)&&vr(r,s.config))return s;throw Nt.create("duplicate-app",{appName:i})}let o=new gi(i);for(let l of yi.values())o.addComponent(l);let c=new jc(t,r,o);return Wn.set(i,c),c}function qw(n,e){if(_w()&&!Md())throw Nt.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;$w(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=u=>[...u].reduce((f,p)=>Math.imul(31,f)+p.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Nt.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=_i.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let c=new gi(s);for(let u of yi.values())c.addComponent(u);let l=new Wd(t,e,s,c);return _i.set(s,l),l}function _t(n=nn){let e=Wn.get(n);if(!e&&n===nn&&Od())return wi();if(!e)throw Nt.create("no-app",{appName:n});return e}function bo(){return Array.from(Wn.values())}function Co(n){return w(this,null,function*(){let e=!1,t=n.name;Wn.has(t)?(e=!0,Wn.delete(t)):_i.has(t)&&n.decRefCount()<=0&&(_i.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function J(n,e,t){var r;let i=(r=xP[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),En.warn(c.join(" "));return}He(new ke(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function $c(n,e){if(n!==null&&typeof n!="function")throw Nt.create("invalid-log-argument");Dw(n,e)}function qc(n){Pw(n)}var LP="firebase-heartbeat-database",FP=1,To="firebase-heartbeat-store",qd=null;function zw(){return qd||(qd=Lw(LP,FP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(To)}catch(t){console.warn(t)}}}}).catch(n=>{throw Nt.create("idb-open",{originalErrorMessage:n.message})})),qd}function UP(n){return w(this,null,function*(){try{let t=(yield zw()).transaction(To),r=yield t.objectStore(To).get(Gw(n));return yield t.done,r}catch(e){if(e instanceof We)En.warn(e.message);else{let t=Nt.create("idb-get",{originalErrorMessage:e?.message});En.warn(t.message)}}})}function Fw(n,e){return w(this,null,function*(){try{let r=(yield zw()).transaction(To,"readwrite");yield r.objectStore(To).put(e,Gw(n)),yield r.done}catch(t){if(t instanceof We)En.warn(t.message);else{let r=Nt.create("idb-set",{originalErrorMessage:t?.message});En.warn(r.message)}}})}function Gw(n){return`${n.name}!${n.options.appId}`}var BP=1024,jP=30*24*60*60*1e3,Hd=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Kd(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return w(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Uw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let c=new Date(o.date).valueOf();return Date.now()-c<=jP}),this._storage.overwrite(this._heartbeatsCache))}catch(r){En.warn(r)}})}getHeartbeatsHeader(){return w(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Uw(),{heartbeatsToSend:r,unsentEntries:i}=$P(this._heartbeatsCache.heartbeats),s=_o(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return En.warn(t),""}})}};function Uw(){return new Date().toISOString().substring(0,10)}function $P(n,e=BP){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Bw(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Bw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Kd=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return w(this,null,function*(){return Vd()?Iw().then(()=>!0).catch(()=>!1):!1})}read(){return w(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield UP(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return w(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Fw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return w(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Fw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Bw(n){return _o(JSON.stringify({version:2,heartbeats:n})).length}function qP(n){He(new ke("platform-logger",e=>new zd(e),"PRIVATE")),He(new ke("heartbeat",e=>new Hd(e),"PRIVATE")),J(Bc,Gd,n),J(Bc,Gd,"esm2017"),J("fire-js","")}qP("");var zP="firebase",GP="10.14.1";J(zP,GP,"app");var yt=new Ls("ANGULARFIRE2_VERSION");function sn(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var qt=(n,e)=>{let t=e?[e]:bo(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},kt=class{constructor(){return qt(WP)}},WP="app-check";function Ei(){}var zc=class{zone;delegate;constructor(e,t=Ey){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},Jd=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ei,{},Ei,Ei)),t.pipe(De({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ot=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new zc(Zone.current)),this.insideAngular=t.run(()=>new zc(Zone.current,wy)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(te(ve))};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Gc(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function HP(n){return Gc().ngZone.runOutsideAngular(()=>n())}function Ir(n){return Gc().ngZone.run(()=>n())}function KP(n){return QP(Gc())(n)}function QP(n){return function(t){return t=t.lift(new Jd(n.ngZone)),t.pipe(eh(n.outsideAngular),Zu(n.insideAngular))}}var YP=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ir(()=>n.apply(void 0,r))},ut=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Ir(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ei,{},Ei,Ei))),r[s]=YP(r[s],t));let i=HP(()=>n.apply(this,r));if(!e)if(i instanceof Ln){let s=Gc();return i.pipe(eh(s.outsideAngular),Zu(s.insideAngular))}else return Ir(()=>i);return i instanceof Ln?i.pipe(KP):i instanceof Promise?Ir(()=>new Promise((s,o)=>i.then(c=>Ir(()=>s(c)),c=>Ir(()=>o(c))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Ir(()=>i)};var lt=class{constructor(e){return e}},vt=class{constructor(){return bo()}};function JP(n){return n&&n.length===1?n[0]:new lt(_t())}var Xd=new W("angularfire2._apps"),XP={provide:lt,useFactory:JP,deps:[[new de,Xd]]},ZP={provide:vt,deps:[[new de,Xd]]};function eD(n){return(e,t)=>{let r=t.get(jt);J("angularfire",yt.full,"core"),J("angularfire",yt.full,"app"),J("angular",wh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new lt(i)}}function Ww(n,...e){return Ne([XP,ZP,{provide:Xd,useFactory:eD(n),multi:!0,deps:[ve,at,Ot,...e]}])}var Hw=ut(wi,!0);function cE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var lE=cE,uE=new Pt("auth","Firebase",cE());var Jc=new Dt("@firebase/auth");function tD(n,...e){Jc.logLevel<=X.WARN&&Jc.warn(`Auth (${ct}): ${n}`,...e)}function Hc(n,...e){Jc.logLevel<=X.ERROR&&Jc.error(`Auth (${ct}): ${n}`,...e)}function Kn(n,...e){throw vf(n,...e)}function br(n,...e){return vf(n,...e)}function hE(n,e,t){let r=Object.assign(Object.assign({},lE()),{[e]:t});return new Pt("auth","Firebase",r).create(e,{appName:n.name})}function Tr(n){return hE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function vf(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return uE.create(n,...e)}function G(n,e,...t){if(!n)throw vf(e,...t)}function In(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Hc(e),new Error(e)}function Qn(n,e){n||In(e)}function nf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function nD(){return Kw()==="http:"||Kw()==="https:"}function Kw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function rD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nD()||vw()||"connection"in navigator)?navigator.onLine:!0}function iD(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Cr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qn(t>e,"Short delay should be less than long delay!"),this.isMobile=vo()||Vc()}get(){return rD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function wf(n,e){Qn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Xc=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;In("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;In("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;In("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var sD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var oD=new Cr(3e4,6e4);function Ef(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Ti(s,o,c,l){return w(this,arguments,function*(n,e,t,r,i={}){return dE(n,i,()=>w(this,null,function*(){let u={},f={};r&&(e==="GET"?f=r:u={body:JSON.stringify(r)});let p=wr(Object.assign({key:n.config.apiKey},f)).slice(1),g=yield n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);let T=Object.assign({method:e,headers:g},u);return yw()||(T.referrerPolicy="no-referrer"),Xc.fetch()(fE(n,n.config.apiHost,t,p),T)}))})}function dE(n,e,t){return w(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},sD),e);try{let i=new rf(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Wc(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[l,u]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Wc(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Wc(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Wc(n,"user-disabled",o);let f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw hE(n,f,u);Kn(n,f)}}catch(i){if(i instanceof We)throw i;Kn(n,"network-request-failed",{message:String(i)})}})}function aD(s,o,c,l){return w(this,arguments,function*(n,e,t,r,i={}){let u=yield Ti(n,e,t,r,i);return"mfaPendingCredential"in u&&Kn(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function fE(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?wf(n.config,i):`${n.config.apiScheme}://${i}`}var rf=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(br(this.auth,"network-request-failed")),oD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Wc(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=br(n,e,r);return i.customData._tokenResponse=t,i}function cD(n,e){return w(this,null,function*(){return Ti(n,"POST","/v1/accounts:delete",e)})}function pE(n,e){return w(this,null,function*(){return Ti(n,"POST","/v1/accounts:lookup",e)})}function Ao(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function If(n,e=!1){return w(this,null,function*(){let t=Be(n),r=yield t.getIdToken(e),i=Tf(r);G(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Ao(Zd(i.auth_time)),issuedAtTime:Ao(Zd(i.iat)),expirationTime:Ao(Zd(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Zd(n){return Number(n)*1e3}function Tf(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Hc("JWT malformed, contained fewer than 3 sections"),null;try{let i=yo(t);return i?JSON.parse(i):(Hc("Failed to decode base64 JWT payload"),null)}catch(i){return Hc("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qw(n){let e=Tf(n);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ro(n,e,t=!1){return w(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof We&&lD(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function lD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var sf=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>w(this,null,function*(){yield this.iteration()}),t)}iteration(){return w(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Po=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ao(this.lastLoginAt),this.creationTime=Ao(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Zc(n){return w(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ro(n,pE(t,{idToken:r}));G(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?mE(s.providerUserInfo):[],c=uD(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!c?.length,f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Po(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,p)})}function bf(n){return w(this,null,function*(){let e=Be(n);yield Zc(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function uD(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function mE(n){return n.map(e=>{var{providerId:t}=e,r=Xu(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function hD(n,e){return w(this,null,function*(){let t=yield dE(n,{},()=>w(this,null,function*(){let r=wr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=fE(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Xc.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function dD(n,e){return w(this,null,function*(){return Ti(n,"POST","/v2/accounts:revokeToken",Ef(n,e))})}var So=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){G(e.length!==0,"internal-error");let t=Qw(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return w(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return w(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield hD(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(G(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(G(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(G(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return In("not implemented")}};function Hn(n,e){G(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ii=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Xu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Po(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return w(this,null,function*(){let t=yield Ro(this,this.stsTokenManager.getToken(this.auth,e));return G(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return If(this,e)}reload(){return bf(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return w(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Zc(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return w(this,null,function*(){if(rn(this.auth.app))return Promise.reject(Tr(this.auth));let e=yield this.getIdToken();return yield Ro(this,cD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,c,l,u,f;let p=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,T=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,D=(c=t.tenantId)!==null&&c!==void 0?c:void 0,P=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,M=(u=t.createdAt)!==null&&u!==void 0?u:void 0,$=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:B,emailVerified:F,isAnonymous:pe,providerData:K,stsTokenManager:I}=t;G(B&&I,e,"internal-error");let _=So.fromJSON(this.name,I);G(typeof B=="string",e,"internal-error"),Hn(p,e.name),Hn(g,e.name),G(typeof F=="boolean",e,"internal-error"),G(typeof pe=="boolean",e,"internal-error"),Hn(T,e.name),Hn(S,e.name),Hn(D,e.name),Hn(P,e.name),Hn(M,e.name),Hn($,e.name);let v=new n({uid:B,auth:e,email:g,emailVerified:F,displayName:p,isAnonymous:pe,photoURL:S,phoneNumber:T,tenantId:D,stsTokenManager:_,createdAt:M,lastLoginAt:$});return K&&Array.isArray(K)&&(v.providerData=K.map(E=>Object.assign({},E))),P&&(v._redirectEventId=P),v}static _fromIdTokenResponse(e,t,r=!1){return w(this,null,function*(){let i=new So;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Zc(s),s})}static _fromGetAccountInfoResponse(e,t,r){return w(this,null,function*(){let i=t.users[0];G(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?mE(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new So;c.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Po(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,u),l})}};var Yw=new Map;function Tn(n){Qn(n instanceof Function,"Expected a class definition");let e=Yw.get(n);return e?(Qn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yw.set(n,e),e)}var fD=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return w(this,null,function*(){return!0})}_set(t,r){return w(this,null,function*(){this.storage[t]=r})}_get(t){return w(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return w(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),of=fD;function Kc(n,e,t){return`firebase:${n}:${e}:${t}`}var el=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Kc(this.userKey,i.apiKey,s),this.fullPersistenceKey=Kc("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return w(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Ii._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return w(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return w(this,null,function*(){if(!t.length)return new n(Tn(of),e,r);let i=(yield Promise.all(t.map(u=>w(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||Tn(of),o=Kc(r,e.config.apiKey,e.name),c=null;for(let u of t)try{let f=yield u._get(o);if(f){let p=Ii._fromJSON(e,f);u!==s&&(c=p),s=u;break}}catch{}let l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],c&&(yield s._set(o,c.toJSON())),yield Promise.all(t.map(u=>w(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,r))})}};function Jw(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(EE(e))return"Blackberry";if(IE(e))return"Webos";if(_E(e))return"Safari";if((e.includes("chrome/")||yE(e))&&!e.includes("edge/"))return"Chrome";if(wE(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function gE(n=Fe()){return/firefox\//i.test(n)}function _E(n=Fe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yE(n=Fe()){return/crios\//i.test(n)}function vE(n=Fe()){return/iemobile/i.test(n)}function wE(n=Fe()){return/android/i.test(n)}function EE(n=Fe()){return/blackberry/i.test(n)}function IE(n=Fe()){return/webos/i.test(n)}function Cf(n=Fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pD(n=Fe()){var e;return Cf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function mD(){return ww()&&document.documentMode===10}function TE(n=Fe()){return Cf(n)||wE(n)||IE(n)||EE(n)||/windows phone/i.test(n)||vE(n)}function bE(n,e=[]){let t;switch(n){case"Browser":t=Jw(Fe());break;case"Worker":t=`${Jw(Fe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ct}/${r}`}var af=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let l=e(s);o(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return w(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function gD(t){return w(this,arguments,function*(n,e={}){return Ti(n,"GET","/v2/passwordPolicy",Ef(n,e))})}var _D=6,cf=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:_D,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var lf=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tl(this),this.idTokenSubscription=new tl(this),this.beforeStateQueue=new af(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Tn(t)),this._initializationPromise=this.queue(()=>w(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield el.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return w(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return w(this,null,function*(){try{let t=yield pE(this,{idToken:e}),r=yield Ii._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return w(this,null,function*(){var t;if(rn(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!o||o===c)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return w(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return w(this,null,function*(){try{yield Zc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=iD()}_delete(){return w(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return w(this,null,function*(){if(rn(this.app))return Promise.reject(Tr(this));let t=e?Be(e):null;return t&&G(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return w(this,null,function*(){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>w(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return w(this,null,function*(){return rn(this.app)?Promise.reject(Tr(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return rn(this.app)?Promise.reject(Tr(this)):this.queue(()=>w(this,null,function*(){yield this.assertedPersistence.setPersistence(Tn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return w(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return w(this,null,function*(){let e=yield gD(this),t=new cf(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return w(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield dD(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return w(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return w(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Tn(e)||this._popupRedirectResolver;G(t,this,"argument-error"),this.redirectPersistenceManager=yield el.create(this,[Tn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return w(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>w(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return w(this,null,function*(){if(e===this.currentUser)return this.queue(()=>w(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{o=!0,l()}}else{let l=e.addObserver(t);return()=>{o=!0,l()}}}directlySetCurrentUser(e){return w(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return w(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return w(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&tD(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Af(n){return Be(n)}var tl=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Lc(t=>this.observer=t)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Sf={loadJS(){return w(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yD(n){Sf=n}function vD(n){return Sf.loadJS(n)}function wD(){return Sf.gapiScript}function CE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Rf(n,e){let t=gt(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(vr(s,e??{}))return i;Kn(i,"already-initialized")}return t.initialize({options:e})}function ED(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Tn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Pf(n,e,t){let r=Af(n);G(r._canInitEmulator,r,"emulator-config-failed"),G(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=AE(e),{host:o,port:c}=ID(e),l=c===null?"":`:${c}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||TD()}function AE(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ID(n){let e=AE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Xw(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Xw(o)}}}function Xw(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function TD(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var nl=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return In("not implemented")}_getIdTokenResponse(e){return In("not implemented")}_linkToIdToken(e,t){return In("not implemented")}_getReauthenticationResolver(e){return In("not implemented")}};function ef(n,e){return w(this,null,function*(){return aD(n,"POST","/v1/accounts:signInWithIdp",Ef(n,e))})}var rl=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var uf=class extends rl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Do=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return w(this,null,function*(){let s=yield Ii._fromIdTokenResponse(e,r,i),o=Zw(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return w(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Zw(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Zw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var hf=class n extends We{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function SE(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?hf._fromErrorAndOperation(n,s,e,r):s})}function bD(n,e,t=!1){return w(this,null,function*(){let r=yield Ro(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Do._forOperation(n,"link",r)})}function CD(n,e,t=!1){return w(this,null,function*(){let{auth:r}=n;if(rn(r.app))return Promise.reject(Tr(r));let i="reauthenticate";try{let s=yield Ro(n,SE(r,i,e,n),t);G(s.idToken,r,"internal-error");let o=Tf(s.idToken);G(o,r,"internal-error");let{sub:c}=o;return G(n.uid===c,r,"user-mismatch"),Do._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Kn(r,"user-mismatch"),s}})}function AD(n,e,t=!1){return w(this,null,function*(){if(rn(n.app))return Promise.reject(Tr(n));let r="signIn",i=yield SE(n,r,e),s=yield Do._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Df(n,e,t,r){return Be(n).onIdTokenChanged(e,t,r)}function Nf(n,e,t){return Be(n).beforeAuthStateChanged(e,t)}var il="__sak";var sl=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(il,"1"),this.storage.removeItem(il),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var SD=1e3,RD=10,PD=(()=>{class n extends sl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TE(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,l,u)=>{this.notifyListeners(c,u)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);mD()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,RD):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},SD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return w(this,null,function*(){yield Vn(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return w(this,null,function*(){let r=yield Vn(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return w(this,null,function*(){yield Vn(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),RE=PD;var DD=(()=>{class n extends sl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),kf=DD;function ND(n){return Promise.all(n.map(e=>w(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var kD=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return w(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(c).map(f=>w(this,null,function*(){return f(r.origin,o)})),u=yield ND(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function PE(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var df=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return w(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,l)=>{let u=PE("",20);i.port1.start();let f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function on(){return window}function OD(n){on().location.href=n}function DE(){return typeof on().WorkerGlobalScope<"u"&&typeof on().importScripts=="function"}function xD(){return w(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function MD(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function VD(){return DE()?self:null}var NE="firebaseLocalStorageDb",LD=1,ol="firebaseLocalStorage",kE="fbase_key",Ar=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function cl(n,e){return n.transaction([ol],e?"readwrite":"readonly").objectStore(ol)}function FD(){let n=indexedDB.deleteDatabase(NE);return new Ar(n).toPromise()}function ff(){let n=indexedDB.open(NE,LD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(ol,{keyPath:kE})}catch(i){t(i)}}),n.addEventListener("success",()=>w(this,null,function*(){let r=n.result;r.objectStoreNames.contains(ol)?e(r):(r.close(),yield FD(),e(yield ff()))}))})}function eE(n,e,t){return w(this,null,function*(){let r=cl(n,!0).put({[kE]:e,value:t});return new Ar(r).toPromise()})}function UD(n,e){return w(this,null,function*(){let t=cl(n,!1).get(e),r=yield new Ar(t).toPromise();return r===void 0?null:r.value})}function tE(n,e){let t=cl(n,!0).delete(e);return new Ar(t).toPromise()}var BD=800,jD=3,$D=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return w(this,null,function*(){return this.db?this.db:(this.db=yield ff(),this.db)})}_withRetries(t){return w(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>jD)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return w(this,null,function*(){return DE()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return w(this,null,function*(){this.receiver=kD._getInstance(VD()),this.receiver._subscribe("keyChanged",(t,r)=>w(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>w(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return w(this,null,function*(){var t,r;if(this.activeServiceWorker=yield xD(),!this.activeServiceWorker)return;this.sender=new df(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return w(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||MD()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return w(this,null,function*(){try{if(!indexedDB)return!1;let t=yield ff();return yield eE(t,il,"1"),yield tE(t,il),!0}catch{}return!1})}_withPendingWrite(t){return w(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return w(this,null,function*(){return this._withPendingWrite(()=>w(this,null,function*(){return yield this._withRetries(i=>eE(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return w(this,null,function*(){let r=yield this._withRetries(i=>UD(i,t));return this.localCache[t]=r,r})}_remove(t){return w(this,null,function*(){return this._withPendingWrite(()=>w(this,null,function*(){return yield this._withRetries(r=>tE(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return w(this,null,function*(){let t=yield this._withRetries(s=>{let o=cl(s,!1).getAll();return new Ar(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>w(this,null,function*(){return this._poll()}),BD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),OE=$D;var kU=CE("rcb"),OU=new Cr(3e4,6e4);function qD(n,e){return e?Tn(e):(G(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var No=class extends nl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ef(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ef(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ef(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function zD(n){return AD(n.auth,new No(n),n.bypassAuthState)}function GD(n){let{auth:e,user:t}=n;return G(t,e,"internal-error"),CD(t,new No(n),n.bypassAuthState)}function WD(n){return w(this,null,function*(){let{auth:e,user:t}=n;return G(t,e,"internal-error"),bD(t,new No(n),n.bypassAuthState)})}var pf=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>w(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return w(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zD;case"linkViaPopup":case"linkViaRedirect":return WD;case"reauthViaPopup":case"reauthViaRedirect":return GD;default:Kn(this.auth,"internal-error")}}resolve(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var xU=new Cr(2e3,1e4);var HD="pendingRedirect",Qc=new Map,mf=class n extends pf{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return w(this,null,function*(){let e=Qc.get(this.auth._key());if(!e){try{let r=(yield KD(this.resolver,this.auth))?yield Vn(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Qc.set(this.auth._key(),e)}return this.bypassAuthState||Qc.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return w(this,null,function*(){if(e.type==="signInViaRedirect")return Vn(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Vn(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return w(this,null,function*(){})}cleanUp(){}};function KD(n,e){return w(this,null,function*(){let t=JD(e),r=YD(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function QD(n,e){Qc.set(n._key(),e)}function YD(n){return Tn(n._redirectPersistence)}function JD(n){return Kc(HD,n.config.apiKey,n.name)}function XD(n,e,t=!1){return w(this,null,function*(){if(rn(n.app))return Promise.reject(Tr(n));let r=Af(n),i=qD(r,e),o=yield new mf(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var ZD=10*60*1e3,gf=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eN(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!xE(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(br(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZD&&this.cachedEventUids.clear(),this.cachedEventUids.has(nE(e))}saveEventToCache(e){this.cachedEventUids.add(nE(e)),this.lastProcessedEventTime=Date.now()}};function nE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xE({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function eN(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xE(n);default:return!1}}function tN(t){return w(this,arguments,function*(n,e={}){return Ti(n,"GET","/v1/projects",e)})}var nN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rN=/^https?/;function iN(n){return w(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield tN(n);for(let t of e)try{if(sN(t))return}catch{}Kn(n,"unauthorized-domain")})}function sN(n){let e=nf(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!rN.test(t))return!1;if(nN.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var oN=new Cr(3e4,6e4);function rE(){let n=on().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function aN(n){return new Promise((e,t)=>{var r,i,s;function o(){rE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rE(),t(br(n,"network-request-failed"))},timeout:oN.get()})}if(!((i=(r=on().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=on().gapi)===null||s===void 0)&&s.load)o();else{let c=CE("iframefcb");return on()[c]=()=>{gapi.load?o():t(br(n,"network-request-failed"))},vD(`${wD()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw Yc=null,e})}var Yc=null;function cN(n){return Yc=Yc||aN(n),Yc}var lN=new Cr(5e3,15e3),uN="__/auth/iframe",hN="emulator/auth/iframe",dN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pN(n){let e=n.config;G(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?wf(e,hN):`https://${n.config.authDomain}/${uN}`,r={apiKey:e.apiKey,appName:n.name,v:ct},i=fN.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${wr(r).slice(1)}`}function mN(n){return w(this,null,function*(){let e=yield cN(n),t=on().gapi;return G(t,n,"internal-error"),e.open({where:document.body,url:pN(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dN,dontclear:!0},r=>new Promise((i,s)=>w(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=br(n,"network-request-failed"),c=on().setTimeout(()=>{s(o)},lN.get());function l(){on().clearTimeout(c),i(r)}r.ping(l).then(l,()=>{s(o)})})))})}var gN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_N=500,yN=600,vN="_blank",wN="http://localhost",al=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function EN(n,e,t,r=_N,i=yN){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",l=Object.assign(Object.assign({},gN),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Fe().toLowerCase();t&&(c=yE(u)?vN:t),gE(u)&&(e=e||wN,l.scrollbars="yes");let f=Object.entries(l).reduce((g,[T,S])=>`${g}${T}=${S},`,"");if(pD(u)&&c!=="_self")return IN(e||"",c),new al(null);let p=window.open(e||"",c,f);G(p,n,"popup-blocked");try{p.focus()}catch{}return new al(p)}function IN(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var TN="__/auth/handler",bN="emulator/auth/handler",CN=encodeURIComponent("fac");function iE(n,e,t,r,i,s){return w(this,null,function*(){G(n.config.authDomain,n,"auth-domain-config-required"),G(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ct,eventId:i};if(e instanceof rl){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",wo(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,p]of Object.entries(s||{}))o[f]=p}if(e instanceof uf){let f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let l=yield n._getAppCheckToken(),u=l?`#${CN}=${encodeURIComponent(l)}`:"";return`${AN(n)}?${wr(c).slice(1)}${u}`})}function AN({config:n}){return n.emulator?wf(n,bN):`https://${n.authDomain}/${TN}`}var tf="webStorageSupport",_f=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kf,this._completeRedirectFn=XD,this._overrideRedirectResult=QD}_openPopup(e,t,r,i){return w(this,null,function*(){var s;Qn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield iE(e,t,r,nf(),i);return EN(e,o,PE())})}_openRedirect(e,t,r,i){return w(this,null,function*(){yield this._originValidation(e);let s=yield iE(e,t,r,nf(),i);return OD(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Qn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return w(this,null,function*(){let t=yield mN(e),r=new gf(e);return t.register("authEvent",i=>(G(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(tf,{type:tf},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[tf];o!==void 0&&t(!!o),Kn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iN(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return TE()||_E()||Cf()}},ME=_f;var sE="@firebase/auth",oE="1.7.9";var yf=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return w(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function SN(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RN(n){He(new ke("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;G(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bE(n)},u=new lf(r,i,s,l);return ED(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),He(new ke("auth-internal",e=>{let t=Af(e.getProvider("auth").getImmediate());return(r=>new yf(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),J(sE,oE,SN(n)),J(sE,oE,"esm2017")}var PN=5*60,DN=xd("authIdTokenMaxAge")||PN,aE=null,NN=n=>e=>w(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>DN)return;let i=t?.token;aE!==i&&(aE=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Of(n=_t()){let e=gt(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Rf(n,{popupRedirectResolver:ME,persistence:[OE,RE,kf]}),r=xd("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=NN(s.toString());Nf(t,o,()=>o(t.currentUser)),Df(t,c=>o(c))}}let i=kd("auth");return i&&Pf(t,`http://${i}`),t}function kN(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}yD({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=br("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",kN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RN("Browser");var VE="auth",ko=class{constructor(e){return e}},zt=class{constructor(){return qt(VE)}};var xf=new W("angularfire2.auth-instances");function Ak(n,e){let t=sn(VE,n,e);return t&&new ko(t)}function Sk(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ko(r)}}var Rk={provide:zt,deps:[[new de,xf]]},Pk={provide:ko,useFactory:Ak,deps:[[new de,xf],lt]};function LE(n,...e){return J("angularfire",yt.full,"auth"),Ne([Pk,Rk,{provide:xf,useFactory:Sk(n),multi:!0,deps:[ve,at,Ot,vt,[new de,kt],...e]}])}var FE=ut(Of,!0);var UE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},BE={};var Yn,Mf;(function(){var n;function e(I,_){function v(){}v.prototype=_.prototype,I.D=_.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(E,b,A){for(var y=Array(arguments.length-2),fn=2;fn<arguments.length;fn++)y[fn-2]=arguments[fn];return _.prototype[b].apply(E,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,v){v||(v=0);var E=Array(16);if(typeof _=="string")for(var b=0;16>b;++b)E[b]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(b=0;16>b;++b)E[b]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=I.g[0],v=I.g[1],b=I.g[2];var A=I.g[3],y=_+(A^v&(b^A))+E[0]+3614090360&4294967295;_=v+(y<<7&4294967295|y>>>25),y=A+(b^_&(v^b))+E[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=b+(v^A&(_^v))+E[2]+606105819&4294967295,b=A+(y<<17&4294967295|y>>>15),y=v+(_^b&(A^_))+E[3]+3250441966&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(A^v&(b^A))+E[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(b^_&(v^b))+E[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=b+(v^A&(_^v))+E[6]+2821735955&4294967295,b=A+(y<<17&4294967295|y>>>15),y=v+(_^b&(A^_))+E[7]+4249261313&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(A^v&(b^A))+E[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(b^_&(v^b))+E[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=b+(v^A&(_^v))+E[10]+4294925233&4294967295,b=A+(y<<17&4294967295|y>>>15),y=v+(_^b&(A^_))+E[11]+2304563134&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(A^v&(b^A))+E[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(b^_&(v^b))+E[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=b+(v^A&(_^v))+E[14]+2792965006&4294967295,b=A+(y<<17&4294967295|y>>>15),y=v+(_^b&(A^_))+E[15]+1236535329&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(b^A&(v^b))+E[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^b&(_^v))+E[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(A^_))+E[11]+643717713&4294967295,b=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(b^A))+E[0]+3921069994&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(b^A&(v^b))+E[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^b&(_^v))+E[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(A^_))+E[15]+3634488961&4294967295,b=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(b^A))+E[4]+3889429448&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(b^A&(v^b))+E[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^b&(_^v))+E[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(A^_))+E[3]+4107603335&4294967295,b=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(b^A))+E[8]+1163531501&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(b^A&(v^b))+E[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^b&(_^v))+E[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(A^_))+E[7]+1735328473&4294967295,b=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(b^A))+E[12]+2368359562&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(v^b^A)+E[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^b)+E[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=b+(A^_^v)+E[11]+1839030562&4294967295,b=A+(y<<16&4294967295|y>>>16),y=v+(b^A^_)+E[14]+4259657740&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(v^b^A)+E[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^b)+E[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=b+(A^_^v)+E[7]+4139469664&4294967295,b=A+(y<<16&4294967295|y>>>16),y=v+(b^A^_)+E[10]+3200236656&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(v^b^A)+E[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^b)+E[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=b+(A^_^v)+E[3]+3572445317&4294967295,b=A+(y<<16&4294967295|y>>>16),y=v+(b^A^_)+E[6]+76029189&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(v^b^A)+E[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^b)+E[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=b+(A^_^v)+E[15]+530742520&4294967295,b=A+(y<<16&4294967295|y>>>16),y=v+(b^A^_)+E[2]+3299628645&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(b^(v|~A))+E[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~b))+E[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=b+(_^(A|~v))+E[14]+2878612391&4294967295,b=A+(y<<15&4294967295|y>>>17),y=v+(A^(b|~_))+E[5]+4237533241&4294967295,v=b+(y<<21&4294967295|y>>>11),y=_+(b^(v|~A))+E[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~b))+E[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=b+(_^(A|~v))+E[10]+4293915773&4294967295,b=A+(y<<15&4294967295|y>>>17),y=v+(A^(b|~_))+E[1]+2240044497&4294967295,v=b+(y<<21&4294967295|y>>>11),y=_+(b^(v|~A))+E[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~b))+E[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=b+(_^(A|~v))+E[6]+2734768916&4294967295,b=A+(y<<15&4294967295|y>>>17),y=v+(A^(b|~_))+E[13]+1309151649&4294967295,v=b+(y<<21&4294967295|y>>>11),y=_+(b^(v|~A))+E[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~b))+E[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=b+(_^(A|~v))+E[2]+718787259&4294967295,b=A+(y<<15&4294967295|y>>>17),y=v+(A^(b|~_))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(b+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+b&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var v=_-this.blockSize,E=this.B,b=this.h,A=0;A<_;){if(b==0)for(;A<=v;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(E[b++]=I.charCodeAt(A++),b==this.blockSize){i(this,E),b=0;break}}else for(;A<_;)if(E[b++]=I[A++],b==this.blockSize){i(this,E),b=0;break}}this.h=b,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var v=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=v&255,v/=256;for(this.u(I),I=Array(16),_=v=0;4>_;++_)for(var E=0;32>E;E+=8)I[v++]=this.g[_]>>>E&255;return I};function s(I,_){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=_(I)}function o(I,_){this.h=_;for(var v=[],E=!0,b=I.length-1;0<=b;b--){var A=I[b]|0;E&&A==_||(v[b]=A,E=!1)}this.g=v}var c={};function l(I){return-128<=I&&128>I?s(I,function(_){return new o([_|0],0>_?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return P(u(-I));for(var _=[],v=1,E=0;I>=v;E++)_[E]=I/v|0,v*=4294967296;return new o(_,0)}function f(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return P(f(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=u(Math.pow(_,8)),E=p,b=0;b<I.length;b+=8){var A=Math.min(8,I.length-b),y=parseInt(I.substring(b,b+A),_);8>A?(A=u(Math.pow(_,A)),E=E.j(A).add(u(y))):(E=E.j(v),E=E.add(u(y)))}return E}var p=l(0),g=l(1),T=l(16777216);n=o.prototype,n.m=function(){if(D(this))return-P(this).m();for(var I=0,_=1,v=0;v<this.g.length;v++){var E=this.i(v);I+=(0<=E?E:4294967296+E)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S(this))return"0";if(D(this))return"-"+P(this).toString(I);for(var _=u(Math.pow(I,6)),v=this,E="";;){var b=F(v,_).g;v=M(v,b.j(_));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=b,S(v))return A+E;for(;6>A.length;)A="0"+A;E=A+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function S(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function D(I){return I.h==-1}n.l=function(I){return I=M(this,I),D(I)?-1:S(I)?0:1};function P(I){for(var _=I.g.length,v=[],E=0;E<_;E++)v[E]=~I.g[E];return new o(v,~I.h).add(g)}n.abs=function(){return D(this)?P(this):this},n.add=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],E=0,b=0;b<=_;b++){var A=E+(this.i(b)&65535)+(I.i(b)&65535),y=(A>>>16)+(this.i(b)>>>16)+(I.i(b)>>>16);E=y>>>16,A&=65535,y&=65535,v[b]=y<<16|A}return new o(v,v[v.length-1]&-2147483648?-1:0)};function M(I,_){return I.add(P(_))}n.j=function(I){if(S(this)||S(I))return p;if(D(this))return D(I)?P(this).j(P(I)):P(P(this).j(I));if(D(I))return P(this.j(P(I)));if(0>this.l(T)&&0>I.l(T))return u(this.m()*I.m());for(var _=this.g.length+I.g.length,v=[],E=0;E<2*_;E++)v[E]=0;for(E=0;E<this.g.length;E++)for(var b=0;b<I.g.length;b++){var A=this.i(E)>>>16,y=this.i(E)&65535,fn=I.i(b)>>>16,ds=I.i(b)&65535;v[2*E+2*b]+=y*ds,$(v,2*E+2*b),v[2*E+2*b+1]+=A*ds,$(v,2*E+2*b+1),v[2*E+2*b+1]+=y*fn,$(v,2*E+2*b+1),v[2*E+2*b+2]+=A*fn,$(v,2*E+2*b+2)}for(E=0;E<_;E++)v[E]=v[2*E+1]<<16|v[2*E];for(E=_;E<2*_;E++)v[E]=0;return new o(v,0)};function $(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function B(I,_){this.g=I,this.h=_}function F(I,_){if(S(_))throw Error("division by zero");if(S(I))return new B(p,p);if(D(I))return _=F(P(I),_),new B(P(_.g),P(_.h));if(D(_))return _=F(I,P(_)),new B(P(_.g),_.h);if(30<I.g.length){if(D(I)||D(_))throw Error("slowDivide_ only works with positive integers.");for(var v=g,E=_;0>=E.l(I);)v=pe(v),E=pe(E);var b=K(v,1),A=K(E,1);for(E=K(E,2),v=K(v,2);!S(E);){var y=A.add(E);0>=y.l(I)&&(b=b.add(v),A=y),E=K(E,1),v=K(v,1)}return _=M(I,b.j(_)),new B(b,_)}for(b=p;0<=I.l(_);){for(v=Math.max(1,Math.floor(I.m()/_.m())),E=Math.ceil(Math.log(v)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),A=u(v),y=A.j(_);D(y)||0<y.l(I);)v-=E,A=u(v),y=A.j(_);S(A)&&(A=g),b=b.add(A),I=M(I,y)}return new B(b,I)}n.A=function(I){return F(this,I).h},n.and=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],E=0;E<_;E++)v[E]=this.i(E)&I.i(E);return new o(v,this.h&I.h)},n.or=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],E=0;E<_;E++)v[E]=this.i(E)|I.i(E);return new o(v,this.h|I.h)},n.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),v=[],E=0;E<_;E++)v[E]=this.i(E)^I.i(E);return new o(v,this.h^I.h)};function pe(I){for(var _=I.g.length+1,v=[],E=0;E<_;E++)v[E]=I.i(E)<<1|I.i(E-1)>>>31;return new o(v,I.h)}function K(I,_){var v=_>>5;_%=32;for(var E=I.g.length-v,b=[],A=0;A<E;A++)b[A]=0<_?I.i(A+v)>>>_|I.i(A+v+1)<<32-_:I.i(A+v);return new o(b,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Mf=BE.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,Yn=BE.Integer=o}).apply(typeof UE<"u"?UE:typeof self<"u"?self:typeof window<"u"?window:{});var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bn={};var Vf,Dk,bi,Lf,Oo,ul,Ff,Uf,Bf;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ll=="object"&&ll];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,h){if(h)e:{var d=r;a=a.split(".");for(var m=0;m<a.length-1;m++){var C=a[m];if(!(C in d))break e;d=d[C]}a=a[a.length-1],m=d[a],h=h(m),h!=m&&h!=null&&e(d,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var d=0,m=!1,C={next:function(){if(!m&&d<a.length){var R=d++;return{value:h(R,a[R]),done:!1}}return m=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(a){return a||function(){return s(this,function(h,d){return d})}});var o=o||{},c=this||self;function l(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,m),a.apply(h,C)}}return function(){return a.apply(h,arguments)}}function g(a,h,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function T(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function S(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,C,R){for(var k=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)k[ge-2]=arguments[ge];return h.prototype[C].apply(m,k)}}function D(a){let h=a.length;if(0<h){let d=Array(h);for(let m=0;m<h;m++)d[m]=a[m];return d}return[]}function P(a,h){for(let d=1;d<arguments.length;d++){let m=arguments[d];if(l(m)){let C=a.length||0,R=m.length||0;a.length=C+R;for(let k=0;k<R;k++)a[C+k]=m[k]}else a.push(m)}}class M{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function $(a){return/^[\s\xa0]*$/.test(a)}function B(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function F(a){return F[" "](a),a}F[" "]=function(){};var pe=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function K(a,h,d){for(let m in a)h.call(d,a[m],m,a)}function I(a,h){for(let d in a)h.call(void 0,a[d],d,a)}function _(a){let h={};for(let d in a)h[d]=a[d];return h}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,h){let d,m;for(let C=1;C<arguments.length;C++){m=arguments[C];for(d in m)a[d]=m[d];for(let R=0;R<v.length;R++)d=v[R],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function b(a){var h=1;a=a.split(":");let d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function A(a){c.setTimeout(()=>{throw a},0)}function y(){var a=bu;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class fn{constructor(){this.h=this.g=null}add(h,d){let m=ds.get();m.set(h,d),this.h?this.h.next=m:this.g=m,this.h=m}}var ds=new M(()=>new uA,a=>a.reset());class uA{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let fs,ps=!1,bu=new fn,__=()=>{let a=c.Promise.resolve(void 0);fs=()=>{a.then(hA)}};var hA=()=>{for(var a;a=y();){try{a.h.call(a.g)}catch(d){A(d)}var h=ds;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}ps=!1};function kn(){this.s=this.s,this.C=this.C}kn.prototype.s=!1,kn.prototype.ma=function(){this.s||(this.s=!0,this.N())},kn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ke(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Ke.prototype.h=function(){this.defaultPrevented=!0};var dA=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,h),c.removeEventListener("test",d,h)}catch{}return a}();function ms(a,h){if(Ke.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(pe){e:{try{F(h.nodeName);var C=!0;break e}catch{}C=!1}C||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:fA[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ms.aa.h.call(this)}}S(ms,Ke);var fA={2:"touch",3:"pen",4:"mouse"};ms.prototype.h=function(){ms.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var gs="closure_listenable_"+(1e6*Math.random()|0),pA=0;function mA(a,h,d,m,C){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!m,this.ha=C,this.key=++pA,this.da=this.fa=!1}function Ra(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Pa(a){this.src=a,this.g={},this.h=0}Pa.prototype.add=function(a,h,d,m,C){var R=a.toString();a=this.g[R],a||(a=this.g[R]=[],this.h++);var k=Au(a,h,m,C);return-1<k?(h=a[k],d||(h.fa=!1)):(h=new mA(h,this.src,R,!!m,C),h.fa=d,a.push(h)),h};function Cu(a,h){var d=h.type;if(d in a.g){var m=a.g[d],C=Array.prototype.indexOf.call(m,h,void 0),R;(R=0<=C)&&Array.prototype.splice.call(m,C,1),R&&(Ra(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Au(a,h,d,m){for(var C=0;C<a.length;++C){var R=a[C];if(!R.da&&R.listener==h&&R.capture==!!d&&R.ha==m)return C}return-1}var Su="closure_lm_"+(1e6*Math.random()|0),Ru={};function y_(a,h,d,m,C){if(m&&m.once)return w_(a,h,d,m,C);if(Array.isArray(h)){for(var R=0;R<h.length;R++)y_(a,h[R],d,m,C);return null}return d=ku(d),a&&a[gs]?a.K(h,d,u(m)?!!m.capture:!!m,C):v_(a,h,d,!1,m,C)}function v_(a,h,d,m,C,R){if(!h)throw Error("Invalid event type");var k=u(C)?!!C.capture:!!C,ge=Du(a);if(ge||(a[Su]=ge=new Pa(a)),d=ge.add(h,d,m,k,R),d.proxy)return d;if(m=gA(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)dA||(C=k),C===void 0&&(C=!1),a.addEventListener(h.toString(),m,C);else if(a.attachEvent)a.attachEvent(I_(h.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function gA(){function a(d){return h.call(a.src,a.listener,d)}let h=_A;return a}function w_(a,h,d,m,C){if(Array.isArray(h)){for(var R=0;R<h.length;R++)w_(a,h[R],d,m,C);return null}return d=ku(d),a&&a[gs]?a.L(h,d,u(m)?!!m.capture:!!m,C):v_(a,h,d,!0,m,C)}function E_(a,h,d,m,C){if(Array.isArray(h))for(var R=0;R<h.length;R++)E_(a,h[R],d,m,C);else m=u(m)?!!m.capture:!!m,d=ku(d),a&&a[gs]?(a=a.i,h=String(h).toString(),h in a.g&&(R=a.g[h],d=Au(R,d,m,C),-1<d&&(Ra(R[d]),Array.prototype.splice.call(R,d,1),R.length==0&&(delete a.g[h],a.h--)))):a&&(a=Du(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Au(h,d,m,C)),(d=-1<a?h[a]:null)&&Pu(d))}function Pu(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[gs])Cu(h.i,a);else{var d=a.type,m=a.proxy;h.removeEventListener?h.removeEventListener(d,m,a.capture):h.detachEvent?h.detachEvent(I_(d),m):h.addListener&&h.removeListener&&h.removeListener(m),(d=Du(h))?(Cu(d,a),d.h==0&&(d.src=null,h[Su]=null)):Ra(a)}}}function I_(a){return a in Ru?Ru[a]:Ru[a]="on"+a}function _A(a,h){if(a.da)a=!0;else{h=new ms(h,this);var d=a.listener,m=a.ha||a.src;a.fa&&Pu(a),a=d.call(m,h)}return a}function Du(a){return a=a[Su],a instanceof Pa?a:null}var Nu="__closure_events_fn_"+(1e9*Math.random()>>>0);function ku(a){return typeof a=="function"?a:(a[Nu]||(a[Nu]=function(h){return a.handleEvent(h)}),a[Nu])}function Qe(){kn.call(this),this.i=new Pa(this),this.M=this,this.F=null}S(Qe,kn),Qe.prototype[gs]=!0,Qe.prototype.removeEventListener=function(a,h,d,m){E_(this,a,h,d,m)};function st(a,h){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=h.type||h,typeof h=="string")h=new Ke(h,a);else if(h instanceof Ke)h.target=h.target||a;else{var C=h;h=new Ke(m,a),E(h,C)}if(C=!0,d)for(var R=d.length-1;0<=R;R--){var k=h.g=d[R];C=Da(k,m,!0,h)&&C}if(k=h.g=a,C=Da(k,m,!0,h)&&C,C=Da(k,m,!1,h)&&C,d)for(R=0;R<d.length;R++)k=h.g=d[R],C=Da(k,m,!1,h)&&C}Qe.prototype.N=function(){if(Qe.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],m=0;m<d.length;m++)Ra(d[m]);delete a.g[h],a.h--}}this.F=null},Qe.prototype.K=function(a,h,d,m){return this.i.add(String(a),h,!1,d,m)},Qe.prototype.L=function(a,h,d,m){return this.i.add(String(a),h,!0,d,m)};function Da(a,h,d,m){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var C=!0,R=0;R<h.length;++R){var k=h[R];if(k&&!k.da&&k.capture==d){var ge=k.listener,qe=k.ha||k.src;k.fa&&Cu(a.i,k),C=ge.call(qe,m)!==!1&&C}}return C&&!m.defaultPrevented}function T_(a,h,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(a,h||0)}function b_(a){a.g=T_(()=>{a.g=null,a.i&&(a.i=!1,b_(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class yA extends kn{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:b_(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _s(a){kn.call(this),this.h=a,this.g={}}S(_s,kn);var C_=[];function A_(a){K(a.g,function(h,d){this.g.hasOwnProperty(d)&&Pu(h)},a),a.g={}}_s.prototype.N=function(){_s.aa.N.call(this),A_(this)},_s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ou=c.JSON.stringify,vA=c.JSON.parse,wA=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function xu(){}xu.prototype.h=null;function S_(a){return a.h||(a.h=a.i())}function R_(){}var ys={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Mu(){Ke.call(this,"d")}S(Mu,Ke);function Vu(){Ke.call(this,"c")}S(Vu,Ke);var rr={},P_=null;function Na(){return P_=P_||new Qe}rr.La="serverreachability";function D_(a){Ke.call(this,rr.La,a)}S(D_,Ke);function vs(a){let h=Na();st(h,new D_(h))}rr.STAT_EVENT="statevent";function N_(a,h){Ke.call(this,rr.STAT_EVENT,a),this.stat=h}S(N_,Ke);function ot(a){let h=Na();st(h,new N_(h,a))}rr.Ma="timingevent";function k_(a,h){Ke.call(this,rr.Ma,a),this.size=h}S(k_,Ke);function ws(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},h)}function Es(){this.g=!0}Es.prototype.xa=function(){this.g=!1};function EA(a,h,d,m,C,R){a.info(function(){if(a.g)if(R)for(var k="",ge=R.split("&"),qe=0;qe<ge.length;qe++){var ce=ge[qe].split("=");if(1<ce.length){var Ye=ce[0];ce=ce[1];var Je=Ye.split("_");k=2<=Je.length&&Je[1]=="type"?k+(Ye+"="+ce+"&"):k+(Ye+"=redacted&")}}else k=null;else k=R;return"XMLHTTP REQ ("+m+") [attempt "+C+"]: "+h+`
`+d+`
`+k})}function IA(a,h,d,m,C,R,k){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+C+"]: "+h+`
`+d+`
`+R+" "+k})}function qr(a,h,d,m){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+bA(a,d)+(m?" "+m:"")})}function TA(a,h){a.info(function(){return"TIMEOUT: "+h})}Es.prototype.info=function(){};function bA(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var C=m[1];if(Array.isArray(C)&&!(1>C.length)){var R=C[0];if(R!="noop"&&R!="stop"&&R!="close")for(var k=1;k<C.length;k++)C[k]=""}}}}return Ou(d)}catch{return h}}var ka={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},O_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Lu;function Oa(){}S(Oa,xu),Oa.prototype.g=function(){return new XMLHttpRequest},Oa.prototype.i=function(){return{}},Lu=new Oa;function On(a,h,d,m){this.j=a,this.i=h,this.l=d,this.R=m||1,this.U=new _s(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new x_}function x_(){this.i=null,this.g="",this.h=!1}var M_={},Fu={};function Uu(a,h,d){a.L=1,a.v=La(pn(h)),a.m=d,a.P=!0,V_(a,null)}function V_(a,h){a.F=Date.now(),xa(a),a.A=pn(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),Y_(d.i,"t",m),a.C=0,d=a.j.J,a.h=new x_,a.g=py(a.j,d?h:null,!a.m),0<a.O&&(a.M=new yA(g(a.Y,a,a.g),a.O)),h=a.U,d=a.g,m=a.ca;var C="readystatechange";Array.isArray(C)||(C&&(C_[0]=C.toString()),C=C_);for(var R=0;R<C.length;R++){var k=y_(d,C[R],m||h.handleEvent,!1,h.h||h);if(!k)break;h.g[k.key]=k}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),vs(),EA(a.i,a.u,a.A,a.l,a.R,a.m)}On.prototype.ca=function(a){a=a.target;let h=this.M;h&&mn(a)==3?h.j():this.Y(a)},On.prototype.Y=function(a){try{if(a==this.g)e:{let Je=mn(this.g);var h=this.g.Ba();let Wr=this.g.Z();if(!(3>Je)&&(Je!=3||this.g&&(this.h.h||this.g.oa()||ry(this.g)))){this.J||Je!=4||h==7||(h==8||0>=Wr?vs(3):vs(2)),Bu(this);var d=this.g.Z();this.X=d;t:if(L_(this)){var m=ry(this.g);a="";var C=m.length,R=mn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ir(this),Is(this);var k="";break t}this.h.i=new c.TextDecoder}for(h=0;h<C;h++)this.h.h=!0,a+=this.h.i.decode(m[h],{stream:!(R&&h==C-1)});m.length=0,this.h.g+=a,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=d==200,IA(this.i,this.u,this.A,this.l,this.R,Je,d),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,qe=this.g;if((ge=qe.g?qe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(ge)){var ce=ge;break t}}ce=null}if(d=ce)qr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ju(this,d);else{this.o=!1,this.s=3,ot(12),ir(this),Is(this);break e}}if(this.P){d=!0;let Ft;for(;!this.J&&this.C<k.length;)if(Ft=CA(this,k),Ft==Fu){Je==4&&(this.s=4,ot(14),d=!1),qr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ft==M_){this.s=4,ot(15),qr(this.i,this.l,k,"[Invalid Chunk]"),d=!1;break}else qr(this.i,this.l,Ft,null),ju(this,Ft);if(L_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Je!=4||k.length!=0||this.h.h||(this.s=1,ot(16),d=!1),this.o=this.o&&d,!d)qr(this.i,this.l,k,"[Invalid Chunked Response]"),ir(this),Is(this);else if(0<k.length&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.ba&&!Ye.M&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Hu(Ye),Ye.M=!0,ot(11))}}else qr(this.i,this.l,k,null),ju(this,k);Je==4&&ir(this),this.o&&!this.J&&(Je==4?uy(this.j,this):(this.o=!1,xa(this)))}else $A(this.g),d==400&&0<k.indexOf("Unknown SID")?(this.s=3,ot(12)):(this.s=0,ot(13)),ir(this),Is(this)}}}catch{}finally{}};function L_(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function CA(a,h){var d=a.C,m=h.indexOf(`
`,d);return m==-1?Fu:(d=Number(h.substring(d,m)),isNaN(d)?M_:(m+=1,m+d>h.length?Fu:(h=h.slice(m,m+d),a.C=m+d,h)))}On.prototype.cancel=function(){this.J=!0,ir(this)};function xa(a){a.S=Date.now()+a.I,F_(a,a.I)}function F_(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ws(g(a.ba,a),h)}function Bu(a){a.B&&(c.clearTimeout(a.B),a.B=null)}On.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(TA(this.i,this.A),this.L!=2&&(vs(),ot(17)),ir(this),this.s=2,Is(this)):F_(this,this.S-a)};function Is(a){a.j.G==0||a.J||uy(a.j,a)}function ir(a){Bu(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,A_(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function ju(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||$u(d.h,a))){if(!a.K&&$u(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var C=m;if(C[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)$a(d),Ba(d);else break e;Wu(d),ot(18)}}else d.za=C[1],0<d.za-d.T&&37500>C[2]&&d.F&&d.v==0&&!d.C&&(d.C=ws(g(d.Za,d),6e3));if(1>=j_(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else or(d,11)}else if((a.K||d.g==a)&&$a(d),!$(h))for(C=d.Da.g.parse(h),h=0;h<C.length;h++){let ce=C[h];if(d.T=ce[0],ce=ce[1],d.G==2)if(ce[0]=="c"){d.K=ce[1],d.ia=ce[2];let Ye=ce[3];Ye!=null&&(d.la=Ye,d.j.info("VER="+d.la));let Je=ce[4];Je!=null&&(d.Aa=Je,d.j.info("SVER="+d.Aa));let Wr=ce[5];Wr!=null&&typeof Wr=="number"&&0<Wr&&(m=1.5*Wr,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;let Ft=a.g;if(Ft){let za=Ft.g?Ft.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(za){var R=m.h;R.g||za.indexOf("spdy")==-1&&za.indexOf("quic")==-1&&za.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(qu(R,R.h),R.h=null))}if(m.D){let Ku=Ft.g?Ft.g.getResponseHeader("X-HTTP-Session-Id"):null;Ku&&(m.ya=Ku,Ee(m.I,m.D,Ku))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var k=a;if(m.qa=fy(m,m.J?m.ia:null,m.W),k.K){$_(m.h,k);var ge=k,qe=m.L;qe&&(ge.I=qe),ge.B&&(Bu(ge),xa(ge)),m.g=k}else cy(m);0<d.i.length&&ja(d)}else ce[0]!="stop"&&ce[0]!="close"||or(d,7);else d.G==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?or(d,7):Gu(d):ce[0]!="noop"&&d.l&&d.l.ta(ce),d.v=0)}}vs(4)}catch{}}var AA=class{constructor(a,h){this.g=a,this.map=h}};function U_(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function B_(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function j_(a){return a.h?1:a.g?a.g.size:0}function $u(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function qu(a,h){a.g?a.g.add(h):a.h=h}function $_(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}U_.prototype.cancel=function(){if(this.i=q_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function q_(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let d of a.g.values())h=h.concat(d.D);return h}return D(a.i)}function SA(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var h=[],d=a.length,m=0;m<d;m++)h.push(a[m]);return h}h=[],d=0;for(m in a)h[d++]=a[m];return h}function RA(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(let m in a)h[d++]=m;return h}}}function z_(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=RA(a),m=SA(a),C=m.length,R=0;R<C;R++)h.call(void 0,m[R],d&&d[R],a)}var G_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PA(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),C=null;if(0<=m){var R=a[d].substring(0,m);C=a[d].substring(m+1)}else R=a[d];h(R,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function sr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof sr){this.h=a.h,Ma(this,a.j),this.o=a.o,this.g=a.g,Va(this,a.s),this.l=a.l;var h=a.i,d=new Cs;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),W_(this,d),this.m=a.m}else a&&(h=String(a).match(G_))?(this.h=!1,Ma(this,h[1]||"",!0),this.o=Ts(h[2]||""),this.g=Ts(h[3]||"",!0),Va(this,h[4]),this.l=Ts(h[5]||"",!0),W_(this,h[6]||"",!0),this.m=Ts(h[7]||"")):(this.h=!1,this.i=new Cs(null,this.h))}sr.prototype.toString=function(){var a=[],h=this.j;h&&a.push(bs(h,H_,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(bs(h,H_,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(bs(d,d.charAt(0)=="/"?kA:NA,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",bs(d,xA)),a.join("")};function pn(a){return new sr(a)}function Ma(a,h,d){a.j=d?Ts(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Va(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function W_(a,h,d){h instanceof Cs?(a.i=h,MA(a.i,a.h)):(d||(h=bs(h,OA)),a.i=new Cs(h,a.h))}function Ee(a,h,d){a.i.set(h,d)}function La(a){return Ee(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ts(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function bs(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,DA),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function DA(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var H_=/[#\/\?@]/g,NA=/[#\?:]/g,kA=/[#\?]/g,OA=/[#\?@]/g,xA=/#/g;function Cs(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function xn(a){a.g||(a.g=new Map,a.h=0,a.i&&PA(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}n=Cs.prototype,n.add=function(a,h){xn(this),this.i=null,a=zr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function K_(a,h){xn(a),h=zr(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Q_(a,h){return xn(a),h=zr(a,h),a.g.has(h)}n.forEach=function(a,h){xn(this),this.g.forEach(function(d,m){d.forEach(function(C){a.call(h,C,m,this)},this)},this)},n.na=function(){xn(this);let a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let m=0;m<h.length;m++){let C=a[m];for(let R=0;R<C.length;R++)d.push(h[m])}return d},n.V=function(a){xn(this);let h=[];if(typeof a=="string")Q_(this,a)&&(h=h.concat(this.g.get(zr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},n.set=function(a,h){return xn(this),this.i=null,a=zr(this,a),Q_(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},n.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Y_(a,h,d){K_(a,h),0<d.length&&(a.i=null,a.g.set(zr(a,h),D(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var m=h[d];let R=encodeURIComponent(String(m)),k=this.V(m);for(m=0;m<k.length;m++){var C=R;k[m]!==""&&(C+="="+encodeURIComponent(String(k[m]))),a.push(C)}}return this.i=a.join("&")};function zr(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function MA(a,h){h&&!a.j&&(xn(a),a.i=null,a.g.forEach(function(d,m){var C=m.toLowerCase();m!=C&&(K_(this,m),Y_(this,C,d))},a)),a.j=h}function VA(a,h){let d=new Es;if(c.Image){let m=new Image;m.onload=T(Mn,d,"TestLoadImage: loaded",!0,h,m),m.onerror=T(Mn,d,"TestLoadImage: error",!1,h,m),m.onabort=T(Mn,d,"TestLoadImage: abort",!1,h,m),m.ontimeout=T(Mn,d,"TestLoadImage: timeout",!1,h,m),c.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else h(!1)}function LA(a,h){let d=new Es,m=new AbortController,C=setTimeout(()=>{m.abort(),Mn(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:m.signal}).then(R=>{clearTimeout(C),R.ok?Mn(d,"TestPingServer: ok",!0,h):Mn(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(C),Mn(d,"TestPingServer: error",!1,h)})}function Mn(a,h,d,m,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),m(d)}catch{}}function FA(){this.g=new wA}function UA(a,h,d){let m=d||"";try{z_(a,function(C,R){let k=C;u(C)&&(k=Ou(C)),h.push(m+R+"="+encodeURIComponent(k))})}catch(C){throw h.push(m+"type="+encodeURIComponent("_badmap")),C}}function As(a){this.l=a.Ub||null,this.j=a.eb||!1}S(As,xu),As.prototype.g=function(){return new Fa(this.l,this.j)},As.prototype.i=function(a){return function(){return a}}({});function Fa(a,h){Qe.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Fa,Qe),n=Fa.prototype,n.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Rs(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ss(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Rs(this)),this.g&&(this.readyState=3,Rs(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;J_(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function J_(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Ss(this):Rs(this),this.readyState==3&&J_(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Ss(this))},n.Qa=function(a){this.g&&(this.response=a,Ss(this))},n.ga=function(){this.g&&Ss(this)};function Ss(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Rs(a)}n.setRequestHeader=function(a,h){this.u.append(a,h)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function Rs(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Fa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function X_(a){let h="";return K(a,function(d,m){h+=m,h+=":",h+=d,h+=`\r
`}),h}function zu(a,h,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=X_(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):Ee(a,h,d))}function Ae(a){Qe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Ae,Qe);var BA=/^https?$/i,jA=["POST","PUT"];n=Ae.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,h,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Lu.g(),this.v=this.o?S_(this.o):S_(Lu),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(R){Z_(this,R);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var C in m)d.set(C,m[C]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let R of m.keys())d.set(R,m.get(R));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(R=>R.toLowerCase()=="content-type"),C=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(jA,h,void 0))||m||C||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,k]of d)this.g.setRequestHeader(R,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ny(this),this.u=!0,this.g.send(a),this.u=!1}catch(R){Z_(this,R)}};function Z_(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,ey(a),Ua(a)}function ey(a){a.A||(a.A=!0,st(a,"complete"),st(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,st(this,"complete"),st(this,"abort"),Ua(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ua(this,!0)),Ae.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ty(this):this.bb())},n.bb=function(){ty(this)};function ty(a){if(a.h&&typeof o<"u"&&(!a.v[1]||mn(a)!=4||a.Z()!=2)){if(a.u&&mn(a)==4)T_(a.Ea,0,a);else if(st(a,"readystatechange"),mn(a)==4){a.h=!1;try{let k=a.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var d;if(!(d=h)){var m;if(m=k===0){var C=String(a.D).match(G_)[1]||null;!C&&c.self&&c.self.location&&(C=c.self.location.protocol.slice(0,-1)),m=!BA.test(C?C.toLowerCase():"")}d=m}if(d)st(a,"complete"),st(a,"success");else{a.m=6;try{var R=2<mn(a)?a.g.statusText:""}catch{R=""}a.l=R+" ["+a.Z()+"]",ey(a)}}finally{Ua(a)}}}}function Ua(a,h){if(a.g){ny(a);let d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||st(a,"ready");try{d.onreadystatechange=m}catch{}}}function ny(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function mn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<mn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),vA(h)}};function ry(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function $A(a){let h={};a=(a.g&&2<=mn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if($(a[m]))continue;var d=b(a[m]);let C=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let R=h[C]||[];h[C]=R,R.push(d)}I(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ps(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function iy(a){this.Aa=0,this.i=[],this.j=new Es,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ps("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ps("baseRetryDelayMs",5e3,a),this.cb=Ps("retryDelaySeedMs",1e4,a),this.Wa=Ps("forwardChannelMaxRetries",2,a),this.wa=Ps("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new U_(a&&a.concurrentRequestLimit),this.Da=new FA,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=iy.prototype,n.la=8,n.G=1,n.connect=function(a,h,d,m){ot(0),this.W=a,this.H=h||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=fy(this,null,this.W),ja(this)};function Gu(a){if(sy(a),a.G==3){var h=a.U++,d=pn(a.I);if(Ee(d,"SID",a.K),Ee(d,"RID",h),Ee(d,"TYPE","terminate"),Ds(a,d),h=new On(a,a.j,h),h.L=2,h.v=La(pn(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=h.v,d=!0),d||(h.g=py(h.j,null),h.g.ea(h.v)),h.F=Date.now(),xa(h)}dy(a)}function Ba(a){a.g&&(Hu(a),a.g.cancel(),a.g=null)}function sy(a){Ba(a),a.u&&(c.clearTimeout(a.u),a.u=null),$a(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function ja(a){if(!B_(a.h)&&!a.s){a.s=!0;var h=a.Ga;fs||__(),ps||(fs(),ps=!0),bu.add(h,a),a.B=0}}function qA(a,h){return j_(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ws(g(a.Ga,a,h),hy(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let C=new On(this,this.j,a),R=this.o;if(this.S&&(R?(R=_(R),E(R,this.S)):R=this.S),this.m!==null||this.O||(C.H=R,R=null),this.P)e:{for(var h=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=d;break e}if(h===4096||d===this.i.length-1){h=d+1;break e}}h=1e3}else h=1e3;h=ay(this,C,h),d=pn(this.I),Ee(d,"RID",a),Ee(d,"CVER",22),this.D&&Ee(d,"X-HTTP-Session-Id",this.D),Ds(this,d),R&&(this.O?h="headers="+encodeURIComponent(String(X_(R)))+"&"+h:this.m&&zu(d,this.m,R)),qu(this.h,C),this.Ua&&Ee(d,"TYPE","init"),this.P?(Ee(d,"$req",h),Ee(d,"SID","null"),C.T=!0,Uu(C,d,null)):Uu(C,d,h),this.G=2}}else this.G==3&&(a?oy(this,a):this.i.length==0||B_(this.h)||oy(this))};function oy(a,h){var d;h?d=h.l:d=a.U++;let m=pn(a.I);Ee(m,"SID",a.K),Ee(m,"RID",d),Ee(m,"AID",a.T),Ds(a,m),a.m&&a.o&&zu(m,a.m,a.o),d=new On(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=ay(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),qu(a.h,d),Uu(d,m,h)}function Ds(a,h){a.H&&K(a.H,function(d,m){Ee(h,m,d)}),a.l&&z_({},function(d,m){Ee(h,m,d)})}function ay(a,h,d){d=Math.min(a.i.length,d);var m=a.l?g(a.l.Na,a.l,a):null;e:{var C=a.i;let R=-1;for(;;){let k=["count="+d];R==-1?0<d?(R=C[0].g,k.push("ofs="+R)):R=0:k.push("ofs="+R);let ge=!0;for(let qe=0;qe<d;qe++){let ce=C[qe].g,Ye=C[qe].map;if(ce-=R,0>ce)R=Math.max(0,C[qe].g-100),ge=!1;else try{UA(Ye,k,"req"+ce+"_")}catch{m&&m(Ye)}}if(ge){m=k.join("&");break e}}}return a=a.i.splice(0,d),h.D=a,m}function cy(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;fs||__(),ps||(fs(),ps=!0),bu.add(h,a),a.v=0}}function Wu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ws(g(a.Fa,a),hy(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,ly(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ws(g(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ot(10),Ba(this),ly(this))};function Hu(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function ly(a){a.g=new On(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=pn(a.qa);Ee(h,"RID","rpc"),Ee(h,"SID",a.K),Ee(h,"AID",a.T),Ee(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Ee(h,"TO",a.ja),Ee(h,"TYPE","xmlhttp"),Ds(a,h),a.m&&a.o&&zu(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=La(pn(h)),d.m=null,d.P=!0,V_(d,a)}n.Za=function(){this.C!=null&&(this.C=null,Ba(this),Wu(this),ot(19))};function $a(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function uy(a,h){var d=null;if(a.g==h){$a(a),Hu(a),a.g=null;var m=2}else if($u(a.h,h))d=h.D,$_(a.h,h),m=1;else return;if(a.G!=0){if(h.o)if(m==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var C=a.B;m=Na(),st(m,new k_(m,d)),ja(a)}else cy(a);else if(C=h.s,C==3||C==0&&0<h.X||!(m==1&&qA(a,h)||m==2&&Wu(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),C){case 1:or(a,5);break;case 4:or(a,10);break;case 3:or(a,6);break;default:or(a,2)}}}function hy(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function or(a,h){if(a.j.info("Error code "+h),h==2){var d=g(a.fb,a),m=a.Xa;let C=!m;m=new sr(m||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Ma(m,"https"),La(m),C?VA(m.toString(),d):LA(m.toString(),d)}else ot(2);a.G=0,a.l&&a.l.sa(h),dy(a),sy(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ot(2)):(this.j.info("Failed to ping google.com"),ot(1))};function dy(a){if(a.G=0,a.ka=[],a.l){let h=q_(a.h);(h.length!=0||a.i.length!=0)&&(P(a.ka,h),P(a.ka,a.i),a.h.i.length=0,D(a.i),a.i.length=0),a.l.ra()}}function fy(a,h,d){var m=d instanceof sr?pn(d):new sr(d);if(m.g!="")h&&(m.g=h+"."+m.g),Va(m,m.s);else{var C=c.location;m=C.protocol,h=h?h+"."+C.hostname:C.hostname,C=+C.port;var R=new sr(null);m&&Ma(R,m),h&&(R.g=h),C&&Va(R,C),d&&(R.l=d),m=R}return d=a.D,h=a.ya,d&&h&&Ee(m,d,h),Ee(m,"VER",a.la),Ds(a,m),m}function py(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ae(new As({eb:d})):new Ae(a.pa),h.Ha(a.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function my(){}n=my.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function qa(){}qa.prototype.g=function(a,h){return new dt(a,h)};function dt(a,h){Qe.call(this),this.g=new iy(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!$(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!$(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Gr(this)}S(dt,Qe),dt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dt.prototype.close=function(){Gu(this.g)},dt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=Ou(a),a=d);h.i.push(new AA(h.Ya++,a)),h.G==3&&ja(h)},dt.prototype.N=function(){this.g.l=null,delete this.j,Gu(this.g),delete this.g,dt.aa.N.call(this)};function gy(a){Mu.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let d in h){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}S(gy,Mu);function _y(){Vu.call(this),this.status=1}S(_y,Vu);function Gr(a){this.g=a}S(Gr,my),Gr.prototype.ua=function(){st(this.g,"a")},Gr.prototype.ta=function(a){st(this.g,new gy(a))},Gr.prototype.sa=function(a){st(this.g,new _y)},Gr.prototype.ra=function(){st(this.g,"b")},qa.prototype.createWebChannel=qa.prototype.g,dt.prototype.send=dt.prototype.o,dt.prototype.open=dt.prototype.m,dt.prototype.close=dt.prototype.close,Bf=bn.createWebChannelTransport=function(){return new qa},Uf=bn.getStatEventTarget=function(){return Na()},Ff=bn.Event=rr,ul=bn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ka.NO_ERROR=0,ka.TIMEOUT=8,ka.HTTP_ERROR=6,Oo=bn.ErrorCode=ka,O_.COMPLETE="complete",Lf=bn.EventType=O_,R_.EventType=ys,ys.OPEN="a",ys.CLOSE="b",ys.ERROR="c",ys.MESSAGE="d",Qe.prototype.listen=Qe.prototype.K,bi=bn.WebChannel=R_,Dk=bn.FetchXmlHttpFactory=As,Ae.prototype.listenOnce=Ae.prototype.L,Ae.prototype.getLastError=Ae.prototype.Ka,Ae.prototype.getLastErrorCode=Ae.prototype.Ba,Ae.prototype.getStatus=Ae.prototype.Z,Ae.prototype.getResponseJson=Ae.prototype.Oa,Ae.prototype.getResponseText=Ae.prototype.oa,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Ha,Vf=bn.XhrIo=Ae}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});var jE="@firebase/firestore";var je=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};je.UNAUTHENTICATED=new je(null),je.GOOGLE_CREDENTIALS=new je("google-credentials-uid"),je.FIRST_PARTY=new je("first-party-uid"),je.MOCK_USER=new je("mock-user");var Gi="10.14.0";var Nr=new Dt("@firebase/firestore");function xo(){return Nr.logLevel}function U(n,...e){if(Nr.logLevel<=X.DEBUG){let t=e.map(vm);Nr.debug(`Firestore (${Gi}): ${n}`,...t)}}function An(n,...e){if(Nr.logLevel<=X.ERROR){let t=e.map(vm);Nr.error(`Firestore (${Gi}): ${n}`,...t)}}function Oi(n,...e){if(Nr.logLevel<=X.WARN){let t=e.map(vm);Nr.warn(`Firestore (${Gi}): ${n}`,...t)}}function vm(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function H(n="Unexpected state"){let e=`FIRESTORE (${Gi}) INTERNAL ASSERTION FAILED: `+n;throw An(e),new Error(e)}function Re(n,e){n||H()}function ie(n,e){return n}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},j=class extends We{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Jn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ml=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Wf=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(je.UNAUTHENTICATED))}shutdown(){}},Hf=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Kf=class{constructor(e){this.t=e,this.currentUser=je.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Re(this.o===void 0);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new Jn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Jn,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>w(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Jn)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Re(typeof r.accessToken=="string"),new ml(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string"),new je(e)}},Qf=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=je.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Yf=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Qf(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(je.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Jf=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Xf=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Re(this.o===void 0);let r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Re(typeof t.token=="string"),this.R=t.token,new Jf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Nk(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Zf=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Nk(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function he(n,e){return n<e?-1:n>e?1:0}function xi(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var xt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new j(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new j(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new j(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Y=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new xt(0,0))}static max(){return new n(new xt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var gl=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(),r===void 0?r=e.length-t:r>e.length-t&&H(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Me=class n extends gl{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new j(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},kk=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Gt=class n extends gl{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return kk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new j(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new j(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new j(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new j(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(Me.fromString(e))}static fromName(e){return new n(Me.fromString(e).popFirst(5))}static empty(){return new n(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Me(e.slice()))}};var ep=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};ep.UNKNOWN_ID=-1;function Ok(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(r===1e9?new xt(t+1,0):new xt(t,r));return new kr(i,q.empty(),e)}function xk(n){return new kr(n.readTime,n.key,-1)}var kr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Y.min(),q.empty(),-1)}static max(){return new n(Y.max(),q.empty(),-1)}};function Mk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:he(n.largestBatchId,e.largestBatchId))}var Vk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",tp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function wm(n){return w(this,null,function*(){if(n.code!==x.FAILED_PRECONDITION||n.message!==Vk)throw n;U("LocalStore","Unexpectedly lost primary lease")})}var N=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let l=0;l<s;l++){let u=l;t(e[u]).next(f=>{o[u]=f,++c,c===s&&r(o)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function Lk(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Zo(n){return n.name==="IndexedDbTransactionError"}var EI=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function jl(n){return n==null}function _l(n){return n===0&&1/n==-1/0}var Fk=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],kB=[...Fk,"documentOverlays"],Uk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Bk=Uk,jk=[...Bk,"indexConfiguration","indexState","indexEntries"];var OB=[...jk,"globals"];function $E(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function $l(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $k(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Pe=class n{constructor(e,t){this.comparator=e,this.root=t||cn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ri(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ri(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ri(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ri(this.root,e,this.comparator,!0)}},Ri=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},cn=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();let e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}};cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(e,t,r,i,s){return this}insert(e,t,r){return new cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var et=class n{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yl(this.data.getIterator())}getIteratorFrom(e){return new yl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},yl=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Sr=class n{constructor(e){this.fields=e,e.sort(Gt.comparator)}static empty(){return new n([])}unionWith(e){let t=new et(Gt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xi(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var vl=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var tt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new vl("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};tt.EMPTY_BYTE_STRING=new tt("");var qk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sn(n){if(Re(!!n),typeof n=="string"){let e=0,t=qk.exec(n);if(Re(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:be(n.seconds),nanos:be(n.nanos)}}function be(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xn(n){return typeof n=="string"?tt.fromBase64String(n):tt.fromUint8Array(n)}function Em(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Im(n){let e=n.mapValue.fields.__previous_value__;return Em(e)?Im(e):e}function jo(n){let e=Sn(n.mapValue.fields.__local_write_time__.timestampValue);return new xt(e.seconds,e.nanos)}var np=class{constructor(e,t,r,i,s,o,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=u}},wl=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var hl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Or(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Em(n)?4:TI(n)?9007199254740991:II(n)?10:11:H()}function un(n,e){if(n===e)return!0;let t=Or(n);if(t!==Or(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return jo(n).isEqual(jo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Sn(i.timestampValue),c=Sn(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Xn(i.bytesValue).isEqual(Xn(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return be(i.geoPointValue.latitude)===be(s.geoPointValue.latitude)&&be(i.geoPointValue.longitude)===be(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return be(i.integerValue)===be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=be(i.doubleValue),c=be(s.doubleValue);return o===c?_l(o)===_l(c):isNaN(o)&&isNaN(c)}return!1}(n,e);case 9:return xi(n.arrayValue.values||[],e.arrayValue.values||[],un);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if($E(o)!==$E(c))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!un(o[l],c[l])))return!1;return!0}(n,e);default:return H()}}function $o(n,e){return(n.values||[]).find(t=>un(t,e))!==void 0}function Mi(n,e){if(n===e)return 0;let t=Or(n),r=Or(e);if(t!==r)return he(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return he(n.booleanValue,e.booleanValue);case 2:return function(s,o){let c=be(s.integerValue||s.doubleValue),l=be(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return qE(n.timestampValue,e.timestampValue);case 4:return qE(jo(n),jo(e));case 5:return he(n.stringValue,e.stringValue);case 6:return function(s,o){let c=Xn(s),l=Xn(o);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let c=s.split("/"),l=o.split("/");for(let u=0;u<c.length&&u<l.length;u++){let f=he(c[u],l[u]);if(f!==0)return f}return he(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let c=he(be(s.latitude),be(o.latitude));return c!==0?c:he(be(s.longitude),be(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return zE(n.arrayValue,e.arrayValue);case 10:return function(s,o){var c,l,u,f;let p=s.fields||{},g=o.fields||{},T=(c=p.value)===null||c===void 0?void 0:c.arrayValue,S=(l=g.value)===null||l===void 0?void 0:l.arrayValue,D=he(((u=T?.values)===null||u===void 0?void 0:u.length)||0,((f=S?.values)===null||f===void 0?void 0:f.length)||0);return D!==0?D:zE(T,S)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===hl.mapValue&&o===hl.mapValue)return 0;if(s===hl.mapValue)return 1;if(o===hl.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){let g=he(l[p],f[p]);if(g!==0)return g;let T=Mi(c[l[p]],u[f[p]]);if(T!==0)return T}return he(l.length,f.length)}(n.mapValue,e.mapValue);default:throw H()}}function qE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return he(n,e);let t=Sn(n),r=Sn(e),i=he(t.seconds,r.seconds);return i!==0?i:he(t.nanos,r.nanos)}function zE(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Mi(t[i],r[i]);if(s)return s}return he(t.length,r.length)}function Vi(n){return rp(n)}function rp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Sn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Xn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=rp(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${rp(t.fields[o])}`;return i+"}"}(n.mapValue):H()}function ip(n){return!!n&&"integerValue"in n}function Tm(n){return!!n&&"arrayValue"in n}function GE(n){return!!n&&"nullValue"in n}function WE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jf(n){return!!n&&"mapValue"in n}function II(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Vo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return $l(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Vo(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function TI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Cn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vo(t)}setAll(e){let t=Gt.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Vo(o):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());jf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return un(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];jf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){$l(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Vo(this.value))}};var Wt=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,Y.min(),Y.min(),Y.min(),Cn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Y.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Y.min(),Y.min(),Cn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Y.min(),Y.min(),Cn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Li=class{constructor(e,t){this.position=e,this.inclusive=t}};function HE(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=q.comparator(q.fromName(o.referenceValue),t.key):r=Mi(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function KE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!un(n.position[t],e.position[t]))return!1;return!0}var Fi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function zk(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var El=class{},Le=class n extends El{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new op(e,t,r):t==="array-contains"?new lp(e,r):t==="in"?new up(e,r):t==="not-in"?new hp(e,r):t==="array-contains-any"?new dp(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ap(e,r):new cp(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Mi(t,this.value)):t!==null&&Or(this.value)===Or(t)&&this.matchesComparison(Mi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},hn=class n extends El{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return bI(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function bI(n){return n.op==="and"}function CI(n){return Gk(n)&&bI(n)}function Gk(n){for(let e of n.filters)if(e instanceof hn)return!1;return!0}function sp(n){if(n instanceof Le)return n.field.canonicalString()+n.op.toString()+Vi(n.value);if(CI(n))return n.filters.map(e=>sp(e)).join(",");{let e=n.filters.map(t=>sp(t)).join(",");return`${n.op}(${e})`}}function AI(n,e){return n instanceof Le?function(r,i){return i instanceof Le&&r.op===i.op&&r.field.isEqual(i.field)&&un(r.value,i.value)}(n,e):n instanceof hn?function(r,i){return i instanceof hn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&AI(o,i.filters[c]),!0):!1}(n,e):void H()}function SI(n){return n instanceof Le?function(t){return`${t.field.canonicalString()} ${t.op} ${Vi(t.value)}`}(n):n instanceof hn?function(t){return t.op.toString()+" {"+t.getFilters().map(SI).join(" ,")+"}"}(n):"Filter"}var op=class extends Le{constructor(e,t,r){super(e,t,r),this.key=q.fromName(r.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},ap=class extends Le{constructor(e,t){super(e,"in",t),this.keys=RI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},cp=class extends Le{constructor(e,t){super(e,"not-in",t),this.keys=RI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function RI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>q.fromName(r.referenceValue))}var lp=class extends Le{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Tm(t)&&$o(t.arrayValue,this.value)}},up=class extends Le{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&$o(this.value.arrayValue,t)}},hp=class extends Le{constructor(e,t){super(e,"not-in",t)}matches(e){if($o(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!$o(this.value.arrayValue,t)}},dp=class extends Le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Tm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>$o(this.value.arrayValue,r))}};var fp=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.ue=null}};function QE(n,e=null,t=[],r=[],i=null,s=null,o=null){return new fp(n,e,t,r,i,s,o)}function bm(n){let e=ie(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>sp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),jl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Vi(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Vi(r)).join(",")),e.ue=t}return e.ue}function Cm(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zk(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!AI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!KE(n.startAt,e.startAt)&&KE(n.endAt,e.endAt)}function pp(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ui=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Wk(n,e,t,r,i,s,o,c){return new Ui(n,e,t,r,i,s,o,c)}function Am(n){return new Ui(n)}function YE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Hk(n){return n.collectionGroup!==null}function Lo(n){let e=ie(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new et(Gt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Fi(s,r))}),t.has(Gt.keyField().canonicalString())||e.ce.push(new Fi(Gt.keyField(),r))}return e.ce}function ln(n){let e=ie(n);return e.le||(e.le=Kk(e,Lo(n))),e.le}function Kk(n,e){if(n.limitType==="F")return QE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Fi(i.field,s)});let t=n.endAt?new Li(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Li(n.startAt.position,n.startAt.inclusive):null;return QE(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function mp(n,e,t){return new Ui(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ql(n,e){return Cm(ln(n),ln(e))&&n.limitType===e.limitType}function PI(n){return`${bm(ln(n))}|lt:${n.limitType}`}function Ci(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>SI(i)).join(", ")}]`),jl(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Vi(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Vi(i)).join(",")),`Target(${r})`}(ln(n))}; limitType=${n.limitType})`}function zl(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Lo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,c,l){let u=HE(o,c,l);return o.inclusive?u<=0:u<0}(r.startAt,Lo(r),i)||r.endAt&&!function(o,c,l){let u=HE(o,c,l);return o.inclusive?u>=0:u>0}(r.endAt,Lo(r),i))}(n,e)}function Qk(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function DI(n){return(e,t)=>{let r=!1;for(let i of Lo(n)){let s=Yk(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Yk(n,e,t){let r=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,o,c){let l=o.data.field(s),u=c.data.field(s);return l!==null&&u!==null?Mi(l,u):H()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}var Zn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$l(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return $k(this.inner)}size(){return this.innerSize}};var Jk=new Pe(q.comparator);function er(){return Jk}var NI=new Pe(q.comparator);function Mo(...n){let e=NI;for(let t of n)e=e.insert(t.key,t);return e}function Xk(n){let e=NI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Rr(){return Fo()}function kI(){return Fo()}function Fo(){return new Zn(n=>n.toString(),(n,e)=>n.isEqual(e))}var MB=new Pe(q.comparator),Zk=new et(q.comparator);function ae(...n){let e=Zk;for(let t of n)e=e.add(t);return e}var eO=new et(he);function tO(){return eO}function nO(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_l(e)?"-0":e}}function rO(n){return{integerValue:""+n}}var Bi=class{constructor(){this._=void 0}};function iO(n,e,t){return n instanceof qo?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Em(s)&&(s=Im(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof ji?OI(n,e):n instanceof $i?xI(n,e):function(i,s){let o=oO(i,s),c=JE(o)+JE(i.Pe);return ip(o)&&ip(i.Pe)?rO(c):nO(i.serializer,c)}(n,e)}function sO(n,e,t){return n instanceof ji?OI(n,e):n instanceof $i?xI(n,e):t}function oO(n,e){return n instanceof zo?function(r){return ip(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var qo=class extends Bi{},ji=class extends Bi{constructor(e){super(),this.elements=e}};function OI(n,e){let t=MI(e);for(let r of n.elements)t.some(i=>un(i,r))||t.push(r);return{arrayValue:{values:t}}}var $i=class extends Bi{constructor(e){super(),this.elements=e}};function xI(n,e){let t=MI(e);for(let r of n.elements)t=t.filter(i=>!un(i,r));return{arrayValue:{values:t}}}var zo=class extends Bi{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function JE(n){return be(n.integerValue||n.doubleValue)}function MI(n){return Tm(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function aO(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof ji&&i instanceof ji||r instanceof $i&&i instanceof $i?xi(r.elements,i.elements,un):r instanceof zo&&i instanceof zo?un(r.Pe,i.Pe):r instanceof qo&&i instanceof qo}(n.transform,e.transform)}var Uo=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function fl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Go=class{};function VI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new gp(n.key,Uo.none()):new Wo(n.key,n.data,Uo.none());{let t=n.data,r=Cn.empty(),i=new et(Gt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new qi(n.key,r,new Sr(i.toArray()),Uo.none())}}function cO(n,e,t){n instanceof Wo?function(i,s,o){let c=i.value.clone(),l=ZE(i.fieldTransforms,s,o.transformResults);c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):n instanceof qi?function(i,s,o){if(!fl(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=ZE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(LI(i)),l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Bo(n,e,t,r){return n instanceof Wo?function(s,o,c,l){if(!fl(s.precondition,o))return c;let u=s.value.clone(),f=eI(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof qi?function(s,o,c,l){if(!fl(s.precondition,o))return c;let u=eI(s.fieldTransforms,l,o),f=o.data;return f.setAll(LI(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(s,o,c){return fl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(n,e,t)}function XE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&xi(r,i,(s,o)=>aO(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Wo=class extends Go{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},qi=class extends Go{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function LI(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ZE(n,e,t){let r=new Map;Re(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,sO(o,c,t[i]))}return r}function eI(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,iO(s,o,e))}return r}var gp=class extends Go{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};var _p=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&cO(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Bo(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Bo(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=kI();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let l=VI(o,c);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ae())}isEqual(e){return this.batchId===e.batchId&&xi(this.mutations,e.mutations,(t,r)=>XE(t,r))&&xi(this.baseMutations,e.baseMutations,(t,r)=>XE(t,r))}};var yp=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var vp=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Oe,re;function FI(n){if(n===void 0)return An("GRPC error has no .code"),x.UNKNOWN;switch(n){case Oe.OK:return x.OK;case Oe.CANCELLED:return x.CANCELLED;case Oe.UNKNOWN:return x.UNKNOWN;case Oe.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case Oe.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case Oe.INTERNAL:return x.INTERNAL;case Oe.UNAVAILABLE:return x.UNAVAILABLE;case Oe.UNAUTHENTICATED:return x.UNAUTHENTICATED;case Oe.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case Oe.NOT_FOUND:return x.NOT_FOUND;case Oe.ALREADY_EXISTS:return x.ALREADY_EXISTS;case Oe.PERMISSION_DENIED:return x.PERMISSION_DENIED;case Oe.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case Oe.ABORTED:return x.ABORTED;case Oe.OUT_OF_RANGE:return x.OUT_OF_RANGE;case Oe.UNIMPLEMENTED:return x.UNIMPLEMENTED;case Oe.DATA_LOSS:return x.DATA_LOSS;default:return H()}}(re=Oe||(Oe={}))[re.OK=0]="OK",re[re.CANCELLED=1]="CANCELLED",re[re.UNKNOWN=2]="UNKNOWN",re[re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",re[re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",re[re.NOT_FOUND=5]="NOT_FOUND",re[re.ALREADY_EXISTS=6]="ALREADY_EXISTS",re[re.PERMISSION_DENIED=7]="PERMISSION_DENIED",re[re.UNAUTHENTICATED=16]="UNAUTHENTICATED",re[re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",re[re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",re[re.ABORTED=10]="ABORTED",re[re.OUT_OF_RANGE=11]="OUT_OF_RANGE",re[re.UNIMPLEMENTED=12]="UNIMPLEMENTED",re[re.INTERNAL=13]="INTERNAL",re[re.UNAVAILABLE=14]="UNAVAILABLE",re[re.DATA_LOSS=15]="DATA_LOSS";var tI=null;function lO(){return new TextEncoder}var uO=new Yn([4294967295,4294967295],0);function nI(n){let e=lO().encode(n),t=new Mf;return t.update(e),new Uint8Array(t.digest())}function rI(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Yn([t,r],0),new Yn([i,s],0)]}var wp=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Pr(`Invalid padding: ${t}`);if(r<0)throw new Pr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Pr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Pr(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Yn.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Yn.fromNumber(r)));return i.compare(uO)===1&&(i=new Yn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=nI(e),[r,i]=rI(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;let t=nI(e),[r,i]=rI(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Pr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Il=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ho.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Y.min(),i,new Pe(he),er(),ae())}},Ho=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ae(),ae(),ae())}};var Pi=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Tl=class{constructor(e,t){this.targetId=e,this.me=t}},bl=class{constructor(e,t,r=tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Cl=class{constructor(){this.fe=0,this.ge=sI(),this.pe=tt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ae(),t=ae(),r=ae();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H()}}),new Ho(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=sI()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Re(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Ep=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=er(),this.qe=iI(),this.Qe=new Pe(he)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:H()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(pp(s))if(r===0){let o=new q(s.path);this.Ue(t,o,Wt.newNoDocument(o,Y.min()))}else Re(r===1);else{let o=this.Ye(t);if(o!==r){let c=this.Ze(e),l=c?this.Xe(c,e,o):1;if(l!==0){this.je(t);let u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}tI?.et(function(f,p,g,T,S){var D,P,M,$,B,F;let pe={localCacheCount:f,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},K=p.unchangedNames;return K&&(pe.bloomFilter={applied:S===0,hashCount:(D=K?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:($=(M=(P=K?.bits)===null||P===void 0?void 0:P.bitmap)===null||M===void 0?void 0:M.length)!==null&&$!==void 0?$:0,padding:(F=(B=K?.bits)===null||B===void 0?void 0:B.padding)!==null&&F!==void 0?F:0,mightContain:I=>{var _;return(_=T?.mightContain(I))!==null&&_!==void 0&&_}}),pe}(o,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=Xn(r).toUint8Array()}catch(l){if(l instanceof vl)return Oi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new wp(o,i,s)}catch(l){return Oi(l instanceof Pr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let c=this.Je(o);if(c){if(s.current&&pp(c.target)){let l=new q(c.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Wt.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=ae();this.qe.forEach((s,o)=>{let c=!0;o.forEachWhile(l=>{let u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Il(e,t,this.Qe,this.ke,r);return this.ke=er(),this.qe=iI(),this.Qe=new Pe(he),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Cl,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new et(he),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Cl),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function iI(){return new Pe(q.comparator)}function sI(){return new Pe(q.comparator)}var hO={asc:"ASCENDING",desc:"DESCENDING"},dO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fO={and:"AND",or:"OR"},Ip=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Tp(n,e){return n.useProto3Json||jl(e)?e:{value:e}}function pO(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Di(n){return Re(!!n),Y.fromTimestamp(function(t){let r=Sn(t);return new xt(r.seconds,r.nanos)}(n))}function gO(n,e){return bp(n,e).canonicalString()}function bp(n,e){let t=function(i){return new Me(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function UI(n){let e=Me.fromString(n);return Re(zI(e)),e}function $f(n,e){let t=UI(e);if(t.get(1)!==n.databaseId.projectId)throw new j(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new j(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(jI(t))}function BI(n,e){return gO(n.databaseId,e)}function _O(n){let e=UI(n);return e.length===4?Me.emptyPath():jI(e)}function oI(n){return new Me(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jI(n){return Re(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function yO(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:H()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(Re(f===void 0||typeof f=="string"),tt.fromBase64String(f||"")):(Re(f===void 0||f instanceof Buffer||f instanceof Uint8Array),tt.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(u){let f=u.code===void 0?x.UNKNOWN:FI(u.code);return new j(f,u.message||"")}(o);t=new bl(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=$f(n,r.document.name),s=Di(r.document.updateTime),o=r.document.createTime?Di(r.document.createTime):Y.min(),c=new Cn({mapValue:{fields:r.document.fields}}),l=Wt.newFoundDocument(i,s,o,c),u=r.targetIds||[],f=r.removedTargetIds||[];t=new Pi(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=$f(n,r.document),s=r.readTime?Di(r.readTime):Y.min(),o=Wt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Pi([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=$f(n,r.document),s=r.removedTargetIds||[];t=new Pi([],s,i,null)}else{if(!("filter"in e))return H();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new vp(i,s),c=r.targetId;t=new Tl(c,o)}}return t}function vO(n,e){return{documents:[BI(n,e.path)]}}function wO(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=BI(n,i);let s=function(u){if(u.length!==0)return qI(hn.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Ai(g.field),direction:TO(g.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=Tp(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function EO(n){let e=_O(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Re(r===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(p){let g=$I(p);return g instanceof hn&&CI(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(g=>function(S){return new Fi(Si(S.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(t.orderBy));let c=null;t.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,jl(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(p){let g=!!p.before,T=p.values||[];return new Li(T,g)}(t.startAt));let u=null;return t.endAt&&(u=function(p){let g=!p.before,T=p.values||[];return new Li(T,g)}(t.endAt)),Wk(e,i,o,s,c,"F",l,u)}function IO(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $I(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Si(t.unaryFilter.field);return Le.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Si(t.unaryFilter.field);return Le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Si(t.unaryFilter.field);return Le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Si(t.unaryFilter.field);return Le.create(o,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(n):n.fieldFilter!==void 0?function(t){return Le.create(Si(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return hn.create(t.compositeFilter.filters.map(r=>$I(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H()}}(t.compositeFilter.op))}(n):H()}function TO(n){return hO[n]}function bO(n){return dO[n]}function CO(n){return fO[n]}function Ai(n){return{fieldPath:n.canonicalString()}}function Si(n){return Gt.fromServerFormat(n.fieldPath)}function qI(n){return n instanceof Le?function(t){if(t.op==="=="){if(WE(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NAN"}};if(GE(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(WE(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NOT_NAN"}};if(GE(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ai(t.field),op:bO(t.op),value:t.value}}}(n):n instanceof hn?function(t){let r=t.getFilters().map(i=>qI(i));return r.length===1?r[0]:{compositeFilter:{op:CO(t.op),filters:r}}}(n):H()}function zI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ko=class n{constructor(e,t,r,i,s=Y.min(),o=Y.min(),c=tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Cp=class{constructor(e){this.ct=e}};function AO(n){let e=EO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?mp(e,e.limit,"L"):e}var Al=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(be(e.integerValue));else if("doubleValue"in e){let r=be(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),_l(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Sn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Xn(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?TI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):II(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):H()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",c=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(be(c)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),q.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Al.vt=new Al;var Ap=class{constructor(){this.un=new Sp}addToCollectionParentIndex(e,t){return this.un.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(kr.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(kr.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}},Sp=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new et(Me.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new et(Me.comparator)).toArray()}};var VB=new Uint8Array(0);var an=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};an.DEFAULT_COLLECTION_PERCENTILE=10,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,an.DEFAULT=new an(41943040,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),an.DISABLED=new an(-1,0,0);var Qo=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Rp=class{constructor(){this.changes=new Zn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Pp=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Dp=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Bo(r.mutation,i,Sr.empty(),xt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ae()){let i=Rr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Mo();return s.forEach((c,l)=>{o=o.insert(c,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Rr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ae()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,r,i){let s=er(),o=Fo(),c=function(){return Fo()}();return t.forEach((l,u)=>{let f=r.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof qi)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),Bo(f.mutation,u,f.mutation.getFieldMask(),xt.now())):o.set(u.key,Sr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),t.forEach((u,f)=>{var p;return c.set(u,new Pp(f,(p=o.get(u))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,t){let r=Fo(),i=new Pe((o,c)=>o-c),s=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(l=>{let u=t.get(l);if(u===null)return;let f=r.get(l)||Sr.empty();f=c.applyToLocalView(u,f),r.set(l,f);let p=(i.get(c.batchId)||ae()).add(l);i=i.insert(c.batchId,p)})}).next(()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),u=l.key,f=l.value,p=kI();f.forEach(g=>{if(!s.has(g)){let T=VI(t.get(g),r.get(g));T!==null&&p.set(g,T),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Hk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):N.resolve(Rr()),c=-1,l=s;return o.next(u=>N.forEach(u,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(f)?N.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ae())).next(f=>({batchId:c,changes:Xk(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(r=>{let i=Mo();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Mo();return this.indexManager.getCollectionParents(e,s).next(c=>N.forEach(c,l=>{let u=function(p,g){return new Ui(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,u)=>{let f=u.getKey();o.get(f)===null&&(o=o.insert(f,Wt.newInvalidDocument(f)))});let c=Mo();return o.forEach((l,u)=>{let f=s.get(l);f!==void 0&&Bo(f.mutation,u,Sr.empty(),xt.now()),zl(t,u)&&(c=c.insert(l,u))}),c})}};var Np=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return N.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Di(i.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:AO(i.bundledQuery),readTime:Di(i.readTime)}}(t)),N.resolve()}};var kp=class{constructor(){this.overlays=new Pe(q.comparator),this.Ir=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Rr();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),N.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){let i=Rr(),s=t.length+1,o=new q(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let l=c.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pe((u,f)=>u-f),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Rr(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}let c=Rr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>c.set(u,f)),!(c.size()>=i)););return N.resolve(c)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yp(t,r));let s=this.Ir.get(t);s===void 0&&(s=ae(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var Op=class{constructor(){this.sessionToken=tt.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}};var Yo=class{constructor(){this.Tr=new et(xe.Er),this.dr=new et(xe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new xe(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new xe(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new q(new Me([])),r=new xe(t,e),i=new xe(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new q(new Me([])),r=new xe(t,e),i=new xe(t,e+1),s=ae();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new xe(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},xe=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return q.comparator(e.key,t.key)||he(e.wr,t.wr)}static Ar(e,t){return he(e.wr,t.wr)||q.comparator(e.key,t.key)}};var xp=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new et(xe.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new _p(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.br=this.br.add(new xe(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new xe(t,0),i=new xe(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let c=this.Dr(o.wr);s.push(c)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new et(he);return t.forEach(i=>{let s=new xe(i,0),o=new xe(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],c=>{r=r.add(c.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;q.isDocumentKey(s)||(s=s.child(""));let o=new xe(new q(s),0),c=new et(he);return this.br.forEachWhile(l=>{let u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(c=c.add(l.wr)),!0)},o),N.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Re(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(t.mutations,i=>{let s=new xe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new xe(t,0),i=this.br.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Mp=class{constructor(e){this.Mr=e,this.docs=function(){return new Pe(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let r=er();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Wt.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=er(),o=t.path,c=new q(o.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Mk(xk(f),r)<=0||(i.has(f.key)||zl(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,t,r,i){H()}Or(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Vp(this)}getSize(e){return N.resolve(this.size)}},Vp=class extends Rp{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Lp=class{constructor(e){this.persistence=e,this.Nr=new Zn(t=>bm(t),Cm),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Yo,this.targetCount=0,this.kr=Qo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),N.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Qo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Kn(t),N.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),N.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Br.containsKey(t))}};var Fp=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new EI(0),this.Kr=!1,this.Kr=!0,this.$r=new Op,this.referenceDelegate=e(this),this.Ur=new Lp(this),this.indexManager=new Ap,this.remoteDocumentCache=function(i){return new Mp(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Cp(t),this.Gr=new Np(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new xp(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);let i=new Up(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Up=class extends tp{constructor(e){super(),this.currentSequenceNumber=e}},Bp=class n{constructor(e){this.persistence=e,this.Jr=new Yo,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw H()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),N.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{let i=q.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,Y.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return N.or([()=>N.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var jp=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ae(),i=ae();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var $p=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var qp=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Ew()?8:Lk(Fe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $p;return this.Xi(e,t,o).next(c=>{if(s.result=c,this.zi)return this.es(e,t,o,c.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(xo()<=X.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",Ci(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(xo()<=X.DEBUG&&U("QueryEngine","Query:",Ci(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(xo()<=X.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",Ci(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ln(t))):N.resolve())}Yi(e,t){if(YE(t))return N.resolve(null);let r=ln(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=mp(t,null,"F"),r=ln(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ae(...s);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(l=>{let u=this.ts(t,c);return this.ns(t,u,o,l.readTime)?this.Yi(e,mp(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,r,i){return YE(t)||i.isEqual(Y.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?N.resolve(null):(xo()<=X.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ci(t)),this.rs(e,o,t,Ok(i,-1)).next(c=>c))})}ts(e,t){let r=new et(DI(e));return t.forEach((i,s)=>{zl(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return xo()<=X.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Ci(t)),this.Ji.getDocumentsMatchingQuery(e,t,kr.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var zp=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Pe(he),this._s=new Zn(s=>bm(s),Cm),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Dp(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function SO(n,e,t,r){return new zp(n,e,t,r)}function GI(n,e){return w(this,null,function*(){let t=ie(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],c=[],l=ae();for(let u of i){o.push(u.batchId);for(let f of u.mutations)l=l.add(f.key)}for(let u of s){c.push(u.batchId);for(let f of u.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:c}))})})})}function WI(n){let e=ie(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function RO(n,e){let t=ie(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let c=[];e.targetChanges.forEach((f,p)=>{let g=i.get(p);if(!g)return;c.push(t.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,f.addedDocuments,p)));let T=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?T=T.withResumeToken(tt.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):f.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(f.resumeToken,r)),i=i.insert(p,T),function(D,P,M){return D.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(g,T,f)&&c.push(t.Ur.updateTargetData(s,T))});let l=er(),u=ae();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(PO(s,o,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!r.isEqual(Y.min())){let f=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(f)}return N.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=i,s))}function PO(n,e,t){let r=ae(),i=ae();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=er();return t.forEach((c,l)=>{let u=s.get(c);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(Y.min())?(e.removeEntry(c,l.readTime),o=o.insert(c,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(c,l)):U("LocalStore","Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function DO(n,e){let t=ie(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Ko(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Gp(n,e,t){return w(this,null,function*(){let r=ie(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Zo(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function aI(n,e,t){let r=ie(n),i=Y.min(),s=ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){let p=ie(l),g=p._s.get(f);return g!==void 0?N.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(r,o,ln(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,c.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:Y.min(),t?s:ae())).next(c=>(NO(r,Qk(e),c),{documents:c,Ts:s})))}function NO(n,e,t){let r=n.us.get(e)||Y.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Sl=class{constructor(){this.activeTargetIds=tO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Wp=class{constructor(){this.so=new Sl,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Sl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Hp=class{_o(e){}shutdown(){}};var Rl=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var dl=null;function qf(){return dl===null?dl=function(){return 268435456+Math.round(2147483648*Math.random())}():dl++,"0x"+dl.toString(16)}var kO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Kp=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ze="WebChannelConnection",Qp=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let c=qf(),l=this.xo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${c}:`,l,i);let u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,l,u,i).then(f=>(U("RestConnection",`Received RPC '${t}' ${c}: `,f),f),f=>{throw Oi("RestConnection",`RPC '${t}' ${c} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(t,r,i,s,o,c){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gi}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=kO[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=qf();return new Promise((o,c)=>{let l=new Vf;l.setWithCredentials(!0),l.listenOnce(Lf.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Oo.NO_ERROR:let f=l.getResponseJson();U(Ze,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Oo.TIMEOUT:U(Ze,`RPC '${e}' ${s} timed out`),c(new j(x.DEADLINE_EXCEEDED,"Request time out"));break;case Oo.HTTP_ERROR:let p=l.getStatus();if(U(Ze,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);let T=g?.error;if(T&&T.status&&T.message){let S=function(P){let M=P.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(M)>=0?M:x.UNKNOWN}(T.status);c(new j(S,T.message))}else c(new j(x.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new j(x.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{U(Ze,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);U(Ze,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",u,r,15)})}Bo(e,t,r){let i=qf(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Bf(),c=Uf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let f=s.join("");U(Ze,`Creating RPC '${e}' stream ${i}: ${f}`,l);let p=o.createWebChannel(f,l),g=!1,T=!1,S=new Kp({Io:P=>{T?U(Ze,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(g||(U(Ze,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),U(Ze,`RPC '${e}' stream ${i} sending:`,P),p.send(P))},To:()=>p.close()}),D=(P,M,$)=>{P.listen(M,B=>{try{$(B)}catch(F){setTimeout(()=>{throw F},0)}})};return D(p,bi.EventType.OPEN,()=>{T||(U(Ze,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),D(p,bi.EventType.CLOSE,()=>{T||(T=!0,U(Ze,`RPC '${e}' stream ${i} transport closed`),S.So())}),D(p,bi.EventType.ERROR,P=>{T||(T=!0,Oi(Ze,`RPC '${e}' stream ${i} transport errored:`,P),S.So(new j(x.UNAVAILABLE,"The operation could not be completed")))}),D(p,bi.EventType.MESSAGE,P=>{var M;if(!T){let $=P.data[0];Re(!!$);let B=$,F=B.error||((M=B[0])===null||M===void 0?void 0:M.error);if(F){U(Ze,`RPC '${e}' stream ${i} received error:`,F);let pe=F.status,K=function(v){let E=Oe[v];if(E!==void 0)return FI(E)}(pe),I=F.message;K===void 0&&(K=x.INTERNAL,I="Unknown error status: "+pe+" with message "+F.message),T=!0,S.So(new j(K,I)),p.close()}else U(Ze,`RPC '${e}' stream ${i} received:`,$),S.bo($)}}),D(c,Ff.STAT_EVENT,P=>{P.stat===ul.PROXY?U(Ze,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===ul.NOPROXY&&U(Ze,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}};function zf(){return typeof document<"u"?document:null}function HI(n){return new Ip(n,!0)}var Pl=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Yp=class{constructor(e,t,r,i,s,o,c,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Pl(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return w(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return w(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return w(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(An(t.toString()),An("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new j(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>w(this,null,function*(){this.state=0,this.start()}))}I_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Jp=class extends Yp{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=yO(this.serializer,e),r=function(s){if(!("targetChange"in s))return Y.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?Di(o.readTime):Y.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=oI(this.serializer),t.addTarget=function(s,o){let c,l=o.target;if(c=pp(l)?{documents:vO(s,l)}:{query:wO(s,l)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=mO(s,o.resumeToken);let u=Tp(s,o.expectedCount);u!==null&&(c.expectedCount=u)}else if(o.snapshotVersion.compareTo(Y.min())>0){c.readTime=pO(s,o.snapshotVersion.toTimestamp());let u=Tp(s,o.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);let r=IO(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=oI(this.serializer),t.removeTarget=e,this.a_(t)}};var Xp=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new j(x.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,bp(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(x.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,bp(t,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new j(x.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Zp=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(An(t),this.D_=!1):U("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var em=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>w(this,null,function*(){ta(this)&&(U("RemoteStore","Restarting streams for network reachability change."),yield function(l){return w(this,null,function*(){let u=ie(l);u.L_.add(4),yield ea(u),u.q_.set("Unknown"),u.L_.delete(4),yield Gl(u)})}(this))}))}),this.q_=new Zp(r,i)}};function Gl(n){return w(this,null,function*(){if(ta(n))for(let e of n.B_)yield e(!0)})}function ea(n){return w(this,null,function*(){for(let e of n.B_)yield e(!1)})}function KI(n,e){let t=ie(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Dm(t)?Pm(t):Wi(t).r_()&&Rm(t,e))}function Sm(n,e){let t=ie(n),r=Wi(t);t.N_.delete(e),r.r_()&&QI(t,e),t.N_.size===0&&(r.r_()?r.o_():ta(t)&&t.q_.set("Unknown"))}function Rm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wi(n).A_(e)}function QI(n,e){n.Q_.xe(e),Wi(n).R_(e)}function Pm(n){n.Q_=new Ep({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Wi(n).start(),n.q_.v_()}function Dm(n){return ta(n)&&!Wi(n).n_()&&n.N_.size>0}function ta(n){return ie(n).L_.size===0}function YI(n){n.Q_=void 0}function OO(n){return w(this,null,function*(){n.q_.set("Online")})}function xO(n){return w(this,null,function*(){n.N_.forEach((e,t)=>{Rm(n,e)})})}function MO(n,e){return w(this,null,function*(){YI(n),Dm(n)?(n.q_.M_(e),Pm(n)):n.q_.set("Unknown")})}function VO(n,e,t){return w(this,null,function*(){if(n.q_.set("Online"),e instanceof bl&&e.state===2&&e.cause)try{yield function(i,s){return w(this,null,function*(){let o=s.cause;for(let c of s.targetIds)i.N_.has(c)&&(yield i.remoteSyncer.rejectListen(c,o),i.N_.delete(c),i.Q_.removeTarget(c))})}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield cI(n,r)}else if(e instanceof Pi?n.Q_.Ke(e):e instanceof Tl?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Y.min()))try{let r=yield WI(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let c=s.Q_.rt(o);return c.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){let f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,o))}}),c.targetMismatches.forEach((l,u)=>{let f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(tt.EMPTY_BYTE_STRING,f.snapshotVersion)),QI(s,l);let p=new Ko(f.target,l,u,f.sequenceNumber);Rm(s,p)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){U("RemoteStore","Failed to raise snapshot:",r),yield cI(n,r)}})}function cI(n,e,t){return w(this,null,function*(){if(!Zo(e))throw e;n.L_.add(1),yield ea(n),n.q_.set("Offline"),t||(t=()=>WI(n.localStore)),n.asyncQueue.enqueueRetryable(()=>w(this,null,function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Gl(n)}))})}function lI(n,e){return w(this,null,function*(){let t=ie(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");let r=ta(t);t.L_.add(3),yield ea(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Gl(t)})}function LO(n,e){return w(this,null,function*(){let t=ie(n);e?(t.L_.delete(2),yield Gl(t)):e||(t.L_.add(2),yield ea(t),t.q_.set("Unknown"))})}function Wi(n){return n.K_||(n.K_=function(t,r,i){let s=ie(t);return s.w_(),new Jp(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:OO.bind(null,n),Ro:xO.bind(null,n),mo:MO.bind(null,n),d_:VO.bind(null,n)}),n.B_.push(e=>w(this,null,function*(){e?(n.K_.s_(),Dm(n)?Pm(n):n.q_.set("Unknown")):(yield n.K_.stop(),YI(n))}))),n.K_}var tm=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Jn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function JI(n,e){if(An("AsyncQueue",`${e}: ${n}`),Zo(n))return new j(x.UNAVAILABLE,`${e}: ${n}`);throw n}var Dl=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||q.comparator(t.key,r.key):(t,r)=>q.comparator(t.key,r.key),this.keyedMap=Mo(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Nl=class{constructor(){this.W_=new Pe(q.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):H():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},zi=class n{constructor(e,t,r,i,s,o,c,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,Dl.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ql(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var nm=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},rm=class{constructor(){this.queries=uI(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=ie(t),s=i.queries;i.queries=uI(),s.forEach((o,c)=>{for(let l of c.j_)l.onError(r)})})(this,new j(x.ABORTED,"Firestore shutting down"))}};function uI(){return new Zn(n=>PI(n),ql)}function FO(n,e){return w(this,null,function*(){let t=ie(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new nm,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let c=JI(o,`Initialization of query '${Ci(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Nm(t)})}function UO(n,e){return w(this,null,function*(){let t=ie(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function BO(n,e){let t=ie(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.j_)c.X_(i)&&(r=!0);o.z_=i}}r&&Nm(t)}function jO(n,e,t){let r=ie(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Nm(n){n.Y_.forEach(e=>{e.next()})}var im,hI;(hI=im||(im={})).ea="default",hI.Cache="cache";var sm=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new zi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=zi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==im.Cache}};var kl=class{constructor(e){this.key=e}},Ol=class{constructor(e){this.key=e}},om=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ae(),this.mutatedKeys=ae(),this.Aa=DI(e),this.Ra=new Dl(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Nl,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{let g=i.get(f),T=zl(this.query,p)?p:null,S=!!g&&this.mutatedKeys.has(g.key),D=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations),P=!1;g&&T?g.data.isEqual(T.data)?S!==D&&(r.track({type:3,doc:T}),P=!0):this.ga(g,T)||(r.track({type:2,doc:T}),P=!0,(l&&this.Aa(T,l)>0||u&&this.Aa(T,u)<0)&&(c=!0)):!g&&T?(r.track({type:0,doc:T}),P=!0):g&&!T&&(r.track({type:1,doc:g}),P=!0,(l||u)&&(c=!0)),P&&(T?(o=o.add(T),s=D?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((f,p)=>function(T,S){let D=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return D(T)-D(S)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(r),i=i!=null&&i;let c=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new zi(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Nl,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ae(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Ol(r))}),this.da.forEach(r=>{e.has(r)||t.push(new kl(r))}),t}ba(e){this.Ta=e.Ts,this.da=ae();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return zi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},am=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},cm=class{constructor(e){this.key=e,this.va=!1}},lm=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Zn(c=>PI(c),ql),this.Ma=new Map,this.xa=new Set,this.Oa=new Pe(q.comparator),this.Na=new Map,this.La=new Yo,this.Ba={},this.ka=new Map,this.qa=Qo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function $O(n,e,t=!0){return w(this,null,function*(){let r=nT(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield XI(r,e,t,!0),i})}function qO(n,e){return w(this,null,function*(){let t=nT(n);yield XI(t,e,!0,!1)})}function XI(n,e,t,r){return w(this,null,function*(){let i=yield DO(n.localStore,ln(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield zO(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&KI(n.remoteStore,i),c})}function zO(n,e,t,r,i){return w(this,null,function*(){n.Ka=(p,g,T)=>function(D,P,M,$){return w(this,null,function*(){let B=P.view.ma(M);B.ns&&(B=yield aI(D.localStore,P.query,!1).then(({documents:I})=>P.view.ma(I,B)));let F=$&&$.targetChanges.get(P.targetId),pe=$&&$.targetMismatches.get(P.targetId)!=null,K=P.view.applyChanges(B,D.isPrimaryClient,F,pe);return fI(D,P.targetId,K.wa),K.snapshot})}(n,p,g,T);let s=yield aI(n.localStore,e,!0),o=new om(e,s.Ts),c=o.ma(s.documents),l=Ho.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(c,n.isPrimaryClient,l);fI(n,t,u.wa);let f=new am(e,t,o);return n.Fa.set(e,f),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot})}function GO(n,e,t){return w(this,null,function*(){let r=ie(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!ql(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Gp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Sm(r.remoteStore,i.targetId),um(r,i.targetId)}).catch(wm))):(um(r,i.targetId),yield Gp(r.localStore,i.targetId,!0))})}function WO(n,e){return w(this,null,function*(){let t=ie(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Sm(t.remoteStore,r.targetId))})}function ZI(n,e){return w(this,null,function*(){let t=ie(n);try{let r=yield RO(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(Re(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Re(o.va):i.removedDocuments.size>0&&(Re(o.va),o.va=!1))}),yield tT(t,r,e)}catch(r){yield wm(r)}})}function dI(n,e,t){let r=ie(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let c=o.view.Z_(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){let l=ie(o);l.onlineState=c;let u=!1;l.queries.forEach((f,p)=>{for(let g of p.j_)g.Z_(c)&&(u=!0)}),u&&Nm(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function HO(n,e,t){return w(this,null,function*(){let r=ie(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new Pe(q.comparator);o=o.insert(s,Wt.newNoDocument(s,Y.min()));let c=ae().add(s),l=new Il(Y.min(),new Map,new Pe(he),o,c);yield ZI(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),km(r)}else yield Gp(r.localStore,e,!1).then(()=>um(r,e,t)).catch(wm)})}function um(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||eT(n,r)})}function eT(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Sm(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),km(n))}function fI(n,e,t){for(let r of t)r instanceof kl?(n.La.addReference(r.key,e),KO(n,r)):r instanceof Ol?(U("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||eT(n,r.key)):H()}function KO(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(U("SyncEngine","New document in limbo: "+t),n.xa.add(r),km(n))}function km(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new q(Me.fromString(e)),r=n.qa.next();n.Na.set(r,new cm(t)),n.Oa=n.Oa.insert(t,r),KI(n.remoteStore,new Ko(ln(Am(t.path)),r,"TargetPurposeLimboResolution",EI.oe))}}function tT(n,e,t){return w(this,null,function*(){let r=ie(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((c,l)=>{o.push(r.Ka(l,e,t).then(u=>{var f;if((u||t)&&r.isPrimaryClient){let p=u?!u.fromCache:(f=t?.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);let p=jp.Wi(l.targetId,u);s.push(p)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(l,u){return w(this,null,function*(){let f=ie(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>N.forEach(u,g=>N.forEach(g.$i,T=>f.persistence.referenceDelegate.addReference(p,g.targetId,T)).next(()=>N.forEach(g.Ui,T=>f.persistence.referenceDelegate.removeReference(p,g.targetId,T)))))}catch(p){if(!Zo(p))throw p;U("LocalStore","Failed to update sequence numbers: "+p)}for(let p of u){let g=p.targetId;if(!p.fromCache){let T=f.os.get(g),S=T.snapshotVersion,D=T.withLastLimboFreeSnapshotVersion(S);f.os=f.os.insert(g,D)}}})}(r.localStore,s))})}function QO(n,e){return w(this,null,function*(){let t=ie(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());let r=yield GI(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(c=>{c.forEach(l=>{l.reject(new j(x.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield tT(t,r.hs)}})}function YO(n,e){let t=ie(n),r=t.Na.get(e);if(r&&r.va)return ae().add(r.key);{let i=ae(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let c=t.Fa.get(o);i=i.unionWith(c.view.Va)}return i}}function nT(n){let e=ie(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ZI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HO.bind(null,e),e.Ca.d_=BO.bind(null,e.eventManager),e.Ca.$a=jO.bind(null,e.eventManager),e}var pI=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return w(this,null,function*(){this.serializer=HI(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return SO(this.persistence,new qp,t.initialUser,this.serializer)}Ga(t){return new Fp(Bp.Zr,this.serializer)}Wa(t){return new Wp}terminate(){return w(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var JO=(()=>{class n{initialize(t,r){return w(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>dI(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=QO.bind(null,this.syncEngine),yield LO(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new rm}()}createDatastore(t){let r=HI(t.databaseInfo.databaseId),i=function(o){return new Qp(o)}(t.databaseInfo);return function(o,c,l,u){return new Xp(o,c,l,u)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,c,l){return new em(i,s,o,c,l)}(this.localStore,this.datastore,t.asyncQueue,r=>dI(this.syncEngine,r,0),function(){return Rl.D()?new Rl:new Hp}())}createSyncEngine(t,r){return function(s,o,c,l,u,f,p){let g=new lm(s,o,c,l,u,f);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return w(this,null,function*(){var t,r;yield function(s){return w(this,null,function*(){let o=ie(s);U("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield ea(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var hm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):An("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var dm=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=je.UNAUTHENTICATED,this.clientId=Zf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>w(this,null,function*(){U("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(U("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Jn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>w(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=JI(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Gf(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>w(this,null,function*(){r.isEqual(i)||(yield GI(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function mI(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield XO(n);U("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>lI(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>lI(e.remoteStore,i)),n._onlineComponents=e})}function XO(n){return w(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Gf(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===x.FAILED_PRECONDITION||i.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Oi("Error using user provided cache. Falling back to memory cache: "+t),yield Gf(n,new pI)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield Gf(n,new pI);return n._offlineComponents})}function ZO(n){return w(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield mI(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield mI(n,new JO))),n._onlineComponents})}function gI(n){return w(this,null,function*(){let e=yield ZO(n),t=e.eventManager;return t.onListen=$O.bind(null,e.syncEngine),t.onUnlisten=GO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=WO.bind(null,e.syncEngine),t})}function rT(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var _I=new Map;function ex(n,e,t){if(!t)throw new j(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function tx(n,e,t,r){if(e===!0&&r===!0)throw new j(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function yI(n){if(q.isDocumentKey(n))throw new j(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function nx(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H()}function pl(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new j(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=nx(n);throw new j(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var xl=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new j(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new j(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new j(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new j(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new j(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Jo=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xl({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new j(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xl(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Wf;switch(r.type){case"firstParty":return new Yf(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new j(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return w(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=_I.get(t);r&&(U("ComponentProvider","Removing Datastore"),_I.delete(t),r.terminate())}(this),Promise.resolve()}};function iT(n,e,t,r={}){var i;let s=(n=pl(n,Jo))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let c,l;if(typeof r.mockUserToken=="string")c=r.mockUserToken,l=je.MOCK_USER;else{c=mi(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new j(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new je(u)}n._authCredentials=new Hf(new ml(c,l))}}var Ml=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},xr=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Ni=class n extends Ml{constructor(e,t,r){super(e,t,Am(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xr(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function sT(n,e,...t){if(n=Be(n),ex("collection","path",e),n instanceof Jo){let r=Me.fromString(e,...t);return yI(r),new Ni(n,null,r)}{if(!(n instanceof xr||n instanceof Ni))throw new j(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Me.fromString(e,...t));return yI(r),new Ni(n.firestore,null,r)}}var Vl=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Pl(this,"async_queue_retry"),this.Vu=()=>{let r=zf();r&&U("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=zf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=zf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Jn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return w(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Zo(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(r);throw An("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=tm.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&H()}verifyOperationInProgress(){}wu(){return w(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function vI(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Xo=class extends Jo{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Vl,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return w(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Vl(e),this._firestoreClient=void 0,yield e}})}};function oT(n,e){let t=typeof n=="object"?n:_t(),r=typeof n=="string"?n:e||"(default)",i=gt(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Gn("firestore");s&&iT(i,...s)}return i}function rx(n){if(n._terminated)throw new j(x.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ix(n),n._firestoreClient}function ix(n){var e,t,r;let i=n._freezeSettings(),s=function(c,l,u,f){return new np(c,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,rT(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new dm(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}var fm=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(tt.fromBase64String(e))}catch(t){throw new j(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ll=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new j(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var pm=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new j(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new j(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}};var mm=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var sx=new RegExp("[~\\*/\\[\\]]");function ox(n,e,t){if(e.search(sx)>=0)throw wI(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ll(...e.split("."))._internalPath}catch{throw wI(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function wI(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new j(x.INVALID_ARGUMENT,c+n+l)}var Fl=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new gm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(aT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},gm=class extends Fl{data(){return super.data()}};function aT(n,e){return typeof e=="string"?ox(n,e):e instanceof Ll?e._internalPath:e._delegate._internalPath}function ax(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new j(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _m=class{convertValue(e,t="none"){switch(Or(e)){case 0:return null;case 1:return e.booleanValue;case 2:return be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return $l(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>be(o.doubleValue));return new mm(s)}convertGeoPoint(e){return new pm(be(e.latitude),be(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Im(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(jo(e));default:return null}}convertTimestamp(e){let t=Sn(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Me.fromString(e);Re(zI(r));let i=new wl(r.get(1),r.get(3)),s=new q(r.popFirst(5));return i.isEqual(t)||An(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var Dr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ul=class extends Fl{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ki(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(aT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ki=class extends Ul{data(e={}){return super.data(e)}},ym=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Dr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ki(this._firestore,this._userDataWriter,r.key,r,new Dr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new j(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{let l=new ki(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Dr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new ki(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Dr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,f=-1;return c.type!==0&&(u=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:cx(c.type),doc:l,oldIndex:u,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function cx(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}var Bl=class extends _m{constructor(e){super(),this.firestore=e}convertBytes(e){return new fm(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xr(this.firestore,null,t)}};function Om(n,...e){var t,r,i;n=Be(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||vI(e[o])||(s=e[o],o++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(vI(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,u,f;if(n instanceof xr)u=pl(n.firestore,Xo),f=Am(n._key.path),l={next:p=>{e[o]&&e[o](lx(u,n,p))},error:e[o+1],complete:e[o+2]};else{let p=pl(n,Ml);u=pl(p.firestore,Xo),f=p._query;let g=new Bl(u);l={next:T=>{e[o]&&e[o](new ym(u,g,p,T))},error:e[o+1],complete:e[o+2]},ax(n._query)}return function(g,T,S,D){let P=new hm(D),M=new sm(T,P,S);return g.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return FO(yield gI(g),M)})),()=>{P.Za(),g.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return UO(yield gI(g),M)}))}}(rx(u),f,c,l)}function lx(n,e,t){let r=t.docs.get(e._key),i=new Bl(n);return new Ul(n,i,e._key,r,new Dr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Gi=i})(ct),He(new ke("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new Xo(new Kf(r.getProvider("auth-internal")),new Xf(r.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new j(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wl(u.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),J(jE,"4.7.3",e),J(jE,"4.7.3","esm2017")})();var Wl=function(){return Wl=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Wl.apply(this,arguments)};var dx={includeMetadataChanges:!1};function cT(n,e){return e===void 0&&(e=dx),new Ln(function(t){var r=Om(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function lT(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Wl(Wl({},r),(t={},t[e.idField]=n.id,t))}function uT(n){return cT(n,{includeMetadataChanges:!0}).pipe(ee(function(e){return e.docs}))}function hT(n,e){return e===void 0&&(e={}),uT(n).pipe(ee(function(t){return t.map(function(r){return lT(r,e)})}))}var Mr=class{constructor(e){return e}},dT="firestore",xm=class{constructor(){return qt(dT)}};var Mm=new W("angularfire2.firestore-instances");function fx(n,e){let t=sn(dT,n,e);return t&&new Mr(t)}function px(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Mr(r)}}var mx={provide:xm,deps:[[new de,Mm]]},gx={provide:Mr,useFactory:fx,deps:[[new de,Mm],lt]};function fT(n,...e){return J("angularfire",yt.full,"fst"),Ne([gx,mx,{provide:Mm,useFactory:px(n),multi:!0,deps:[ve,at,Ot,vt,[new de,zt],[new de,kt],...e]}])}var pT=ut(hT,!0);var mT=ut(sT,!0);var gT=ut(oT,!0);var Hl=class n{firestore=L(Mr);constructor(){}getQuestions(){return pT(mT(this.firestore,"questions"))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})};function _x(n,e){if(n&1&&(ue(0,"div",9)(1,"div"),Ie(2),le()(),ue(3,"div",10)(4,"div"),Ie(5),le()()),n&2){let t=yn().$implicit;Jt(2),gh(t.frage),Jt(3),gh(t.antwort)}}function yx(n,e){if(n&1&&fh(0,_x,6,2),n&2){let t=e.$implicit,r=yn(2);Ya(r.i==t.id&&r.counter.length!=r.questions.length?0:-1)}}function vx(n,e){if(n&1){let t=mh();ue(0,"div",0)(1,"div")(2,"h3",1),Ie(3,"Quiz f\xFCr Jilly"),le()(),ue(4,"div",2)(5,"div",3),Ct("click",function(){Jr(t);let i=yn();return Xr(i.toggleFlip())}),Uy(6,yx,1,1,null,null,Fy),le()(),ue(8,"div",4)(9,"p"),Ie(10),le(),ue(11,"button",5),Ct("click",function(){Jr(t);let i=yn();return Xr(i.next())}),Ie(12,"gewusst"),le(),ue(13,"button",6),Ct("click",function(){Jr(t);let i=yn();return Xr(i.again(i.i))}),Ie(14,"nochmal"),le(),ue(15,"button",7),Ct("click",function(){Jr(t);let i=yn();return Xr(i.restart())}),Ie(16,"Neu starten"),le()(),ze(17,"div",8),le()}if(n&2){let t=yn();Jt(5),Ly("@flipState",t.flip),Jt(),By(t.questions),Jt(4),jy("Frage ",t.counter.length," von 30")}}function wx(n,e){if(n&1){let t=mh();ue(0,"div",0)(1,"div")(2,"h3",1),Ie(3,"Quiz f\xFCr Jilly"),le()(),ue(4,"div",11)(5,"p"),Ie(6,"Starte das Quiz"),le(),ue(7,"button",7),Ct("click",function(){Jr(t);let i=yn();return Xr(i.start())}),Ie(8,"Start"),le()()()}}var Kl=class n{constructor(){this.firestoreService.getQuestions().subscribe(e=>{console.log("data",e),this.questions=e}),this.flip="inactive",this.i=this.getRandomUniqueNumber(),this.counter.push(this.i)}started=!1;answer;score=0;firestoreService=L(Hl);questions;i;counter=[];flip="inactive";restart(){this.counter=[],this.i=this.getRandomUniqueNumber(),this.counter.push(this.i)}toggleFlip(){this.flip=this.flip=="inactive"?"active":"inactive"}getRandomUniqueNumber(){if(this.counter.length>=30)throw new Error("All numbers have been used.");let e;do e=Math.floor(Math.random()*30)+1;while(this.counter.includes(e));return e}start(){this.started=!0}next(){if(console.log("next",this.i),console.log("counter",this.counter),this.counter.length>=30)return;let e;do e=Math.floor(Math.random()*30)+1;while(this.counter.includes(e));this.counter.push(e),this.i=e,this.flip==="active"&&this.toggleFlip()}again(e){console.log("again",e),this.counter.splice(this.counter.indexOf(e),1),this.flip==="inactive"&&this.toggleFlip(),this.next()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=bt({type:n,selectors:[["app-quiz"]],standalone:!0,features:[At],decls:2,vars:2,consts:[[1,"question-box"],[1,"header"],[1,"tp-wrapper"],[1,"tp-box",3,"click"],[1,"button-menu"],[2,"background-color","green",3,"click"],[2,"background-color","red",3,"click"],[3,"click"],[2,"text-align","center"],[1,"tp-box__side","tp-box__front"],[1,"tp-box__side","tp-box__back"],[1,"start"]],template:function(t,r){t&1&&fh(0,vx,18,2,"div",0)(1,wx,9,0,"div",0),t&2&&(Ya(r.started?0:-1),Jt(),Ya(r.started?-1:1))},dependencies:[Th],styles:["h3[_ngcontent-%COMP%]{text-align:center}.start[_ngcontent-%COMP%]{text-align:center;margin-top:2em}.tp-box[_ngcontent-%COMP%]{position:relative;width:80%;height:50vh;margin:3rem auto;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-transform:transform 1s;-ms-transform:transform 1s;transform:transform 1s}.tp-box__side[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;color:#fff;font-size:24px;font-weight:700;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tp-box__side[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:1em}.tp-box__front[_ngcontent-%COMP%]{background:green;-webkit-transform:rotateY(0deg);-ms-transform:rotateY(0deg);transform:rotateY(0)}.tp-box__back[_ngcontent-%COMP%]{background:#23262d;-webkit-transform:rotateY(-180deg);-ms-transform:rotateY(-180deg);transform:rotateY(-180deg)}.button-menu[_ngcontent-%COMP%]{margin:0 auto;width:50%;display:flex;justify-content:space-between;align-items:center}.button-menu[_ngcontent-%COMP%]:last-child{margin-top:2em}button[_ngcontent-%COMP%]{background:#23262d;color:#fff;border:none;padding:.5rem 1rem;font-size:1rem;cursor:pointer;margin:1rem;border-radius:5px;transition:all .3s}"],data:{animation:[Yy("flipState",[Ah("active",Ch({transform:"rotateY(179deg)"})),Ah("inactive",Ch({transform:"rotateY(0)"})),Sh("active => inactive",bh("500ms ease-out")),Sh("inactive => active",bh("500ms ease-in"))])]}})};var bT=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(Se(Qa),Se(Ka))},e.\u0275dir=Ut({type:e});let n=e;return n})(),Ex=(()=>{let e=class e extends bT{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Os(e)))(s||e)}})(),e.\u0275dir=Ut({type:e,features:[ur]});let n=e;return n})(),CT=new W("");var Ix={provide:CT,useExisting:Ga(()=>nu),multi:!0};function Tx(){let n=ti()?ti().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var bx=new W(""),nu=(()=>{let e=class e extends bT{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Tx())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(Se(Qa),Se(Ka),Se(bx,8))},e.\u0275dir=Ut({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Ct("input",function(c){return s._handleInput(c.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(c){return s._compositionEnd(c.target.value)})},features:[Ja([Ix]),ur]});let n=e;return n})();var AT=new W(""),ST=new W("");function RT(n){return n!=null}function PT(n){return Za(n)?Xe(n):n}function DT(n){let e={};return n.forEach(t=>{e=t!=null?V(V({},e),t):e}),Object.keys(e).length===0?null:e}function NT(n,e){return e.map(t=>t(n))}function Cx(n){return!n.validate}function kT(n){return n.map(e=>Cx(e)?e:t=>e.validate(t))}function Ax(n){if(!n)return null;let e=n.filter(RT);return e.length==0?null:function(t){return DT(NT(t,e))}}function Lm(n){return n!=null?Ax(kT(n)):null}function Sx(n){if(!n)return null;let e=n.filter(RT);return e.length==0?null:function(t){let r=NT(t,e).map(PT);return Cy(r).pipe(ee(DT))}}function Fm(n){return n!=null?Sx(kT(n)):null}function _T(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Rx(n){return n._rawValidators}function Px(n){return n._rawAsyncValidators}function Vm(n){return n?Array.isArray(n)?n:[n]:[]}function Yl(n,e){return Array.isArray(n)?n.includes(e):n===e}function yT(n,e){let t=Vm(e);return Vm(n).forEach(i=>{Yl(t,i)||t.push(i)}),t}function vT(n,e){return Vm(e).filter(t=>!Yl(n,t))}var Jl=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Lm(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Fm(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Qi=class extends Jl{get formDirective(){return null}get path(){return null}},aa=class extends Jl{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Xl=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Dx={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Gj=_e(V({},Dx),{"[class.ng-submitted]":"isSubmitted"}),OT=(()=>{let e=class e extends Xl{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Se(aa,2))},e.\u0275dir=Ut({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&ph("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[ur]});let n=e;return n})(),xT=(()=>{let e=class e extends Xl{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(Se(Qi,10))},e.\u0275dir=Ut({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&ph("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[ur]});let n=e;return n})();var na="VALID",Ql="INVALID",Hi="PENDING",ra="DISABLED",Yi=class{},Zl=class extends Yi{constructor(e,t){super(),this.value=e,this.source=t}},sa=class extends Yi{constructor(e,t){super(),this.pristine=e,this.source=t}},oa=class extends Yi{constructor(e,t){super(),this.touched=e,this.source=t}},Ki=class extends Yi{constructor(e,t){super(),this.status=e,this.source=t}};function MT(n){return(ru(n)?n.validators:n)||null}function Nx(n){return Array.isArray(n)?Lm(n):n||null}function VT(n,e){return(ru(e)?e.asyncValidators:n)||null}function kx(n){return Array.isArray(n)?Fm(n):n||null}function ru(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function Ox(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ye(1e3,"");if(!r[t])throw new ye(1001,"")}function xx(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ye(1002,"")})}var eu=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Bs(()=>this.statusReactive()),this.statusReactive=Vs(void 0),this._pristine=Bs(()=>this.pristineReactive()),this.pristineReactive=Vs(!0),this._touched=Bs(()=>this.touchedReactive()),this.touchedReactive=Vs(!1),this._events=new gn,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Bn(this.statusReactive)}set status(e){Bn(()=>this.statusReactive.set(e))}get valid(){return this.status===na}get invalid(){return this.status===Ql}get pending(){return this.status==Hi}get disabled(){return this.status===ra}get enabled(){return this.status!==ra}get pristine(){return Bn(this.pristineReactive)}set pristine(e){Bn(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return Bn(this.touchedReactive)}set touched(e){Bn(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(yT(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(yT(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(vT(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(vT(e,this._rawAsyncValidators))}hasValidator(e){return Yl(this._rawValidators,e)}hasAsyncValidator(e){return Yl(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(_e(V({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new oa(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new oa(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(_e(V({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new sa(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new sa(!0,r))}markAsPending(e={}){this.status=Hi;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ki(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(_e(V({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=ra,this.errors=null,this._forEachChild(i=>{i.disable(_e(V({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Zl(this.value,r)),this._events.next(new Ki(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(_e(V({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=na,this._forEachChild(r=>{r.enable(_e(V({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(_e(V({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===na||this.status===Hi)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Zl(this.value,t)),this._events.next(new Ki(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(_e(V({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ra:na}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Hi,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=PT(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Ki(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Yt,this.statusChanges=new Yt}_calculateStatus(){return this._allControlsDisabled()?ra:this.errors?Ql:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Hi)?Hi:this._anyControlsHaveStatus(Ql)?Ql:na}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new sa(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new oa(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ru(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Nx(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=kx(this._rawAsyncValidators)}},tu=class extends eu{constructor(e,t,r){super(MT(t),VT(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){xx(this,!0,e),Object.keys(e).forEach(r=>{Ox(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Um=new W("CallSetDisabledState",{providedIn:"root",factory:()=>Bm}),Bm="always";function Mx(n,e){return[...e.path,n]}function LT(n,e,t=Bm){FT(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),Lx(n,e),Ux(n,e),Fx(n,e),Vx(n,e)}function wT(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Vx(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function FT(n,e){let t=Rx(n);e.validator!==null?n.setValidators(_T(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Px(n);e.asyncValidator!==null?n.setAsyncValidators(_T(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();wT(e._rawValidators,i),wT(e._rawAsyncValidators,i)}function Lx(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&UT(n,e)})}function Fx(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&UT(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function UT(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Ux(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function Bx(n,e){n==null,FT(n,e)}function jx(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function $x(n){return Object.getPrototypeOf(n.constructor)===Ex}function qx(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function zx(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===nu?t=s:$x(s)?r=s:i=s}),i||r||t||null}var Gx={provide:Qi,useExisting:Ga(()=>jm)},ia=Promise.resolve(),jm=(()=>{let e=class e extends Qi{get submitted(){return Bn(this.submittedReactive)}constructor(r,i,s){super(),this.callSetDisabledState=s,this._submitted=Bs(()=>this.submittedReactive()),this.submittedReactive=Vs(!1),this._directives=new Set,this.ngSubmit=new Yt,this.form=new tu({},Lm(r),Fm(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){ia.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),LT(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){ia.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){ia.then(()=>{let i=this._findContainer(r.path),s=new tu({});Bx(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){ia.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){ia.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submittedReactive.set(!0),qx(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(Se(AT,10),Se(ST,10),Se(Um,8))},e.\u0275dir=Ut({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&Ct("submit",function(c){return s.onSubmit(c)})("reset",function(){return s.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ja([Gx]),ur]});let n=e;return n})();function ET(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function IT(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Wx=class extends eu{constructor(e=null,t,r){super(MT(t),VT(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ru(t)&&(t.nonNullable||t.initialValueIsDefault)&&(IT(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){ET(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){ET(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){IT(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Hx={provide:aa,useExisting:Ga(()=>$m)},TT=Promise.resolve(),$m=(()=>{let e=class e extends aa{constructor(r,i,s,o,c,l){super(),this._changeDetectorRef=c,this.callSetDisabledState=l,this.control=new Wx,this._registered=!1,this.name="",this.update=new Yt,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=zx(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),jx(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){LT(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){TT.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Ih(i);TT.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?Mx(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(Se(Qi,9),Se(AT,10),Se(ST,10),Se(CT,10),Se(Us,8),Se(Um,8))},e.\u0275dir=Ut({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ja([Hx]),ur,Wa]});let n=e;return n})(),BT=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ut({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let n=e;return n})();var Kx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=lr({type:e}),e.\u0275inj=cr({});let n=e;return n})();var jT=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:Um,useValue:r.callSetDisabledState??Bm}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=lr({type:e}),e.\u0275inj=cr({imports:[Kx]});let n=e;return n})();var iu=class n{constructor(e){this.router=e}login(){this.router.navigate(["quiz"])}email="";password="";static \u0275fac=function(t){return new(t||n)(Se(Rc))};static \u0275cmp=bt({type:n,selectors:[["app-login"]],standalone:!0,features:[At],decls:16,vars:2,consts:[[1,"login-container"],[1,"login-input"],["for","email"],["type","email","placeholder","e.g. john@doe.com","name","email",3,"ngModelChange","ngModel"],["for",""],["type","password","placeholder","your password","name","password",3,"ngModelChange","ngModel"],[1,"login-buttons"],["routerLink","/register"],[3,"click"]],template:function(t,r){t&1&&(ue(0,"div",0)(1,"h3"),Ie(2,"Login"),le(),ue(3,"div",1)(4,"form")(5,"label",2),Ie(6,"Email"),le(),ue(7,"input",3),vh("ngModelChange",function(s){return yh(r.email,s)||(r.email=s),s}),le(),ue(8,"label",4),Ie(9,"Password"),le(),ue(10,"input",5),vh("ngModelChange",function(s){return yh(r.password,s)||(r.password=s),s}),le()()(),ue(11,"div",6)(12,"button",7),Ie(13,"Need Account? Register"),le(),ue(14,"button",8),Ct("click",function(){return r.login()}),Ie(15,"Login"),le()()()),t&2&&(Jt(7),_h("ngModel",r.email),Jt(3),_h("ngModel",r.password))},dependencies:[jT,BT,nu,OT,xT,$m,jm],styles:[".login-container[_ngcontent-%COMP%]{padding-top:5em;display:flex;justify-content:center;flex-flow:column;align-items:center;width:20em;margin:0 auto}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:1em 2em;border-radius:10px;border:none;width:100%}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding:2em 0 1em}button[_ngcontent-%COMP%]{background:#23262d;color:#fff;border:none;padding:.5rem 1rem;font-size:1rem;cursor:pointer;margin:1rem;border-radius:5px;transition:all .3s}.login-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-flow:column}"]})};var $T=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:kc},{path:"quiz",component:Kl},{path:"login",component:iu}];var Yx=(()=>{let e=class e extends sc{constructor(r,i,s){super(r,i,s)}ngOnDestroy(){this.flush()}};e.\u0275fac=function(i){return new(i||e)(te(Ve),te($s),te(ic))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})();function Jx(){return new Xy}function Xx(n,e,t){return new ev(n,e,t)}var qT=[{provide:ic,useFactory:Jx},{provide:sc,useClass:Yx},{provide:Zr,useFactory:Xx,deps:[ni,sc,ve]}],Zx=[{provide:$s,useFactory:()=>new Zy},{provide:xs,useValue:"BrowserAnimations"},...qT],eM=[{provide:$s,useClass:Jy},{provide:xs,useValue:"NoopAnimations"},...qT];function zT(){return ei("NgEagerAnimations"),[...Zx]}function GT(){return[...eM]}var qm={production:!1,firebaseConfig:{apiKey:"AIzaSyANm9Hoed9oTRgtBfas56DUtFvOVgQmkdw",authDomain:"styffen-de.firebaseapp.com",projectId:"styffen-de",storageBucket:"styffen-de.appspot.com",messagingSenderId:"66303673365",appId:"1:66303673365:web:9cd80b5fb5ac861148ba1c",measurementId:"G-JN7CGR9WC3"}};var tM="@",nM=(()=>{let e=class e{constructor(r,i,s,o,c){this.doc=r,this.delegate=i,this.zone=s,this.animationType=o,this.moduleImpl=c,this._rendererFactoryPromise=null,this.scheduler=L(Oy,{optional:!0}),this.loadingSchedulerFn=L(rM,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let r=()=>this.moduleImpl??import("./chunk-2EQHS6NT.js").then(s=>s),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(r):i=r(),i.catch(s=>{throw new ye(5300,!1)}).then(({\u0275createEngine:s,\u0275AnimationRendererFactory:o})=>{this._engine=s(this.animationType,this.doc);let c=new o(this.delegate,this._engine,this.zone);return this.delegate=c,c})}createRenderer(r,i){let s=this.delegate.createRenderer(r,i);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let o=new zm(s);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(c=>{let l=c.createRenderer(r,i);o.use(l),this.scheduler?.notify(10)}).catch(c=>{o.use(s)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(i){dh()},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let n=e;return n})(),zm=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,r,i){this.delegate.insertBefore(e,t,r,i)}removeChild(e,t,r){this.delegate.removeChild(e,t,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(e,t,r)),this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.shouldReplay(t)&&this.replay.push(i=>i.listen(e,t,r)),this.delegate.listen(e,t,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(tM)}},rM=new W("");function WT(n="animations"){return ei("NgAsyncAnimations"),Ne([{provide:Zr,useFactory:(e,t,r)=>new nM(e,t,r,n),deps:[Ve,ni,ve]},{provide:xs,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var HT="@firebase/database",KT="1.0.8";var $g="";function iM(n){$g=n}var Xm=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ue(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:fi(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Zm=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return mt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Ab=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Xm(e)}}catch{}return new Zm},Lr=Ab("localStorage"),eg=Ab("sessionStorage");var es=new Dt("@firebase/database"),sM=function(){let n=1;return function(){return n++}}(),Sb=function(n){let e=Sw(n),t=new Oc;t.update(e);let r=t.digest();return xc.encodeByteArray(r)},wa=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=wa.apply(null,r):typeof r=="object"?e+=Ue(r):e+=r,e+=" "}return e},Fr=null,QT=!0,oM=function(n,e){O(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(es.logLevel=X.VERBOSE,Fr=es.log.bind(es),e&&eg.set("logging_enabled",!0)):typeof n=="function"?Fr=n:(Fr=null,eg.remove("logging_enabled"))},nt=function(...n){if(QT===!0&&(QT=!1,Fr===null&&eg.get("logging_enabled")===!0&&oM(!0)),Fr){let e=wa.apply(null,n);Fr(e)}},Ea=function(n){return function(...e){nt(n,...e)}},tg=function(...n){let e="FIREBASE INTERNAL ERROR: "+wa(...n);es.error(e)},Pn=function(...n){let e=`FIREBASE FATAL ERROR: ${wa(...n)}`;throw es.error(e),new Error(e)},wt=function(...n){let e="FIREBASE WARNING: "+wa(...n);es.warn(e)},aM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&wt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Rb=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},cM=function(n){if(en()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ns="[MIN_NAME]",Ur="[MAX_NAME]",ls=function(n,e){if(n===e)return 0;if(n===ns||e===Ur)return-1;if(e===ns||n===Ur)return 1;{let t=YT(n),r=YT(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},lM=function(n,e){return n===e?0:n<e?-1:1},ca=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Ue(e))},qg=function(n){if(typeof n!="object"||n===null)return Ue(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Ue(e[r]),t+=":",t+=qg(n[e[r]]);return t+="}",t},Pb=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Lt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var Db=function(n){O(!Rb(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,c,l;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(c=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=c+r,o=Math.round(n*Math.pow(2,t-c)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(l=t;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let f=u.join(""),p="";for(l=0;l<64;l+=8){let g=parseInt(f.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),p=p+g}return p.toLowerCase()},uM=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},hM=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var dM=new RegExp("^-?(0*)\\d{1,10}$"),fM=-2147483648,pM=2147483647,YT=function(n){if(dM.test(n)){let e=Number(n);if(e>=fM&&e<=pM)return e}return null},Ia=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw wt("Exception was thrown by user callback.",t),e},Math.floor(0))}},mM=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},fa=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var ng=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){wt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var rg=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(nt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',wt(e)}},pa=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),ou="5",Nb="v",kb="s",Ob="r",xb="f",Mb=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Vb="ls",Lb="p",ig="ac",Fb="websocket",Ub="long_polling";var au=class{constructor(e,t,r,i,s=!1,o="",c=!1,l=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Lr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Lr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function gM(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Bb(n,e,t){O(typeof e=="string","typeof type must == string"),O(typeof t=="object","typeof params must == object");let r;if(e===Fb)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Ub)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);gM(n)&&(t.ns=n.namespace);let i=[];return Lt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var sg=class{constructor(){this.counters_={}}incrementCounter(e,t=1){mt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return gw(this.counters_)}};var Gm={},Wm={};function zg(n){let e=n.toString();return Gm[e]||(Gm[e]=new sg),Gm[e]}function _M(n,e){let t=n.toString();return Wm[t]||(Wm[t]=e()),Wm[t]}var og=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Ia(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var JT="start",yM="close",vM="pLPCommand",wM="pRTLPCB",jb="id",$b="pw",qb="ser",EM="cb",IM="seg",TM="ts",bM="d",CM="dframe",zb=1870,Gb=30,AM=zb-Gb,SM=25e3,RM=3e4,ag=class n{constructor(e,t,r,i,s,o,c){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ea(e),this.stats_=zg(t),this.urlFn=l=>(this.appCheckToken&&(l[ig]=this.appCheckToken),Bb(t,Ub,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new og(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(RM)),cM(()=>{if(this.isClosed_)return;this.scriptTagHolder=new cg((...s)=>{let[o,c,l,u,f]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===JT)this.id=c,this.password=l;else if(o===yM)c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,c]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,c)},()=>{this.onClosed_()},this.urlFn);let r={};r[JT]="t",r[qb]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[EM]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Nb]=ou,this.transportSessionId&&(r[kb]=this.transportSessionId),this.lastSessionId&&(r[Vb]=this.lastSessionId),this.applicationId&&(r[Lb]=this.applicationId),this.appCheckToken&&(r[ig]=this.appCheckToken),typeof location<"u"&&location.hostname&&Mb.test(location.hostname)&&(r[Ob]=xb);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return en()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!uM()&&!hM()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Ue(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=Dd(t),i=Pb(r,AM);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(en())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[CM]="t",r[jb]=e,r[$b]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Ue(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},cg=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,en())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=sM(),window[vM+this.uniqueCallbackIdentifier]=e,window[wM+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(c){nt("frame writing exception"),c.stack&&nt(c.stack),nt(c)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||nt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[jb]=this.myID,e[$b]=this.myPW,e[qb]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Gb+r.length<=zb;){let o=this.pendingSegs.shift();r=r+"&"+IM+i+"="+o.seg+"&"+TM+i+"="+o.ts+"&"+bM+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(SM)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){en()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{nt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var PM=16384,DM=45e3,cu=null;typeof MozWebSocket<"u"?cu=MozWebSocket:typeof WebSocket<"u"&&(cu=WebSocket);var la=(()=>{class n{constructor(t,r,i,s,o,c,l){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ea(this.connId),this.stats_=zg(r),this.connURL=n.connectionURL_(r,c,l,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let c={};return c[Nb]=ou,!en()&&typeof location<"u"&&location.hostname&&Mb.test(location.hostname)&&(c[Ob]=xb),r&&(c[kb]=r),i&&(c[Vb]=i),s&&(c[ig]=s),o&&(c[Lb]=o),Bb(t,Fb,c)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Lr.set("previous_websocket_failure",!0);try{let i;if(en()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${ou}/${$g}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,c=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;c&&(i.proxy={origin:c})}this.mySock=new cu(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&cu!==null&&!n.forceDisallow_}static previouslyFailed(){return Lr.isInMemoryStorage||Lr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Lr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=fi(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(O(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Ue(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=Pb(r,PM);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(DM))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),NM=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ag,la]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=la&&la.isAvailable(),i=r&&!la.previouslyFailed();if(t.webSocketOnly&&(r||wt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[la];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),kM=6e4,OM=5e3,xM=10*1024,MM=100*1024,Hm="t",XT="d",VM="s",ZT="r",LM="e",eb="o",tb="a",nb="n",rb="p",FM="h",lg=class{constructor(e,t,r,i,s,o,c,l,u,f){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=c,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ea("c:"+this.id+":"),this.transportManager_=new NM(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=fa(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>MM?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xM?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Hm in e){let t=e[Hm];t===tb?this.upgradeIfSecondaryHealthy_():t===ZT?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===eb&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=ca("t",e),r=ca("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:rb,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:tb,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:nb,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=ca("t",e),r=ca("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=ca(Hm,e);if(XT in e){let r=e[XT];if(t===FM){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===nb){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===VM?this.onConnectionShutdown_(r):t===ZT?this.onReset_(r):t===LM?tg("Server Error: "+r):t===eb?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):tg("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ou!==r&&wt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),fa(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kM))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fa(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(OM))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:rb,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Lr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var lu=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var uu=class{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){O(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var hu=class n extends uu{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!vo()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var ib=32,sb=768,we=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function me(){return new we("")}function se(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function nr(n){return n.pieces_.length-n.pieceNum_}function Te(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new we(n.pieces_,e)}function Wb(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function UM(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Hb(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Kb(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new we(e,0)}function $e(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new we(t,0)}function ne(n){return n.pieceNum_>=n.pieces_.length}function Mt(n,e){let t=se(n),r=se(e);if(t===null)return e;if(t===r)return Mt(Te(n),Te(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Qb(n,e){if(nr(n)!==nr(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Kt(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(nr(n)>nr(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var ug=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Hb(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Io(this.parts_[r]);Yb(this)}};function BM(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Io(e),Yb(n)}function jM(n){let e=n.parts_.pop();n.byteLength_-=Io(e),n.parts_.length>0&&(n.byteLength_-=1)}function Yb(n){if(n.byteLength_>sb)throw new Error(n.errorPrefix_+"has a key path longer than "+sb+" bytes ("+n.byteLength_+").");if(n.parts_.length>ib)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ib+") or object contains a cycle "+Vr(n))}function Vr(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var hg=class n extends uu{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}};var ua=1e3,$M=60*5*1e3,ob=30*1e3,qM=1.3,zM=3e4,GM="server_kill",ab=3,Gg=(()=>{class n extends lu{constructor(t,r,i,s,o,c,l,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Ea("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ua,this.maxReconnectDelay_=$M,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!en())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");hg.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&hu.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Ue(o)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new gr,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:c=>{let l=c.d;c.s==="ok"?r.resolve(l):r.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,c=t._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),O(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(c).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},c="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(c,o,l=>{let u=l.d,f=l.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",l),f!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(f,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&mt(t,"w")){let i=yr(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();wt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Cw(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ob)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=bw(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,c=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),O(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},c="n";s&&(o.q=i,o.t=s),this.sendRequest(c,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let c={p:r,d:i};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:t,request:c,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Ue(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):tg("Unrecognized action received from server: "+Ue(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ua,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ua,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>zM&&(this.reconnectDelay_=ua),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*qM)}this.onConnectStatus_(!1)}establishConnection_(){return w(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,c=!1,l=null,u=function(){l?l.close():(c=!0,i())},f=function(g){O(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(g)};this.realtime_={close:u,sendRequest:f};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,T]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);c?nt("getToken() completed but was canceled"):(nt("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=T&&T.token,l=new lg(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,S=>{wt(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(GM)},o))}catch(g){this.log_("Failed to get token: "+g),c||(this.repoInfo_.nodeAdmin&&wt(g),u())}}})}interrupt(t){nt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){nt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],wo(this.interruptReasons_)&&(this.reconnectDelay_=ua,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>qg(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new we(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){nt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ab&&(this.reconnectDelay_=ob,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){nt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ab&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";en()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+$g.replace(/\./g,"-")]=1,vo()?t["framework.cordova"]=1:Vc()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=hu.getInstance().currentlyOnline();return wo(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),oe=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var rs=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new oe(ns,e),i=new oe(ns,t);return this.compare(r,i)!==0}minPost(){return oe.MIN}};var su,du=class extends rs{static get __EMPTY_NODE(){return su}static set __EMPTY_NODE(e){su=e}compare(e,t){return ls(e.name,t.name)}isDefinedOn(e){throw _r("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return oe.MIN}maxPost(){return new oe(Ur,su)}makePost(e,t){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new oe(e,su)}toString(){return".key"}},ts=new du;var Xi=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ht=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Vt.EMPTY_NODE,this.right=o??Vt.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Vt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),dg=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new Ht(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Vt=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Ht.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ht.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Xi(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Xi(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Xi(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Xi(this.root_,null,this.comparator_,!0,e)}};Vt.EMPTY_NODE=new dg;function WM(n,e){return ls(n.name,e.name)}function Wg(n,e){return ls(n,e)}var fg;function HM(n){fg=n}var Jb=function(n){return typeof n=="number"?"number:"+Db(n):"string:"+n},Xb=function(n){if(n.isLeafNode()){let e=n.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&mt(e,".sv"),"Priority must be a string or number.")}else O(n===fg||n.isEmpty(),"priority of unexpected type.");O(n===fg||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var cb,is=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Xb(this.priorityNode_)}static set __childrenNodeConstructor(t){cb=t}static get __childrenNodeConstructor(){return cb}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ne(t)?this:se(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=se(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(O(i!==".priority"||nr(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Te(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Jb(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=Db(this.value_):t+=this.value_,this.lazyHash_=Sb(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(O(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return O(s>=0,"Unknown leaf type: "+r),O(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Zb,eC;function KM(n){Zb=n}function QM(n){eC=n}var pg=class extends rs{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ls(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return oe.MIN}maxPost(){return new oe(Ur,new is("[PRIORITY-POST]",eC))}makePost(e,t){let r=Zb(e);return new oe(t,new is("[PRIORITY-POST]",r))}toString(){return".priority"}},it=new pg;var YM=Math.log(2),mg=class{constructor(e){let t=s=>parseInt(Math.log(s)/YM,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},fu=function(n,e,t,r){n.sort(e);let i=function(l,u){let f=u-l,p,g;if(f===0)return null;if(f===1)return p=n[l],g=t?t(p):p,new Ht(g,p.node,Ht.BLACK,null,null);{let T=parseInt(f/2,10)+l,S=i(l,T),D=i(T+1,u);return p=n[T],g=t?t(p):p,new Ht(g,p.node,Ht.BLACK,S,D)}},s=function(l){let u=null,f=null,p=n.length,g=function(S,D){let P=p-S,M=p;p-=S;let $=i(P+1,M),B=n[P],F=t?t(B):B;T(new Ht(F,B.node,D,null,$))},T=function(S){u?(u.left=S,u=S):(f=S,u=S)};for(let S=0;S<l.count;++S){let D=l.nextBitIsOne(),P=Math.pow(2,l.count-(S+1));D?g(P,Ht.BLACK):(g(P,Ht.BLACK),g(P,Ht.RED))}return f},o=new mg(n.length),c=s(o);return new Vt(r||e,c)};var Km,Ji={},ss=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return O(Ji&&it,"ChildrenNode.ts has not been loaded"),Km=Km||new n({".priority":Ji},{".priority":it}),Km}get(e){let t=yr(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Vt?t:null}hasIndex(e){return mt(this.indexSet_,e.toString())}addIndex(e,t){O(e!==ts,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(oe.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let c;i?c=fu(r,e.getCompare()):c=Ji;let l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;let f=Object.assign({},this.indexes_);return f[l]=c,new n(f,u)}addToIndexes(e,t){let r=Eo(this.indexes_,(i,s)=>{let o=yr(this.indexSet_,s);if(O(o,"Missing index implementation for "+s),i===Ji)if(o.isDefinedOn(e.node)){let c=[],l=t.getIterator(oe.Wrap),u=l.getNext();for(;u;)u.name!==e.name&&c.push(u),u=l.getNext();return c.push(e),fu(c,o.getCompare())}else return Ji;else{let c=t.get(e.name),l=i;return c&&(l=l.remove(new oe(e.name,c))),l.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Eo(this.indexes_,i=>{if(i===Ji)return i;{let s=t.get(e.name);return s?i.remove(new oe(e.name,s)):i}});return new n(r,this.indexSet_)}};var ha,Ce=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Xb(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ha||(ha=new n(new Vt(Wg),null,ss.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ha}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?ha:r}}getChild(t){let r=se(t);return r===null?this:this.getImmediateChild(r).getChild(Te(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(O(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new oe(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let c=s.isEmpty()?ha:this.priorityNode_;return new n(s,c,o)}}updateChild(t,r){let i=se(t);if(i===null)return r;{O(se(t)!==".priority"||nr(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Te(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(it,(c,l)=>{r[c]=l.val(t),i++,o&&n.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):o=!1}),!t&&o&&s<2*i){let c=[];for(let l in r)c[l]=r[l];return c}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+Jb(this.getPriority().val())+":"),this.forEachChild(it,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":Sb(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new oe(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new oe(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new oe(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,oe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,oe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ta?-1:0}withIndex(t){if(t===ts||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ts||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(it),s=r.getIterator(it),o=i.getNext(),c=s.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=i.getNext(),c=s.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(t){return t===ts?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),gg=class extends Ce{constructor(){super(new Vt(Wg),Ce.EMPTY_NODE,ss.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ce.EMPTY_NODE}isEmpty(){return!1}},Ta=new gg;Object.defineProperties(oe,{MIN:{value:new oe(ns,Ce.EMPTY_NODE)},MAX:{value:new oe(Ur,Ta)}});du.__EMPTY_NODE=Ce.EMPTY_NODE;is.__childrenNodeConstructor=Ce;HM(Ta);QM(Ta);var JM=!0;function rt(n,e=null){if(n===null)return Ce.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new is(t,rt(e))}if(!(n instanceof Array)&&JM){let t=[],r=!1;if(Lt(n,(o,c)=>{if(o.substring(0,1)!=="."){let l=rt(c);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),t.push(new oe(o,l)))}}),t.length===0)return Ce.EMPTY_NODE;let s=fu(t,WM,o=>o.name,Wg);if(r){let o=fu(t,it.getCompare());return new Ce(s,rt(e),new ss({".priority":o},{".priority":it}))}else return new Ce(s,rt(e),ss.Default)}else{let t=Ce.EMPTY_NODE;return Lt(n,(r,i)=>{if(mt(n,r)&&r.substring(0,1)!=="."){let s=rt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(rt(e))}}KM(rt);var _g=class extends rs{constructor(e){super(),this.indexPath_=e,O(!ne(e)&&se(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ls(e.name,t.name):s}makePost(e,t){let r=rt(e),i=Ce.EMPTY_NODE.updateChild(this.indexPath_,r);return new oe(t,i)}maxPost(){let e=Ce.EMPTY_NODE.updateChild(this.indexPath_,Ta);return new oe(Ur,e)}toString(){return Hb(this.indexPath_,0).join("/")}};var yg=class extends rs{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ls(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return oe.MIN}maxPost(){return oe.MAX}makePost(e,t){let r=rt(e);return new oe(t,r)}toString(){return".value"}},XM=new yg;function ZM(n){return{type:"value",snapshotNode:n}}function e1(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function t1(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function lb(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function n1(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var vg=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=it}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ns}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ur}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===it}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function ub(n){let e={};if(n.isDefault())return e;let t;if(n.index_===it?t="$priority":n.index_===XM?t="$value":n.index_===ts?t="$key":(O(n.index_ instanceof _g,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Ue(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Ue(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Ue(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Ue(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Ue(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function hb(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==it&&(e.i=n.index_.toString()),e}var wg=class n extends lu{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Ea("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),c={};this.listens_[o]=c;let l=ub(e._queryParams);this.restRequest_(s+".json",l,(u,f)=>{let p=f;if(u===404&&(p=null,u=null),u===null&&this.onDataUpdate_(s,p,!1,r),yr(this.listens_,o)===c){let g;u?u===401?g="permission_denied":g="rest_error:"+u:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=ub(e._queryParams),r=e._path.toString(),i=new gr;return this.restRequest_(r+".json",t,(s,o)=>{let c=o;s===404&&(c=null,s=null),s===null?(this.onDataUpdate_(r,c,!1,null),i.resolve(c)):i.reject(new Error(c))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+wr(t);this.log_("Sending REST request for "+o);let c=new XMLHttpRequest;c.onreadystatechange=()=>{if(r&&c.readyState===4){this.log_("REST Response for "+o+" received. status:",c.status,"response:",c.responseText);let l=null;if(c.status>=200&&c.status<300){try{l=fi(c.responseText)}catch{wt("Failed to parse JSON response for "+o+": "+c.responseText)}r(null,l)}else c.status!==401&&c.status!==404&&wt("Got unsuccessful REST response for "+o+" Status: "+c.status),r(c.status);r=null}},c.open("GET",o,!0),c.send()})}};var Eg=class{constructor(){this.rootNode_=Ce.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function pu(){return{value:null,children:new Map}}function tC(n,e,t){if(ne(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=se(e);n.children.has(r)||n.children.set(r,pu());let i=n.children.get(r);e=Te(e),tC(i,e,t)}}function Ig(n,e,t){n.value!==null?t(e,n.value):r1(n,(r,i)=>{let s=new we(e.toString()+"/"+r);Ig(i,s,t)})}function r1(n,e){n.children.forEach((t,r)=>{e(r,t)})}var Tg=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Lt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var db=10*1e3,i1=30*1e3,s1=5*60*1e3,bg=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Tg(e);let r=db+(i1-db)*Math.random();fa(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Lt(e,(i,s)=>{s>0&&mt(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),fa(this.reportStats_.bind(this),Math.floor(Math.random()*2*s1))}};var Rn=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Rn||{});function nC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function rC(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function iC(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var Cg=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Rn.ACK_USER_WRITE,this.source=nC()}operationForChild(e){if(ne(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new we(e));return new n(me(),t,this.revert)}}else return O(se(this.path)===e,"operationForChild called for unrelated child."),new n(Te(this.path),this.affectedTree,this.revert)}};var os=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Rn.OVERWRITE}operationForChild(e){return ne(this.path)?new n(this.source,me(),this.snap.getImmediateChild(e)):new n(this.source,Te(this.path),this.snap)}};var mu=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Rn.MERGE}operationForChild(e){if(ne(this.path)){let t=this.children.subtree(new we(e));return t.isEmpty()?null:t.value?new os(this.source,me(),t.value):new n(this.source,me(),t)}else return O(se(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Te(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var _a=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ne(e))return this.isFullyInitialized()&&!this.filtered_;let t=se(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function o1(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(n1(o.childName,o.snapshotNode))}),da(n,i,"child_removed",e,r,t),da(n,i,"child_added",e,r,t),da(n,i,"child_moved",s,r,t),da(n,i,"child_changed",e,r,t),da(n,i,"value",e,r,t),i}function da(n,e,t,r,i,s){let o=r.filter(c=>c.type===t);o.sort((c,l)=>c1(n,c,l)),o.forEach(c=>{let l=a1(n,c,s);i.forEach(u=>{u.respondsTo(c.type)&&e.push(u.createEvent(l,n.query_))})})}function a1(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function c1(n,e,t){if(e.childName==null||t.childName==null)throw _r("Should only compare child_ events.");let r=new oe(e.childName,e.snapshotNode),i=new oe(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function sC(n,e){return{eventCache:n,serverCache:e}}function ma(n,e,t,r){return sC(new _a(e,t,r),n.serverCache)}function oC(n,e,t,r){return sC(n.eventCache,new _a(e,t,r))}function Ag(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Br(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Qm,l1=()=>(Qm||(Qm=new Vt(lM)),Qm),ht=class n{constructor(e,t=l1()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Lt(e,(r,i)=>{t=t.set(new we(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:me(),value:this.value};if(ne(e))return null;{let r=se(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Te(e),t);return s!=null?{path:$e(new we(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ne(e))return this;{let t=se(e),r=this.children.get(t);return r!==null?r.subtree(Te(e)):new n(null)}}set(e,t){if(ne(e))return new n(t,this.children);{let r=se(e),s=(this.children.get(r)||new n(null)).set(Te(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(ne(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=se(e),r=this.children.get(t);if(r){let i=r.remove(Te(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ne(e))return this.value;{let t=se(e),r=this.children.get(t);return r?r.get(Te(e)):null}}setTree(e,t){if(ne(e))return t;{let r=se(e),s=(this.children.get(r)||new n(null)).setTree(Te(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(me(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_($e(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,me(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(ne(e))return null;{let s=se(e),o=this.children.get(s);return o?o.findOnPath_(Te(e),$e(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,me(),t)}foreachOnPath_(e,t,r){if(ne(e))return this;{this.value&&r(t,this.value);let i=se(e),s=this.children.get(i);return s?s.foreachOnPath_(Te(e),$e(t,i),r):new n(null)}}foreach(e){this.foreach_(me(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_($e(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Qt=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new ht(null))}};function ga(n,e,t){if(ne(e))return new Qt(new ht(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Mt(i,e);return s=s.updateChild(o,t),new Qt(n.writeTree_.set(i,s))}else{let i=new ht(t),s=n.writeTree_.setTree(e,i);return new Qt(s)}}}function fb(n,e,t){let r=n;return Lt(t,(i,s)=>{r=ga(r,$e(e,i),s)}),r}function pb(n,e){if(ne(e))return Qt.empty();{let t=n.writeTree_.setTree(e,new ht(null));return new Qt(t)}}function Sg(n,e){return jr(n,e)!=null}function jr(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Mt(t.path,e)):null}function mb(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(it,(r,i)=>{e.push(new oe(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new oe(r,i.value))}),e}function tr(n,e){if(ne(e))return n;{let t=jr(n,e);return t!=null?new Qt(new ht(t)):new Qt(n.writeTree_.subtree(e))}}function Rg(n){return n.writeTree_.isEmpty()}function as(n,e){return aC(me(),n.writeTree_,e)}function aC(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(O(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=aC($e(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild($e(n,".priority"),r)),t}}function cC(n,e){return fC(e,n)}function u1(n,e,t,r,i){O(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=ga(n.visibleWrites,e,t)),n.lastWriteId=r}function h1(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function d1(n,e){let t=n.allWrites.findIndex(c=>c.writeId===e);O(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let c=n.allWrites[o];c.visible&&(o>=t&&f1(c,r.path)?i=!1:Kt(r.path,c.path)&&(s=!0)),o--}if(i){if(s)return p1(n),!0;if(r.snap)n.visibleWrites=pb(n.visibleWrites,r.path);else{let c=r.children;Lt(c,l=>{n.visibleWrites=pb(n.visibleWrites,$e(r.path,l))})}return!0}else return!1}function f1(n,e){if(n.snap)return Kt(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Kt($e(n.path,t),e))return!0;return!1}function p1(n){n.visibleWrites=lC(n.allWrites,m1,me()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function m1(n){return n.visible}function lC(n,e,t){let r=Qt.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,c;if(s.snap)Kt(t,o)?(c=Mt(t,o),r=ga(r,c,s.snap)):Kt(o,t)&&(c=Mt(o,t),r=ga(r,me(),s.snap.getChild(c)));else if(s.children){if(Kt(t,o))c=Mt(t,o),r=fb(r,c,s.children);else if(Kt(o,t))if(c=Mt(o,t),ne(c))r=fb(r,me(),s.children);else{let l=yr(s.children,se(c));if(l){let u=l.getChild(Te(c));r=ga(r,me(),u)}}}else throw _r("WriteRecord should have .snap or .children")}}return r}function uC(n,e,t,r,i){if(!r&&!i){let s=jr(n.visibleWrites,e);if(s!=null)return s;{let o=tr(n.visibleWrites,e);if(Rg(o))return t;if(t==null&&!Sg(o,me()))return null;{let c=t||Ce.EMPTY_NODE;return as(o,c)}}}else{let s=tr(n.visibleWrites,e);if(!i&&Rg(s))return t;if(!i&&t==null&&!Sg(s,me()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Kt(u.path,e)||Kt(e,u.path))},c=lC(n.allWrites,o,e),l=t||Ce.EMPTY_NODE;return as(c,l)}}}function g1(n,e,t){let r=Ce.EMPTY_NODE,i=jr(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(it,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=tr(n.visibleWrites,e);return t.forEachChild(it,(o,c)=>{let l=as(tr(s,new we(o)),c);r=r.updateImmediateChild(o,l)}),mb(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=tr(n.visibleWrites,e);return mb(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function _1(n,e,t,r,i){O(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=$e(e,t);if(Sg(n.visibleWrites,s))return null;{let o=tr(n.visibleWrites,s);return Rg(o)?i.getChild(t):as(o,i.getChild(t))}}function y1(n,e,t,r){let i=$e(e,t),s=jr(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=tr(n.visibleWrites,i);return as(o,r.getNode().getImmediateChild(t))}else return null}function v1(n,e){return jr(n.visibleWrites,e)}function w1(n,e,t,r,i,s,o){let c,l=tr(n.visibleWrites,e),u=jr(l,me());if(u!=null)c=u;else if(t!=null)c=as(l,t);else return[];if(c=c.withIndex(o),!c.isEmpty()&&!c.isLeafNode()){let f=[],p=o.getCompare(),g=s?c.getReverseIteratorFrom(r,o):c.getIteratorFrom(r,o),T=g.getNext();for(;T&&f.length<i;)p(T,r)!==0&&f.push(T),T=g.getNext();return f}else return[]}function E1(){return{visibleWrites:Qt.empty(),allWrites:[],lastWriteId:-1}}function Pg(n,e,t,r){return uC(n.writeTree,n.treePath,e,t,r)}function hC(n,e){return g1(n.writeTree,n.treePath,e)}function gb(n,e,t,r){return _1(n.writeTree,n.treePath,e,t,r)}function gu(n,e){return v1(n.writeTree,$e(n.treePath,e))}function I1(n,e,t,r,i,s){return w1(n.writeTree,n.treePath,e,t,r,i,s)}function Hg(n,e,t){return y1(n.writeTree,n.treePath,e,t)}function dC(n,e){return fC($e(n.treePath,e),n.writeTree)}function fC(n,e){return{treePath:n,writeTree:e}}var Dg=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;O(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),O(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,lb(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,t1(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,e1(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,lb(r,e.snapshotNode,i.oldSnap));else throw _r("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var Ng=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},pC=new Ng,ya=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new _a(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Hg(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Br(this.viewCache_),s=I1(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function T1(n,e){O(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function b1(n,e,t,r,i){let s=new Dg,o,c;if(t.type===Rn.OVERWRITE){let u=t;u.source.fromUser?o=kg(n,e,u.path,u.snap,r,i,s):(O(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered()&&!ne(u.path),o=_u(n,e,u.path,u.snap,r,i,c,s))}else if(t.type===Rn.MERGE){let u=t;u.source.fromUser?o=A1(n,e,u.path,u.children,r,i,s):(O(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered(),o=Og(n,e,u.path,u.children,r,i,c,s))}else if(t.type===Rn.ACK_USER_WRITE){let u=t;u.revert?o=P1(n,e,u.path,r,i,s):o=S1(n,e,u.path,u.affectedTree,r,i,s)}else if(t.type===Rn.LISTEN_COMPLETE)o=R1(n,e,t.path,r,s);else throw _r("Unknown operation type: "+t.type);let l=s.getChanges();return C1(e,o,l),{viewCache:o,changes:l}}function C1(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Ag(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(ZM(Ag(e)))}}function mC(n,e,t,r,i,s){let o=e.eventCache;if(gu(r,t)!=null)return e;{let c,l;if(ne(t))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Br(e),f=u instanceof Ce?u:Ce.EMPTY_NODE,p=hC(r,f);c=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let u=Pg(r,Br(e));c=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=se(t);if(u===".priority"){O(nr(t)===1,"Can't have a priority with additional path components");let f=o.getNode();l=e.serverCache.getNode();let p=gb(r,t,f,l);p!=null?c=n.filter.updatePriority(f,p):c=o.getNode()}else{let f=Te(t),p;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();let g=gb(r,t,o.getNode(),l);g!=null?p=o.getNode().getImmediateChild(u).updateChild(f,g):p=o.getNode().getImmediateChild(u)}else p=Hg(r,u,e.serverCache);p!=null?c=n.filter.updateChild(o.getNode(),u,p,f,i,s):c=o.getNode()}}return ma(e,c,o.isFullyInitialized()||ne(t),n.filter.filtersNodes())}}function _u(n,e,t,r,i,s,o,c){let l=e.serverCache,u,f=o?n.filter:n.filter.getIndexedFilter();if(ne(t))u=f.updateFullNode(l.getNode(),r,null);else if(f.filtersNodes()&&!l.isFiltered()){let T=l.getNode().updateChild(t,r);u=f.updateFullNode(l.getNode(),T,null)}else{let T=se(t);if(!l.isCompleteForPath(t)&&nr(t)>1)return e;let S=Te(t),P=l.getNode().getImmediateChild(T).updateChild(S,r);T===".priority"?u=f.updatePriority(l.getNode(),P):u=f.updateChild(l.getNode(),T,P,S,pC,null)}let p=oC(e,u,l.isFullyInitialized()||ne(t),f.filtersNodes()),g=new ya(i,p,s);return mC(n,p,t,i,g,c)}function kg(n,e,t,r,i,s,o){let c=e.eventCache,l,u,f=new ya(i,e,s);if(ne(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),l=ma(e,u,!0,n.filter.filtersNodes());else{let p=se(t);if(p===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),l=ma(e,u,c.isFullyInitialized(),c.isFiltered());else{let g=Te(t),T=c.getNode().getImmediateChild(p),S;if(ne(g))S=r;else{let D=f.getCompleteChild(p);D!=null?Wb(g)===".priority"&&D.getChild(Kb(g)).isEmpty()?S=D:S=D.updateChild(g,r):S=Ce.EMPTY_NODE}if(T.equals(S))l=e;else{let D=n.filter.updateChild(c.getNode(),p,S,g,f,o);l=ma(e,D,c.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function _b(n,e){return n.eventCache.isCompleteForChild(e)}function A1(n,e,t,r,i,s,o){let c=e;return r.foreach((l,u)=>{let f=$e(t,l);_b(e,se(f))&&(c=kg(n,c,f,u,i,s,o))}),r.foreach((l,u)=>{let f=$e(t,l);_b(e,se(f))||(c=kg(n,c,f,u,i,s,o))}),c}function yb(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Og(n,e,t,r,i,s,o,c){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;ne(t)?u=r:u=new ht(null).setTree(t,r);let f=e.serverCache.getNode();return u.children.inorderTraversal((p,g)=>{if(f.hasChild(p)){let T=e.serverCache.getNode().getImmediateChild(p),S=yb(n,T,g);l=_u(n,l,new we(p),S,i,s,o,c)}}),u.children.inorderTraversal((p,g)=>{let T=!e.serverCache.isCompleteForChild(p)&&g.value===null;if(!f.hasChild(p)&&!T){let S=e.serverCache.getNode().getImmediateChild(p),D=yb(n,S,g);l=_u(n,l,new we(p),D,i,s,o,c)}}),l}function S1(n,e,t,r,i,s,o){if(gu(i,t)!=null)return e;let c=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ne(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return _u(n,e,t,l.getNode().getChild(t),i,s,c,o);if(ne(t)){let u=new ht(null);return l.getNode().forEachChild(ts,(f,p)=>{u=u.set(new we(f),p)}),Og(n,e,t,u,i,s,c,o)}else return e}else{let u=new ht(null);return r.foreach((f,p)=>{let g=$e(t,f);l.isCompleteForPath(g)&&(u=u.set(f,l.getNode().getChild(g)))}),Og(n,e,t,u,i,s,c,o)}}function R1(n,e,t,r,i){let s=e.serverCache,o=oC(e,s.getNode(),s.isFullyInitialized()||ne(t),s.isFiltered());return mC(n,o,t,r,pC,i)}function P1(n,e,t,r,i,s){let o;if(gu(r,t)!=null)return e;{let c=new ya(r,e,i),l=e.eventCache.getNode(),u;if(ne(t)||se(t)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=Pg(r,Br(e));else{let p=e.serverCache.getNode();O(p instanceof Ce,"serverChildren would be complete if leaf node"),f=hC(r,p)}f=f,u=n.filter.updateFullNode(l,f,s)}else{let f=se(t),p=Hg(r,f,e.serverCache);p==null&&e.serverCache.isCompleteForChild(f)&&(p=l.getImmediateChild(f)),p!=null?u=n.filter.updateChild(l,f,p,Te(t),c,s):e.eventCache.getNode().hasChild(f)?u=n.filter.updateChild(l,f,Ce.EMPTY_NODE,Te(t),c,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Pg(r,Br(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||gu(r,me())!=null,ma(e,u,o,n.filter.filtersNodes())}}function D1(n,e){let t=Br(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ne(e)&&!t.getImmediateChild(se(e)).isEmpty())?t.getChild(e):null}function vb(n,e,t,r){e.type===Rn.MERGE&&e.source.queryId!==null&&(O(Br(n.viewCache_),"We should always have a full cache before handling merges"),O(Ag(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=b1(n.processor_,i,e,t,r);return T1(n.processor_,s.viewCache),O(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,N1(n,s.changes,s.viewCache.eventCache.getNode(),null)}function N1(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return o1(n.eventGenerator_,e,t,i)}var wb;function k1(n){O(!wb,"__referenceConstructor has already been defined"),wb=n}function Kg(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return O(s!=null,"SyncTree gave us an op for an invalid query."),vb(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(vb(o,e,t,r));return s}}function Qg(n,e){let t=null;for(let r of n.views.values())t=t||D1(r,e);return t}var Eb;function O1(n){O(!Eb,"__referenceConstructor has already been defined"),Eb=n}var yu=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ht(null),this.pendingWriteTree_=E1(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function x1(n,e,t,r,i){return u1(n.pendingWriteTree_,e,t,r,i),i?wu(n,new os(nC(),e,t)):[]}function Zi(n,e,t=!1){let r=h1(n.pendingWriteTree_,e);if(d1(n.pendingWriteTree_,e)){let s=new ht(null);return r.snap!=null?s=s.set(me(),!0):Lt(r.children,o=>{s=s.set(new we(o),!0)}),wu(n,new Cg(r.path,s,t))}else return[]}function vu(n,e,t){return wu(n,new os(rC(),e,t))}function M1(n,e,t){let r=ht.fromObject(t);return wu(n,new mu(rC(),e,r))}function V1(n,e,t,r){let i=vC(n,r);if(i!=null){let s=wC(i),o=s.path,c=s.queryId,l=Mt(o,e),u=new os(iC(c),l,t);return EC(n,o,u)}else return[]}function L1(n,e,t,r){let i=vC(n,r);if(i){let s=wC(i),o=s.path,c=s.queryId,l=Mt(o,e),u=ht.fromObject(t),f=new mu(iC(c),l,u);return EC(n,o,f)}else return[]}function gC(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,c)=>{let l=Mt(o,e),u=Qg(c,l);if(u)return u});return uC(i,e,s,t,!0)}function wu(n,e){return _C(e,n.syncPointTree_,null,cC(n.pendingWriteTree_,me()))}function _C(n,e,t,r){if(ne(n.path))return yC(n,e,t,r);{let i=e.get(me());t==null&&i!=null&&(t=Qg(i,me()));let s=[],o=se(n.path),c=n.operationForChild(o),l=e.children.get(o);if(l&&c){let u=t?t.getImmediateChild(o):null,f=dC(r,o);s=s.concat(_C(c,l,u,f))}return i&&(s=s.concat(Kg(i,n,r,t))),s}}function yC(n,e,t,r){let i=e.get(me());t==null&&i!=null&&(t=Qg(i,me()));let s=[];return e.children.inorderTraversal((o,c)=>{let l=t?t.getImmediateChild(o):null,u=dC(r,o),f=n.operationForChild(o);f&&(s=s.concat(yC(f,c,l,u)))}),i&&(s=s.concat(Kg(i,n,r,t))),s}function vC(n,e){return n.tagToQueryMap.get(e)}function wC(n){let e=n.indexOf("$");return O(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new we(n.substr(0,e))}}function EC(n,e,t){let r=n.syncPointTree_.get(e);O(r,"Missing sync point for query tag that we're tracking");let i=cC(n.pendingWriteTree_,e);return Kg(r,t,i,null)}var xg=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},Mg=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=$e(this.path_,e);return new n(this.syncTree_,t)}node(){return gC(this.syncTree_,this.path_)}},F1=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Ib=function(n,e,t){if(!n||typeof n!="object")return n;if(O(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return U1(n[".sv"],e,t);if(typeof n[".sv"]=="object")return B1(n[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},U1=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:O(!1,"Unexpected server value: "+n)}},B1=function(n,e,t){n.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&O(!1,"Unexpected increment value: "+r);let i=e.node();if(O(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},j1=function(n,e,t,r){return Yg(e,new Mg(t,n),r)},$1=function(n,e,t){return Yg(n,new xg(e),t)};function Yg(n,e,t){let r=n.getPriority().val(),i=Ib(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,c=Ib(o.getValue(),e,t);return c!==o.getValue()||i!==o.getPriority().val()?new is(c,rt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new is(i))),o.forEachChild(it,(c,l)=>{let u=Yg(l,e.getImmediateChild(c),t);u!==l&&(s=s.updateImmediateChild(c,u))}),s}}var va=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function Jg(n,e){let t=e instanceof we?e:new we(e),r=n,i=se(t);for(;i!==null;){let s=yr(r.node.children,i)||{children:{},childCount:0};r=new va(i,r,s),t=Te(t),i=se(t)}return r}function us(n){return n.node.value}function IC(n,e){n.node.value=e,Vg(n)}function TC(n){return n.node.childCount>0}function q1(n){return us(n)===void 0&&!TC(n)}function Eu(n,e){Lt(n.node.children,(t,r)=>{e(new va(t,n,r))})}function bC(n,e,t,r){t&&!r&&e(n),Eu(n,i=>{bC(i,e,!0,r)}),t&&r&&e(n)}function z1(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function ba(n){return new we(n.parent===null?n.name:ba(n.parent)+"/"+n.name)}function Vg(n){n.parent!==null&&G1(n.parent,n.name,n)}function G1(n,e,t){let r=q1(t),i=mt(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Vg(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Vg(n))}var W1=/[\[\].#$\/\u0000-\u001F\u007F]/,H1=/[\[\].#$\u0000-\u001F\u007F]/,Ym=10*1024*1024,CC=function(n){return typeof n=="string"&&n.length!==0&&!W1.test(n)},K1=function(n){return typeof n=="string"&&n.length!==0&&!H1.test(n)},Q1=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),K1(n)};var AC=function(n,e,t){let r=t instanceof we?new ug(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Vr(r));if(typeof e=="function")throw new Error(n+"contains a function "+Vr(r)+" with contents = "+e.toString());if(Rb(e))throw new Error(n+"contains "+e.toString()+" "+Vr(r));if(typeof e=="string"&&e.length>Ym/3&&Io(e)>Ym)throw new Error(n+"contains a string greater than "+Ym+" utf8 bytes "+Vr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Lt(e,(o,c)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!CC(o)))throw new Error(n+" contains an invalid key ("+o+") "+Vr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);BM(r,o),AC(n,c,r),jM(r)}),i&&s)throw new Error(n+' contains ".value" child '+Vr(r)+" in addition to actual children.")}};var Y1=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!CC(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Q1(t))throw new Error(Aw(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Lg=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function J1(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!Qb(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function $r(n,e,t){J1(n,t),X1(n,r=>Kt(r,e)||Kt(e,r))}function X1(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(Z1(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Z1(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Fr&&nt("event: "+t.toString()),Ia(r)}}}var eV="repo_interrupt",tV=25,Fg=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Lg,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=pu(),this.transactionQueueTree_=new va,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function nV(n,e,t){if(n.stats_=zg(n.repoInfo_),n.forceRestClient_||mM())n.server_=new wg(n.repoInfo_,(r,i,s,o)=>{Tb(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>bb(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ue(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Gg(n.repoInfo_,e,(r,i,s,o)=>{Tb(n,r,i,s,o)},r=>{bb(n,r)},r=>{iV(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=_M(n.repoInfo_,()=>new bg(n.stats_,n.server_)),n.infoData_=new Eg,n.infoSyncTree_=new yu({startListening:(r,i,s,o)=>{let c=[],l=n.infoData_.getNode(r._path);return l.isEmpty()||(c=vu(n.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),c},stopListening:()=>{}}),Xg(n,"connected",!1),n.serverSyncTree_=new yu({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(c,l)=>{let u=o(c,l);$r(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function rV(n){let t=n.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function SC(n){return F1({timestamp:rV(n)})}function Tb(n,e,t,r,i){n.dataUpdateCount++;let s=new we(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let l=Eo(t,u=>rt(u));o=L1(n.serverSyncTree_,s,l,i)}else{let l=rt(t);o=V1(n.serverSyncTree_,s,l,i)}else if(r){let l=Eo(t,u=>rt(u));o=M1(n.serverSyncTree_,s,l)}else{let l=rt(t);o=vu(n.serverSyncTree_,s,l)}let c=s;o.length>0&&(c=e_(n,s)),$r(n.eventQueue_,c,o)}function bb(n,e){Xg(n,"connected",e),e===!1&&oV(n)}function iV(n,e){Lt(e,(t,r)=>{Xg(n,t,r)})}function Xg(n,e,t){let r=new we("/.info/"+e),i=rt(t);n.infoData_.updateSnapshot(r,i);let s=vu(n.infoSyncTree_,r,i);$r(n.eventQueue_,r,s)}function sV(n){return n.nextWriteId_++}function oV(n){RC(n,"onDisconnectEvents");let e=SC(n),t=pu();Ig(n.onDisconnect_,me(),(i,s)=>{let o=j1(i,s,n.serverSyncTree_,e);tC(t,i,o)});let r=[];Ig(t,me(),(i,s)=>{r=r.concat(vu(n.serverSyncTree_,i,s));let o=uV(n,i);e_(n,o)}),n.onDisconnect_=pu(),$r(n.eventQueue_,me(),r)}function aV(n){n.persistentConnection_&&n.persistentConnection_.interrupt(eV)}function RC(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),nt(t,...e)}function PC(n,e,t){return gC(n.serverSyncTree_,e,t)||Ce.EMPTY_NODE}function Zg(n,e=n.transactionQueueTree_){if(e||Iu(n,e),us(e)){let t=NC(n,e);O(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&cV(n,ba(e),t)}else TC(e)&&Eu(e,t=>{Zg(n,t)})}function cV(n,e,t){let r=t.map(u=>u.currentWriteId),i=PC(n,e,r),s=i,o=i.hash();for(let u=0;u<t.length;u++){let f=t[u];O(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;let p=Mt(e,f.path);s=s.updateChild(p,f.currentOutputSnapshotRaw)}let c=s.val(!0),l=e;n.server_.put(l.toString(),c,u=>{RC(n,"transaction put response",{path:l.toString(),status:u});let f=[];if(u==="ok"){let p=[];for(let g=0;g<t.length;g++)t[g].status=2,f=f.concat(Zi(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&p.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();Iu(n,Jg(n.transactionQueueTree_,e)),Zg(n,n.transactionQueueTree_),$r(n.eventQueue_,e,f);for(let g=0;g<p.length;g++)Ia(p[g])}else{if(u==="datastale")for(let p=0;p<t.length;p++)t[p].status===3?t[p].status=4:t[p].status=0;else{wt("transaction at "+l.toString()+" failed: "+u);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=u}e_(n,e)}},o)}function e_(n,e){let t=DC(n,e),r=ba(t),i=NC(n,t);return lV(n,i,r),r}function lV(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(c=>c.status===0).map(c=>c.currentWriteId);for(let c=0;c<e.length;c++){let l=e[c],u=Mt(t,l.path),f=!1,p;if(O(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)f=!0,p=l.abortReason,i=i.concat(Zi(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=tV)f=!0,p="maxretry",i=i.concat(Zi(n.serverSyncTree_,l.currentWriteId,!0));else{let g=PC(n,l.path,o);l.currentInputSnapshot=g;let T=e[c].update(g.val());if(T!==void 0){AC("transaction failed: Data returned ",T,l.path);let S=rt(T);typeof T=="object"&&T!=null&&mt(T,".priority")||(S=S.updatePriority(g.getPriority()));let P=l.currentWriteId,M=SC(n),$=$1(S,g,M);l.currentOutputSnapshotRaw=S,l.currentOutputSnapshotResolved=$,l.currentWriteId=sV(n),o.splice(o.indexOf(P),1),i=i.concat(x1(n.serverSyncTree_,l.path,$,l.currentWriteId,l.applyLocally)),i=i.concat(Zi(n.serverSyncTree_,P,!0))}else f=!0,p="nodata",i=i.concat(Zi(n.serverSyncTree_,l.currentWriteId,!0))}$r(n.eventQueue_,t,i),i=[],f&&(e[c].status=2,function(g){setTimeout(g,Math.floor(0))}(e[c].unwatcher),e[c].onComplete&&(p==="nodata"?r.push(()=>e[c].onComplete(null,!1,e[c].currentInputSnapshot)):r.push(()=>e[c].onComplete(new Error(p),!1,null))))}Iu(n,n.transactionQueueTree_);for(let c=0;c<r.length;c++)Ia(r[c]);Zg(n,n.transactionQueueTree_)}function DC(n,e){let t,r=n.transactionQueueTree_;for(t=se(e);t!==null&&us(r)===void 0;)r=Jg(r,t),e=Te(e),t=se(e);return r}function NC(n,e){let t=[];return kC(n,e,t),t.sort((r,i)=>r.order-i.order),t}function kC(n,e,t){let r=us(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Eu(e,i=>{kC(n,i,t)})}function Iu(n,e){let t=us(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,IC(e,t.length>0?t:void 0)}Eu(e,r=>{Iu(n,r)})}function uV(n,e){let t=ba(DC(n,e)),r=Jg(n.transactionQueueTree_,e);return z1(r,i=>{Jm(n,i)}),Jm(n,r),bC(r,i=>{Jm(n,i)}),t}function Jm(n,e){let t=us(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(O(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(O(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Zi(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?IC(e,void 0):t.length=s+1,$r(n.eventQueue_,ba(e),i);for(let o=0;o<r.length;o++)Ia(r[o])}}function hV(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function dV(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):wt(`Invalid query segment '${t}' in query '${n}'`)}return e}var Cb=function(n,e){let t=fV(n),r=t.namespace;t.domain==="firebase.com"&&Pn(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Pn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||aM();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new au(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new we(t.pathString)}},fV=function(n){let e="",t="",r="",i="",s="",o=!0,c="https",l=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(c=n.substring(0,u-1),n=n.substring(u+2));let f=n.indexOf("/");f===-1&&(f=n.length);let p=n.indexOf("?");p===-1&&(p=n.length),e=n.substring(0,Math.min(f,p)),f<p&&(i=hV(n.substring(f,p)));let g=dV(n.substring(Math.min(n.length,p)));u=e.indexOf(":"),u>=0?(o=c==="https"||c==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;let T=e.slice(0,u);if(T.toLowerCase()==="localhost")t="localhost";else if(T.split(".").length<=2)t=T;else{let S=e.indexOf(".");r=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:l,domain:t,subdomain:r,secure:o,scheme:c,pathString:i,namespace:s}};var Ug=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return ne(this._path)?null:Wb(this._path)}get ref(){return new cs(this._repo,this._path)}get _queryIdentifier(){let e=hb(this._queryParams),t=qg(e);return t==="{}"?"default":t}get _queryObject(){return hb(this._queryParams)}isEqual(e){if(e=Be(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=Qb(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+UM(this._path)}};var cs=class n extends Ug{constructor(e,t){super(e,t,new vg,!1)}get parent(){let e=Kb(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};k1(cs);O1(cs);var pV="FIREBASE_DATABASE_EMULATOR_HOST",Bg={},mV=!1;function gV(n,e,t,r){n.repoInfo_=new au(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function _V(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Pn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),nt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Cb(s,i),c=o.repoInfo,l,u;typeof process<"u"&&process.env&&(u=process.env[pV]),u?(l=!0,s=`http://${u}?ns=${c.namespace}`,o=Cb(s,i),c=o.repoInfo):l=!o.repoInfo.secure;let f=i&&l?new pa(pa.OWNER):new rg(n.name,n.options,e);Y1("Invalid Firebase Database URL",o),ne(o.path)||Pn("Database URL must point to the root of a Firebase Database (not including a child path).");let p=vV(c,n,f,new ng(n.name,t));return new jg(p,n)}function yV(n,e){let t=Bg[e];(!t||t[n.key]!==n)&&Pn(`Database ${e}(${n.repoInfo_}) has already been deleted.`),aV(n),delete t[n.key]}function vV(n,e,t,r){let i=Bg[e.name];i||(i={},Bg[e.name]=i);let s=i[n.toURLString()];return s&&Pn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Fg(n,mV,t,r),i[n.toURLString()]=s,s}var jg=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(nV(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new cs(this._repo,me())),this._rootInternal}_delete(){return this._rootInternal!==null&&(yV(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pn("Cannot call "+e+" on a deleted database.")}};function OC(n=_t(),e){let t=gt(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=Gn("database");r&&xC(t,...r)}return t}function xC(n,e,t,r={}){n=Be(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Pn("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Pn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new pa(pa.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:mi(r.mockUserToken,n.app.options.projectId);s=new pa(o)}gV(i,e,t,s)}function wV(n){iM(ct),He(new ke("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return _V(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),J(HT,KT,n),J(HT,KT,"esm2017")}Gg.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Gg.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};wV();var Ca=class{constructor(e){return e}},MC="database",t_=class{constructor(){return qt(MC)}};var n_=new W("angularfire2.database-instances");function EV(n,e){let t=sn(MC,n,e);return t&&new Ca(t)}function IV(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ca(r)}}var TV={provide:t_,deps:[[new de,n_]]},bV={provide:Ca,useFactory:EV,deps:[[new de,n_],lt]};function VC(n,...e){return J("angularfire",yt.full,"rtdb"),Ne([bV,TV,{provide:n_,useFactory:IV(n),multi:!0,deps:[ve,at,Ot,vt,[new de,zt],[new de,kt],...e]}])}var LC=ut(OC,!0);var qC="firebasestorage.googleapis.com",CV="storageBucket",AV=2*60*1e3,SV=10*60*1e3;var dn=class n extends We{constructor(e,t,r=0){super(r_(e),`Firebase Storage: ${t} (${r_(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return r_(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Nn=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Nn||{});function r_(n){return"storage/"+n}function RV(){let n="An unknown error occurred, please check the error payload for server response.";return new dn(Nn.UNKNOWN,n)}function PV(){return new dn(Nn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function DV(){return new dn(Nn.CANCELED,"User canceled the upload/download.")}function NV(n){return new dn(Nn.INVALID_URL,"Invalid URL '"+n+"'.")}function kV(n){return new dn(Nn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FC(n){return new dn(Nn.INVALID_ARGUMENT,n)}function zC(){return new dn(Nn.APP_DELETED,"The Firebase app was deleted.")}function OV(n){return new dn(Nn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var Dn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw kV(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}let o="(/(.*))?$",c=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(F){F.path_=decodeURIComponent(F.path)}let f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",T=new RegExp(`^https?://${p}/${f}/b/${i}/o${g}`,"i"),S={bucket:1,path:3},D=t===qC?"(?:storage.googleapis.com|storage.cloud.google.com)":t,P="([^?#]*)",M=new RegExp(`^https?://${D}/${i}/${P}`,"i"),B=[{regex:c,indices:l,postModify:s},{regex:T,indices:S,postModify:u},{regex:M,indices:{bucket:1,path:2},postModify:u}];for(let F=0;F<B.length;F++){let pe=B[F],K=pe.regex.exec(e);if(K){let I=K[pe.indices.bucket],_=K[pe.indices.path];_||(_=""),r=new n(I,_),pe.postModify(r);break}}if(r==null)throw NV(e);return r}},i_=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function xV(n,e,t){let r=1,i=null,s=null,o=!1,c=0;function l(){return c===2}let u=!1;function f(...P){u||(u=!0,e.apply(null,P))}function p(P){i=setTimeout(()=>{i=null,n(T,l())},P)}function g(){s&&clearTimeout(s)}function T(P,...M){if(u){g();return}if(P){g(),f.call(null,P,...M);return}if(l()||o){g(),f.call(null,P,...M);return}r<64&&(r*=2);let B;c===1?(c=2,B=0):B=(r+Math.random())*1e3,p(B)}let S=!1;function D(P){S||(S=!0,g(),!u&&(i!==null?(P||(c=2),clearTimeout(i),p(0)):P||(c=1)))}return p(0),s=setTimeout(()=>{o=!0,D(!0)},t),D}function MV(n){n(!1)}function VV(n){return n!==void 0}function UC(n,e,t,r){if(r<e)throw FC(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw FC(`Invalid value for '${n}'. Expected ${t} or less.`)}function LV(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var s_=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(s_||{});function FV(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var o_=class{constructor(e,t,r,i,s,o,c,l,u,f,p,g=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=p,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new hs(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=c=>{let l=c.loaded,u=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let c=s.getErrorCode()===s_.NO_ERROR,l=s.getStatus();if(!c||FV(l,this.additionalRetryCodes_)&&this.retry){let f=s.getErrorCode()===s_.ABORT;r(!1,new hs(!1,null,f));return}let u=this.successCodes_.indexOf(l)!==-1;r(!0,new hs(u,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,c=i.connection;if(i.wasSuccessCode)try{let l=this.callback_(c,c.getResponse());VV(l)?s(l):s()}catch(l){o(l)}else if(c!==null){let l=RV();l.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,l)):o(l)}else if(i.canceled){let l=this.appDelete_?zC():DV();o(l)}else{let l=PV();o(l)}};this.canceled_?t(!1,new hs(!1,null,!0)):this.backoffId_=xV(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&MV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},hs=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function UV(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function BV(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function jV(n,e){e&&(n["X-Firebase-GMPID"]=e)}function $V(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function qV(n,e,t,r,i,s,o=!0){let c=LV(n.urlParams),l=n.url+c,u=Object.assign({},n.headers);return jV(u,e),UV(u,t),BV(u,s),$V(u,r),new o_(l,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function zV(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function GV(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}var vq=256*1024;var a_=class n{constructor(e,t){this._service=e,t instanceof Dn?this._location=t:this._location=Dn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return GV(this._location.path)}get storage(){return this._service}get parent(){let e=zV(this._location.path);if(e===null)return null;let t=new Dn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw OV(e)}};function BC(n,e){let t=e?.[CV];return t==null?null:Dn.makeFromBucketSpec(t,n)}function WV(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:mi(i,n.app.options.projectId))}var c_=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=qC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=AV,this._maxUploadRetryTime=SV,this._requests=new Set,i!=null?this._bucket=Dn.makeFromBucketSpec(i,this._host):this._bucket=BC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,e):this._bucket=BC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){UC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){UC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return w(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return w(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new a_(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new i_(zC());{let o=qV(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return w(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},jC="@firebase/storage",$C="0.13.2";var GC="storage";function WC(n=_t(),e){n=Be(n);let r=gt(n,GC).getImmediate({identifier:e}),i=Gn("storage");return i&&HC(r,...i),r}function HC(n,e,t,r={}){WV(n,e,t,r)}function HV(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new c_(t,r,i,e,ct)}function KV(){He(new ke(GC,HV,"PUBLIC").setMultipleInstances(!0)),J(jC,$C,""),J(jC,$C,"esm2017")}KV();var Aa=class{constructor(e){return e}},KC="storage",l_=class{constructor(){return qt(KC)}};var u_=new W("angularfire2.storage-instances");function QV(n,e){let t=sn(KC,n,e);return t&&new Aa(t)}function YV(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Aa(r)}}var JV={provide:l_,deps:[[new de,u_]]},XV={provide:Aa,useFactory:QV,deps:[[new de,u_],lt]};function QC(n,...e){return J("angularfire",yt.full,"gcs"),Ne([XV,JV,{provide:u_,useFactory:YV(n),multi:!0,deps:[ve,at,Ot,vt,[new de,zt],[new de,kt],...e]}])}var YC=ut(WC,!0);var ZC="functions";var h_=class{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||t.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return w(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return w(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return w(this,null,function*(){if(this.appCheck){let t=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return t.error?null:t.token}return null})}getContext(e){return w(this,null,function*(){let t=yield this.getAuthToken(),r=yield this.getMessagingToken(),i=yield this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}})}};var d_="us-central1";var f_=class{constructor(e,t,r,i,s=d_,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new h_(t,r,i),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{let c=new URL(s);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=d_}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function ZV(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}var JC="@firebase/functions",XC="0.11.8";var eL="auth-internal",tL="app-check-internal",nL="messaging-internal";function rL(n,e){let t=(r,{instanceIdentifier:i})=>{let s=r.getProvider("app").getImmediate(),o=r.getProvider(eL),c=r.getProvider(nL),l=r.getProvider(tL);return new f_(s,o,c,l,i,n)};He(new ke(ZC,t,"PUBLIC").setMultipleInstances(!0)),J(JC,XC,e),J(JC,XC,"esm2017")}function eA(n=_t(),e=d_){let r=gt(Be(n),ZC).getImmediate({identifier:e}),i=Gn("functions");return i&&tA(r,...i),r}function tA(n,e,t){ZV(Be(n),e,t)}rL(fetch.bind(self));var Sa=class{constructor(e){return e}},nA="functions",p_=class{constructor(){return qt(nA)}};var m_=new W("angularfire2.functions-instances");function iL(n,e){let t=sn(nA,n,e);return t&&new Sa(t)}function sL(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Sa(r)}}var oL={provide:p_,deps:[[new de,m_]]},aL={provide:Sa,useFactory:iL,deps:[[new de,m_],lt]};function rA(n,...e){return J("angularfire",yt.full,"fn"),Ne([aL,oL,{provide:m_,useFactory:sL(n),multi:!0,deps:[ve,at,Ot,vt,[new de,zt],[new de,kt],...e]}])}var iA=ut(eA,!0);var g_=class{constructor(e,t){this._delegate=e,this.firebase=t,vi(e,new ke("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Co(this._delegate)))}_getService(e,t=nn){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=nn){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){vi(this._delegate,e)}_addOrOverwriteComponent(e){Qd(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var cL={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},sA=new Pt("app-compat","Firebase",cL);function lL(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:J,setLogLevel:qc,onLog:$c,apps:null,SDK_VERSION:ct,INTERNAL:{registerComponent:c,removeApp:r,useAsService:l,modularAPIs:Yd}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||nn,!mt(e,u))throw sA.create("no-app",{appName:u});return e[u]}i.App=n;function s(u,f={}){let p=wi(u,f);if(mt(e,p.name))return e[p.name];let g=new n(p,t);return e[p.name]=g,g}function o(){return Object.keys(e).map(u=>e[u])}function c(u){let f=u.name,p=f.replace("-compat","");if(He(u)&&u.type==="PUBLIC"){let g=(T=i())=>{if(typeof T[p]!="function")throw sA.create("invalid-app-argument",{appName:f});return T[p]()};u.serviceProps!==void 0&&pi(g,u.serviceProps),t[p]=g,n.prototype[p]=function(...T){return this._getService.bind(this,f).apply(this,u.multipleInstances?T:[])}}return u.type==="PUBLIC"?t[p]:null}function l(u,f){return f==="serverAuth"?null:f}return t}function aA(){let n=lL(g_);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:aA,extendNamespace:e,createSubscribe:Lc,ErrorFactory:Pt,deepExtend:pi});function e(t){pi(n,t)}return n}var uL=aA();var oA=new Dt("@firebase/app-compat"),hL="@firebase/app-compat",dL="0.2.43";function fL(n){J(hL,dL,n)}try{let n=Nd();if(n.firebase!==void 0){oA.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&oA.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var Tu=uL;fL();var pL="firebase",mL="10.14.1";Tu.registerVersion(pL,mL,"app-compat");var cA=new W("angularfire2.app.options");var Tz=typeof module<"u"&&!!module.hot;globalThis.\u0275AngularfireInstanceCache||=[];var lA={providers:[qy({eventCoalescing:!0}),fw($T),wv(Ev()),Nv(),WT(),zT(),GT(),Ww(()=>Hw(qm.firebaseConfig)),LE(()=>FE()),fT(()=>gT()),VC(()=>LC()),QC(()=>YC()),rA(()=>iA()),{provide:cA,useValue:qm.firebaseConfig}]};Pv(Nc,lA).catch(n=>console.error(n));
